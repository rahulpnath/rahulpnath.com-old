<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Rahul Nath]]></title>
  <link href="http://rahulpnath.com/atom.xml" rel="self"/>
  <link href="http://rahulpnath.com/"/>
  <updated>2017-01-17T00:03:48+00:00</updated>
  <id>http://rahulpnath.com/</id>
  <author>
    <name><![CDATA[Rahul Nath]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Tip of the Week: Finding Keyboard Shortcuts on Websites]]></title>
    <link href="http://rahulpnath.com/blog/finding-keyboard-shortcuts-on-websites/"/>
    <updated>2017-01-16T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/finding-keyboard-shortcuts-on-websites</id>
    <content type="html"><![CDATA[<p><img alt="Keyboard Shortcuts" src="http://rahulpnath.com/images/keyboard_shortcuts.jpg" /></p>

<p>I prefer to use the keyboard to navigate within sites I use frequently. Keyboard enables to navigate faster within site and perform tasks quicker. The <a href="http://www.rahulpnath.com/blog/review-six-months-and-counting-logitech-mx-master/">Logitech MX Master</a> mouse provides a lot of capabilities to navigate. But I find the keyboard faster to perform repetitive actions - like posting a new status update on social media sites, managing tasks in Jira, TFS online, GitHub, responding to emails, Todoist, etc. Finding keyboard shortcuts on these various sites can itself be a daunting task. One might need to google to get the shortcuts or find the relevant documentation on the site. Luckily most of the popular sites today display a pop-up modal with all the keyboard shortcuts for the site when pressing <strong>Shift + ?</strong>. Note that this might not work on all the sites out there. But for most of the common ones that I use l, I find it working.</p>

<p>So the next time you spend a lot of time on a website try hitting <strong>Shift + ?</strong> to look for supported keyboard shortcuts.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Tip of the Week: Productivity Noise with Noisli]]></title>
    <link href="http://rahulpnath.com/blog/productivity-noise-with-noisli/"/>
    <updated>2017-01-11T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/productivity-noise-with-noisli</id>
    <content type="html"><![CDATA[<p>If you are the kind of person that likes to listen to some music while working, then this one is for you. Music is proven to have significant effects on improving focus while working. But it is also quite possible to get fully immersed in the music and forget all about work. Different kinds of music contribute to improving concentration while not getting immersed in the music itself. I usually <a href="http://theheadphonesrule.com/">wear my headphones</a> at work while working and listen to music.</p>

<blockquote><p><em>Music helps to minimize distractions and helps you reach a state of <a href="http://amzn.to/2jlYIgV">Flow</a>, which is ideal for improving productivity.</em></p></blockquote>

<p>At times I like to hear to just some background noises simulating different environments. <a href="https://www.noisli.com/">Noisli</a> is an application that helps mix different sounds and create your perfect environment. The sounds could either be working in a restaurant or while it&rsquo;s raining with thunder, in a forest, by the side of the fire, etc. It helps create the mood that you want and helps recreate it with sound. Since the noises are of a fixed pattern, you soon get used to it and improves concentration at work.</p>

<p><img class="center" alt="Noisli - Favorite Combos" src="http://rahulpnath.com/images/noisli_favorite.png" /></p>

<p>Here are my favorite mixes in Noisli.
<a href="https://www.noisli.com/get_combo_by_link/W5rvjLZXcoJbooq">Rain Mix</a>, <a href="https://www.noisli.com/get_combo_by_link/vjUpcG2OAXxKVSU">Jungle</a>, <a href="https://www.noisli.com/get_combo_by_link/uhRXMysAIcVEbHF">TRain</a>, <a href="https://www.noisli.com/get_combo_by_link/gFKhnETdoybxcmc">HotelRainFire</a></p>

<p>You can use Noisli directly from the <a href="https://www.noisli.com/">website</a> or use any of their <a href="https://www.noisli.com/apps">Apps and Extensions</a>. Find out what works for you and leave a comment on your favorite combos.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Simulating delays in HTTP Calls For Manual Tests]]></title>
    <link href="http://rahulpnath.com/blog/simulating-delays-in-http-calls-for-manual-tests/"/>
    <updated>2017-01-09T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/simulating-delays-in-http-calls-for-manual-tests</id>
    <content type="html"><![CDATA[<p>At one of my clients, we were facing an issue of missing some part of a form data when processing a <em>Submit</em> request on the form. As per the current design, the form autosaves data to the database as and when user types in. When the user finally submits the form to be processed the Controller gets all the relevant data from the database and sends for processing. But we noticed that the processing requests missed parts of data in the request send for processing even though the database had those values. This was a clear case where the forms submit request got processed even before all the forms data was saved. The UI was enabling the Submit button right after all the UI validations were made and asynchronously firing off saves to the database.</p>

<p>Let&rsquo;s not go into the design discussion of whether the UI should be sending in all the data to be processed as part of the Submit request as opposed to just sending a reference id and have the controller get all the data from the database (which it is currently doing). The quick fix for this problem was to enable the submit button only after all the asynchronous save requests (the ones for autosave) came back with a success response. The fix was simple but testing this was a challenge.</p>

<blockquote><p><em>We wanted to delay a few HTTP requests to check how the UI behaved</em></p></blockquote>

<p>When using automated tests there are a lot of frameworks that can help delay requests. But in this case, we were relying on manual tests.</p>

<h3>Using Fiddler to Delay Requests</h3>

<p><a href="http://www.telerik.com/fiddler">Fiddler</a> is an HTTP debugging proxy server application, that captures HTTP and HTTPS traffic and displays to the user. It is one of the <a href="http://www.rahulpnath.com/blog/tools-that-I-use/">tools that I use almost every other day</a>. In Fiddler, we can create rules on web requests and modify how they are handled and responded. Most of the functionality is available under the <a href="http://docs.telerik.com/fiddler/KnowledgeBase/AutoResponder#latency">AutoResponder</a> tab. We had seen earlier how to <a href="http://www.rahulpnath.com/blog/using-fiddler-to-help-in-manual-testing/">compose web requests and also simulate error conditions in Fiddler</a>. Here we will see how to use Fiddler to delay request/response time. In Fiddler, we can either delay the request itself being sent to the server or delay the handover of response back to the calling application once it is received from the server.</p>

<h4><strong>Delay</strong></h4>

<p>By setting <a href="http://docs.telerik.com/fiddler/KnowledgeBase/AutoResponder#delay">delay</a> on a request we can specify the time to delay sending the request to the server. The value is specified in milliseconds. When a request that <a href="http://docs.telerik.com/fiddler/KnowledgeBase/AutoResponder#matching-rules">matches</a> the condition set (in this case an EXACT match with a URL) fiddler delays sending this request to the server by the set amount of time.</p>

<blockquote><p><em>Delay sending request to the server by #### of milliseconds</em></p></blockquote>

<p>Drag&#8217;n Drop the request the URL (1) into the AutoResponder tab (2) and from the dropdown (3) under the Rule Editor choose delay and set the delay time. Click Save (4). Make sure that the request and rules are enabled (5 &amp; 6).</p>

<p><img class="center" alt="Posts per month - 2016" src="http://rahulpnath.com/images/fiddler_delay.png"/></p>

<h4><strong>Latency</strong></h4>

<p>By setting <a href="http://docs.telerik.com/fiddler/KnowledgeBase/AutoResponder#latency">latency</a> on a request we can specify the delay before a response is received. When a request that <a href="http://docs.telerik.com/fiddler/KnowledgeBase/AutoResponder#matching-rules">matches</a> the condition set fiddler sends the requests to the server immediately. Once the response is received it delays passing the response back to the calling application by the set delay time in milliseconds.</p>

<blockquote><p><em>Induce a delay (latency) before a response is returned.</em></p></blockquote>

<p>Drag&#8217;n Drop the request URL (1) into the AutoResponder tab (2). Right click on the URL and select &lsquo;Set Latency&rsquo; (3). Enter the latency time in milliseconds and OK. Make sure that rules and latency options are enabled (4 &amp; 5)</p>

<p><img class="center" alt="Posts per month - 2016" src="http://rahulpnath.com/images/fiddler_latency.png"/></p>

<p>Using these options we delayed all the autosave requests going off the form. This delayed saving the data in the database and the forms Submit request once processed did not have all the required data. It also helped us test after the fix and helped ensure that the submit button was enabled only after all form data was saved. In both the above examples, I chose EXACT match condition to set the delay/latency. This will delay only the specific requests. To modify all the requests you can use a different regex match condition. To simulate a random time delay or latency among different requests you can even use <a href="http://docs.telerik.com/fiddler/KnowledgeBase/FiddlerScript/ModifyRequestOrResponse">Fiddler Scripting</a> and set the delay time using a random number. This helps simulate a slow internet connection scenario and test how the application responds to it.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Tip of the Week: Paste Without Formatting]]></title>
    <link href="http://rahulpnath.com/blog/paste-without-formatting/"/>
    <updated>2017-01-05T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/paste-without-formatting</id>
    <content type="html"><![CDATA[<p>I share a lot of information copying and pasting from websites. Most of the times I want to share just the text and not any formatting. To remove any text formatting, I copy it into Notepad and then onto the destination. Yesterday I found that using <strong>Ctrl + Shift + V</strong> to paste (instead of <em>Ctrl + V</em>) removes all text formatting.</p>

<p>As shown, when using Ctrl + V the text gets copied along with the formatting as shown below.</p>

<p><img alt="Paste With Formatting" src="http://rahulpnath.com/images/paste_with_formatting.png" /></p>

<p>When using Ctrl + Shift + V, only the text gets copied and the formatting is ignored.
<img alt="Paste Without Formatting" src="http://rahulpnath.com/images/paste_without_formatting.png" /></p>

<p>Using this shortcut saves time as I no longer need to open Notepad for this!</p>

<p>PS: As one of my readers rightly pointed out (below in the comments), this might not work on all applications. I have tried this on Chrome Browser and Lync For Business and worked fine.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Making Code Reviews Effective]]></title>
    <link href="http://rahulpnath.com/blog/code-review/"/>
    <updated>2017-01-03T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/code-review</id>
    <content type="html"><![CDATA[<p>Code review is an essential practice of the development life cycle. It helps improve the code quality, unify team practices, share knowledge, mentoring etc. over a longer period of time. It helps find mistakes that are overlooked while developing and helps improve the overall quality of the software. This helps accelerate the deployment process as changes are more likely to pass through testing.</p>

<blockquote><p><em>Peer review—an activity in which people other than the author of a software deliverable examine it for defects and improvement opportunities—is one of the most powerful software quality tools available. Peer review methods include inspections, walkthroughs, peer desk checks, and other similar activities.</em></p>

<p>-<a href="http://www.processimpact.com/articles/humanizing_reviews.html"><strong> Karl E. Wiegers</strong></a></p></blockquote>

<p><img class="center" alt="Posts per month - 2016" src="http://rahulpnath.com/images/codereview_friendly.png"/></p>

<p>Below are some of my thoughts on the various aspects involved in a Code Review.</p>

<h3>Sending a Review</h3>

<p>Before sending for a code review make sure that only the necessary files for the change are added in the review. Often it happens that when we write code there are remains of things that we tried and discarded, like new files, packages, changes to project metadata files etc. Double check and make sure that the changes are what are just required. Ensure that the code builds successfully. If there are any build scripts that your team uses, make sure that those are run and passes successfully. When submitting a code review make sure that you reference the associated work item - be it a bug, story, task etc. Add <a href="http://www.rahulpnath.com/blog/category/testing/">tests</a>. Add in a description detailing the change and any reasoning behind it to add in more context. This will help the reviewer understand the code much faster. Add in relevant people for the review and submit a request. Check out <a href="http://blog.ploeh.dk/2015/01/15/10-tips-for-better-pull-requests/">some great tips for a better-looking review request</a>.</p>

<h3>Handling Review Comments</h3>

<p>One of the key things in a code review and one that&rsquo;s often missed and drives people frustrated is that they try to take it all in.</p>

<blockquote><p><em>Not all comments in a review needs to be addressed</em></p></blockquote>

<p>If a review comment points out a mistake in logic or business functionality or conflict with other code you need to fix them, unless you think the reviewer is wrong. But for suggestions on how better to structure your code or refactor into a more readable code, naming, style formatting etc needs addressing only if you feel they are adding value. But make sure to communicate well with the reviewer and reach an agreement.</p>

<p>Look at comments as a way to improve your code and help the team and business. Go in with a positive attitude. When seen as an overhead or an extra ritual, code reviews can be really painful and depressing. Make a note of commonly occurring comments or mistakes you are making and try to handle them at the time of development. Rather than mechanically going through the code review and making changes to the code, internalize on the change and try to see the benefits of a change. This helps to incorporate such suggestions in future reviews as well.</p>

<h3>Responding to a Code Review</h3>

<p>I usually find myself following the below three variations when coming to replying to a code review request</p>

<ul>
<li><p><strong>Comment and Wait</strong>
I leave comments on the review but do not approve. This means that I would like to have those comments actioned and a new pull request be raised for that. This often falls into those cases where there are logic or business issues.</p></li>
<li><p><strong>Comment and Approve</strong>
I leave comments (if any) but also approve the code review. This means that the code <em>Looks Good To Me</em> (LGTM), but would be better with the comments addressed. These comments generally relate to better formatting, improved on naming or refactoring readability.</p></li>
<li><p><strong>Add Relevant People</strong>
Add in reviewers that I feel are missed and relevant for the part of the code that is changed.  This I do irrespective of the above two options if I feel someone else needs to take a look. In these cases, if it was my review that gets added in an extra reviewer I would wait to get a sign off from that person too.</p></li>
</ul>


<h4><strong>Business Aspect</strong></h4>

<p>When reviewing code look first for the functionality that the code change addresses. It is possible that we get carried away just by the technical aspect of code and ignore the business aspect altogether. If you have <a href="https://www.leadingagile.com/2014/09/acceptance-criteria/">Acceptance Criteria</a> defined for tasks then it&rsquo;s worth reading it before doing the code review to get more context.</p>

<h4><strong>Technical aspect</strong></h4>

<p>Once the business aspect is covered have a look at the technical aspect of the change. Whether the code is decoupled, has the correct abstractions, follows team conventions (best if automated). Check for commonly occurring problems like improper usage of dispose pattern, magic numbers, large methods, all code flow paths not handled etc. See if the new code fits into the overall architecture of the application. Look for tests and ensure the validity of the test data. Look out for <a href="https://en.wikipedia.org/wiki/Overengineering">overengineering</a> or <a href="https://en.wikipedia.org/wiki/Not_invented_here">not invented here syndrome</a>.</p>

<h4><strong>Aesthetic</strong></h4>

<p>Code formatting is as important as the code itself. Code is read more often than written, so we should try and optimize code for reading. I would prefer to automate this as far as possible so that people don&rsquo;t need to look for these in reviews. I feel that is often time not well spent and also tends to lead to longer discussions (<a href="https://blog.codinghorror.com/death-to-the-space-infidels/">tabs vs Spaces</a>). When it is part of the build and automated people seldom complain about it and in a very short period of time, the formatting rules become second nature to them. If you currently do not have automated checks you can gradually <a href="http://www.rahulpnath.com/blog/introducing-code-formatting-into-a-large-codebase/">introduce formatting checks into your builds for a large code base</a>.</p>

<blockquote><p><em>Don&rsquo;t go by &lsquo;It&rsquo;s done like that everywhere so I will keep it the same&rsquo;</em></p></blockquote>

<p>There might be a lot of practices that is being followed over the period of time. But if you find any of the practices making it harder on a day-to-day functioning of the team, take a step towards changing the practice. I am not a fan of &lsquo;<em>clean it all at once</em>&rsquo; style of approach. I prefer to gradually introduce the change for two reasons</p>

<ul>
<li>No need to stop or allocate people to repeatedly do the same task of cleaning it everywhere. (Unless there is a very strong business justification to it)</li>
<li>You get gradually introduced to the new way of doing things. This gives time to reflect and compare with the old way. You have time to correct yourself if the new approach is not fitting well either or causing more trouble than previous.</li>
</ul>


<h3>Handling Conflicts</h3>

<p><img class="center" alt="Posts per month - 2016" src="http://rahulpnath.com/images/codereview_wtf.png"/></p>

<p>Foster environments where you don&rsquo;t curb discussions or other people&rsquo;s ideas but encourage everyone to actively participate and throw around even the stupidest of an idea.</p>

<blockquote><p><em>Psychological safety is a “shared belief, held by members of a team, that the group is a safe place for taking risks.” It is “a sense of confidence that the team will not embarrass, reject, or punish someone for speaking up,” Edmondson wrote in a 1999 paper. “It describes a team climate characterized by interpersonal trust and mutual respect in which people are comfortable being themselves.</em></p>

<p><a href="https://www.linkedin.com/pulse/what-google-learned-from-its-quest-build-perfect-team-charles-duhigg"><strong>- Charles Duhigg</strong>, <em>What Google Learned From Its Quest to Build the Perfect Team</em></a></p></blockquote>

<p>Code reviews should also be seen as a way to incorporate better practices from fellow developers and as a learning mechanism. Don&rsquo;t take comments personal, but look at it for what they are. When you have a conflicting opinion you can reply to the comment with your thoughts and cross check with the reviewer. Rarely it can happen that you have conflicting opinions on code review comments and you are not able to solve it among the people involved.  Walk up to the person (if you are co-located) or have a conversation over your teams messaging application. But make sure that it stays healthy. In case the discussion is not going the intended way you can involve senior team members or other fellow team members to seek their opinions too. If such kinds of conflicts are happening more often then the team needs to analyze the nature of review comments that these occur on, if it&rsquo;s between specific groups of people or any visible patterns and try to address them.</p>

<p>When taken in isolation any practices that a team does take time. So disregard any activity just because it adds more time to your process. When seen as part of the overall development cycle and the benefits it brings to the business, Code Reviews proves to be an essential practice. Different teams tend to have different guidelines and checklists for the reviews. Follow what works best for your team. Do you do code reviews as part of your development cycle? What do you feel important in a Code Review? Sound off in the comments!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Self-help Books]]></title>
    <link href="http://rahulpnath.com/blog/books/"/>
    <updated>2017-01-01T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/books</id>
    <content type="html"><![CDATA[<p>Over the past couple of years, I have read a lot of <a href="https://en.wikipedia.org/wiki/Self-help_book">Self-help books</a>. Here are a few that I liked and have drawn ideas from. Self-help books in itself is an easy way to procrastinate as you get an immediate high on knowing how optimized and productive your life can be. I have fallen for this a lot of times and its hard to keep away from it. Every time I read one of these books, I get the feeling that this is going to change my life. But then when I get to the end of the book all I need is more of it and ends up <a href="http://www.huffingtonpost.com/quora/why-self-help-books-rarel_b_9517224.html">starting with a new book</a>. Slowly with time I started to realize that all that is happening is reading and very little action.</p>

<p>To be successful with any of these books you need to draw ideas into your daily life and practice them. You need to build short term goals and get the behavior you are trying to create into you.</p>

<blockquote><p><em>Reading without action is just another way to procrastinate and is a waste of time.</em></p></blockquote>

<p>Take notes from the books, see how it can be incorporated into your daily life and improve one at a time. Revisit the notes often. I prefer reading this genre of books on the Kindle (<a href="http://www.rahulpnath.com/blog/ebook-or-hard-copy/">technical books I prefer physical copy</a>), as it requires little flipping back and forth.  On Kindle, you can <a href="https://www.amazon.com/gp/help/customer/display.html?nodeId=201241990">add or remove bookmarks, highlights, and notes at any location</a> and revisit this at a later point in time.</p>

<div>
<div class="row">
   <div class="col-sm-6 col-md-3">
      <div class="thumbnail">
         <a href="http://amzn.to/2hm8vDJ">
         <img src="http://rahulpnath.com/images/books_amillionthougts.jpg" data-holder-rendered="true" style="display: block;" >
         </a>
         <div class="caption">
            <h5>A Million Thoughts</b></h5>
         </div>
      </div>
   </div>
   <div class="col-sm-6 col-md-3">
      <div class="thumbnail">
         <a href="http://amzn.to/2gOYluc" >
         <img src="http://rahulpnath.com/images/books_powerofhabit.jpg" data-holder-rendered="true" style="display: block;">
         </a>
         <div class="caption">
            <h5><b>Power Of Habit</b></h5>
         </div>
      </div>
   </div>
   <div class="col-sm-6 col-md-3">
      <div class="thumbnail">
         <a href="http://amzn.to/2gsJaed" >
         <img src="http://rahulpnath.com/images/books_gtd.jpg" data-holder-rendered="true" style="display: block;">
         </a>
         <div class="caption">
            <h5><b>Getting Things Done</b></h5>
         </div>
      </div>
   </div>
   <div class="col-sm-6 col-md-3">
      <div class="thumbnail">
         <a href="http://amzn.to/2hsjXkq" >
         <img src="http://rahulpnath.com/images/books_warofart.jpg" data-holder-rendered="true" style="display: block;">
         </a>
         <div class="caption">
            <h5><b>The War of Art</b></h5>
         </div>
      </div>
   </div>
</div>
<div class="row">
<div class="col-sm-6 col-md-3">
   <div class="thumbnail">
      <a href="http://amzn.to/2hmeokB">
      <img src="http://rahulpnath.com/images/books_superhumanbyhabit.jpg" data-holder-rendered="true" style="display: block;" >
      </a>
      <div class="caption">
         <h5><b>Superhuman By Habit</b></h5>
      </div>
   </div>
</div>
<div class="col-sm-6 col-md-3">
   <div class="thumbnail">
      <a href="http://amzn.to/2gP4sig" >
      <img src="http://rahulpnath.com/images/books_winfriendsandinfluenceprople.jpg" data-holder-rendered="true" style="display: block;">
      </a>
      <div class="caption">
         <h5><b>How to Win Friends & Influence People</b></h5>
      </div>
   </div>
</div>
<div class="col-sm-6 col-md-3">
   <div class="thumbnail">
      <a href="http://amzn.to/2hmblsw" >
      <img src="http://rahulpnath.com/images/books_thefirsttwentyhours.jpg" data-holder-rendered="true" style="display: block;">
      </a>
      <div class="caption">
         <h5><b>The First 20 Hours</b></h5>
      </div>
   </div>
</div>
<div class="col-sm-6 col-md-3">
   <div class="thumbnail">
      <a href="http://amzn.to/2hsfy0H" >
      <img src="http://rahulpnath.com/images/books_thepassionateprogrammer.jpg" data-holder-rendered="true" style="display: block;">
      </a>
      <div class="caption">
         <h5><b>The Passionate Programmer</b></h5>
      </div>
   </div>
</div>
</div>
<div class="row">
   <div class="col-sm-6 col-md-3">
      <div class="thumbnail">
         <a href="http://amzn.to/2hsh1En">
         <img src="http://rahulpnath.com/images/books_eatthatfrog.jpg" data-holder-rendered="true" style="display: block;" >
         </a>
         <div class="caption">
            <h5><b>Eat That Frog</b></h5>
         </div>
      </div>
   </div>
   <div class="col-sm-6 col-md-3">
      <div class="thumbnail">
         <a href="http://amzn.to/2gsXmE0" >
         <img src="http://rahulpnath.com/images/books_smarterfasterbetter.jpg" data-holder-rendered="true" style="display: block;">
         </a>
         <div class="caption">
            <h5><b>Smarter Faster Better</b></h5>
         </div>
      </div>
   </div>
   <div class="col-sm-6 col-md-3">
      <div class="thumbnail">
         <a href="http://amzn.to/2hsr2kI" >
         <img src="http://rahulpnath.com/images/books_thecompoundeffect.jpg" data-holder-rendered="true" style="display: block;">
         </a>
         <div class="caption">
            <h5><b>The Compound Effect</b></h5>
         </div>
      </div>
   </div>
   <div class="col-sm-6 col-md-3">
      <div class="thumbnail">
         <a href="http://amzn.to/2hsoeUC" >
         <img src="http://rahulpnath.com/images/books_rework.jpg" data-holder-rendered="true" style="display: block;">
         </a>
         <div class="caption">
            <h5><b>Rework</b></h5>
         </div>
      </div>
   </div>
   </div>
   <div class="row">
   <div class="col-sm-6 col-md-3">
      <div class="thumbnail">
         <a href="http://amzn.to/2gJ7Uio">
         <img src="http://rahulpnath.com/images/books_fourhourworkweek.jpg" data-holder-rendered="true" style="display: block;" >
         </a>
         <div class="caption">
            <h5><b>Four Hour Work Week</b></h5>
         </div>
      </div>
   </div>
   <div class="col-sm-6 col-md-3">
      <div class="thumbnail">
         <a href="http://amzn.to/2hNVTUV" >
         <img src="http://rahulpnath.com/images/books_dothework.jpg" data-holder-rendered="true" style="display: block;">
         </a>
         <div class="caption">
            <h5><b>Do The Work</b></h5>
         </div>
      </div>
   </div>
   <div class="col-sm-6 col-md-3">
      <div class="thumbnail">
         <a href="http://amzn.to/2htP52l" >
         <img src="http://rahulpnath.com/images/books_zenhabits.jpg" data-holder-rendered="true" style="display: block;">
         </a>
         <div class="caption">
            <h5><b>Zen Habits</b></h5>
         </div>
      </div>
   </div>
   <div class="col-sm-6 col-md-3">
      <div class="thumbnail">
         <a href="http://amzn.to/2hFyZmZ" >
         <img src="http://rahulpnath.com/images/books_thepomodorotechnique.jpg" data-holder-rendered="true" style="display: block;">
         </a>
         <div class="caption">
            <h5><b>The Pomodoro Technique</b></h5>
         </div>
      </div>
   </div>
</div>
</div>


<p>Hope some of these helps you as well. Have a great year ahead!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[2016: What Went Well, What Didn't and Goals]]></title>
    <link href="http://rahulpnath.com/blog/2016-recap/"/>
    <updated>2016-12-20T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/2016-recap</id>
    <content type="html"><![CDATA[<p><a href="http://www.oldlaundrytheatre.co.uk/happy-new-year-from-all-at-the-old-laundry/">
<img class="center" alt="Posts per month - 2016" src="http://rahulpnath.com/images/2016_happy_new_year.png"/>
</a></p>

<p>2016 was a great year and I thought sharing some of the things that went well, those that didn&rsquo;t and setting goals for 2017.</p>

<blockquote><p><strong>TLDR;</strong></p>

<p><em>2016 was a great year and is the first one where I am writing a &lsquo;year in review&rsquo; post. Blogging, Videos, Open Source and Community contribution are some of the things that went well. FSharp, Reading, Travel, Photography and Exercise did not go that great. Looking forward to 2017 and planning to keep the goodness of 2016 and add some more to it</em></p></blockquote>

<h3>What went well</h3>

<h4><strong>Blogging</strong></h4>

<p>This has been a great year with my blog. On an average, I published four blog posts a month. It started with a self-challenge from March to write every day. I was able to come up with eight posts that month, but then felt it was not something that I could stick with consistently. So I kept a target of four posts per month and stuck to it for the rest of the year. I automated a lot of mundane tasks in my blogging workflow right from <a href="http://www.rahulpnath.com/blog/optimizing-octopress-workflow-for-new-posts/">creating draft posts</a> to <a href="http://www.rahulpnath.com/blog/continuos-delivery-of-octopress-blog-using-travisci-and-docker/">deploying posts</a> and <a href="http://www.rahulpnath.com/blog/automatic_deployment_of_future_posts_with_octopress/">scheduling posts for future deployment</a>. This has saved a lot of time for me and helps me stick just with the writing part of blogging!</p>

<p><img class="center" alt="Posts per month - 2016" src="http://rahulpnath.com/images/2016_postspermonth.png"/></p>

<p>Sticking with <a href="http://www.rahulpnath.com/blog/maintaining-a-blogging-schedule/">publishing posts on a regular interval</a> was more about deciding that I have to write every day. I set a &lsquo;mini habit&rsquo; to write every day - at least one line every day - and stuck to it. This helped me get over the initial inertia of starting to write a post. Having set this goal to myself I had to consistently come with topics to blog about. This very much changed the way that I approached <a href="http://www.rahulpnath.com/blog/finding-a-job-abroad/">my day job</a>. I always involved in it with the need to find something to share, in a way that I can abstract it out from the business dependencies. Most of the decisions and issues that happened to us (the development team) are now documented here. This acts as a documentation for any new joiners and makes the <a href="http://www.rahulpnath.com/blog/make-it-easy-for-the-new-person-joining-your-team-have-a-project-ramp-up-plan/">ramp up to the project a bit easier</a>. More than anything it definitely helps me find the solution when I come across the same issue again. So if you still don&rsquo;t have a blog of your own, there is no better time than now. Make it a new year resolution. <a href="http://www.rahulpnath.com/blog/own-your-urls/">Get a URL</a> and start writing. I have also been successful in getting a couple of people (at least four that I personally know of) to blog. Getting started is the biggest hurdle, the rest will fall in the due course of time.</p>

<h4><strong>Youtube Channel</strong></h4>

<p>Starting a <a href="https://www.youtube.com/c/RahulNath">Youtube channel</a> had been something I wanted to do for a long time. I have just got started with it and posted one video. I now understand why people say recording is hard - there is a lot to it and it takes time to be good at it. The only way to get better if something is hard is to do more of it - <em><a href="http://martinfowler.com/bliki/FrequencyReducesDifficulty.html">Frequency Reduces Difficulty</a></em> I plan to start with one video per month and see how it goes. I have been procrastinating on the second video for a while, <strike>will see if I can get it out before this year!</strike> <a href="https://www.youtube.com/watch?v=JbshGF4ZwGE">Got it out just in time!</a></p>

<h4><strong>Open Source and Forums</strong></h4>

<p>Contributing to Open Source projects is a good way to learn. I have always struggled to find projects/issues to contribute to. But then I learned that it is again just a matter of deciding and committing to. <a href="http://www.firsttimersonly.com/">First Timers only</a> a good way to find issues and projects that one can possible jump right into. I decided to start looking at projects that I use more on a day to day basis - Asmspy and Autofixture were something that interested me. There were a couple of open issues in AsmSpy, that I picked up and <a href="http://mikehadlow.com/">Mike Hadlow</a> was more than happy to merge them in. I also decided to set up <a href="https://github.com/mikehadlow/AsmSpy/issues/14">Chocolatey package for AsmSpy</a>. On Mike&rsquo;s request, I now manage the <a href="https://chocolatey.org/packages/asmspy/">chocolatey package account</a> and am a contributor on AsmSpy project. I automated the <a href="http://www.rahulpnath.com/blog/automated-deployment-of-asmspy-to-chocolatey-using-appveyor/">deployment pipeline for AsmSpy</a> so that I do not have to worry about deploying the chocolatey package every time a change is made. Also got to <a href="https://github.com/AutoFixture/AutoFixture/issues?q=mentions:rahulpnath+is:closed">contribute to a few issues with AutoFixture</a> which is managed by <a href="http://blog.ploeh.dk/">Mark Seemann (ploeh)</a>. I was also lucky enough to meet him in person at <a href="http://www.rahulpnath.com/blog/ndc-sydney/">NDC Sydney</a>.</p>

<p>I keep a look at the <a href="https://social.msdn.microsoft.com/Forums/azure/en-US/home?forum=AzureKeyVault">Azure Key Vault MSDN forum</a> and try to help every time a question comes up. Answering questions on forums is also a <a href="http://www.rahulpnath.com/blog/staying-in-the-learning-loop/">good way to learn</a>, find interesting problems and <a href="http://www.rahulpnath.com/blog/stars-do-count/">at times rewarding</a>.</p>

<h3>What didn&rsquo;t go well</h3>

<ul>
<li><p><strong>FSharp</strong>: Learning FSharp is something that I really want to, but it&rsquo;s not been happening that well. I am on and off with this and it keeps getting sidelined.</p></li>
<li><p><strong>Reading</strong>: Compared to <a href="https://www.goodreads.com/user_challenges/3539650">2015</a> my reading has been a lot down in <a href="https://www.goodreads.com/user_challenges/5380726">2016</a>. Though I have been listening to a lot more podcasts, I think I have to get back on with reading in the coming year.</p></li>
<li><p><strong>Travel &amp; Photography</strong>: There&rsquo;s not been much travel except for the long vacation back home and a few local places in Sydney. Though I have been clicking along I was lazy to process them. There are still lying on my camera waiting to be processed.</p></li>
<li><p><strong>Exercise</strong>: Getting enough exercise is something that I have really lacked last year and I think I have also put up some weight because of it. Except for the walk up and down from home to station for the office commute, there&rsquo;s not been much of my body moving.</p></li>
</ul>


<h3>Goals for 2017</h3>

<blockquote><p><em>In preparing for battle I have always found that plans are useless, but planning is indispensable.</em></p>

<p>― Dwight D. Eisenhower</p></blockquote>

<ul>
<li><strong>Blogging</strong>: Stick to at least four posts per month. Try to see if I can get up to 6-8. I will have to improve the time that I take to write a post for this. Handling images for the blog needs to be automated as I spent some time converting and optimizing them.</li>
<li><strong>Videos</strong>: Create a schedule for publishing videos and improve the quality and delivery of the videos.</li>
<li><strong>Reading</strong>: Set up a reading plan and read at least 21 books (1 more than what I did in 2015).</li>
<li><strong>FSharp</strong>: Learn, Contribute and Blog</li>
<li><strong>Travel &amp; Photography</strong>: One trip at least once in 3 months and post photos</li>
<li><strong>Exercise</strong>: Run/Bike at least once a week.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Make Your Code Contracts Stronger]]></title>
    <link href="http://rahulpnath.com/blog/stronger-code-contracts/"/>
    <updated>2016-12-12T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/stronger-code-contracts</id>
    <content type="html"><![CDATA[<p>How often have you gone into a class to see the implementation when consuming the class or an interface? I do this almost every other day and it&rsquo;s mostly to check how the code handles boundary conditions. What does it do when there is no value to return, does it need all parameters etc. Reading code is hard and time-consuming, even if it&rsquo;s a code that you yourself have written a few minutes back. Imagine every developer having to go into the implementation detail anytime they consume a class?    Bertrand Meyer in connection with his design of the Eiffel programming language coined the term <a href="https://en.wikipedia.org/wiki/Design_by_contract">Design By Contract</a>, an approach for designing software. The central idea of Design By Contract is to improve the contracts shared between different components in the code base. In this post, we will see how we can improve our C# code and avoid unnecessary guard statements across out code base.</p>

<p><a href="http://nebula.wsimg.com/6e7b8057c7f32b90d4f144424c8a7ae1?AccessKeyId=00F174C5B1CCF865161D&disposition=0&alloworigin=1">
<img style="box-shadow:none;" class="center" alt="Stronger Code Contracts" src="http://rahulpnath.com/images/strong_code_contracts.jpg"/>
</a></p>

<h3>Leaky Abstraction</h3>

<p>These days in programming we tend to abstract a lot more than what we really need. <a href="http://www.rahulpnath.com/blog/category/dependency-injection/">Dependency Injection</a> and use of IOC containers have started forcing ourselves to think that everything needs to be an interface. But essentially this is not the case. But the bigger problem lies not in the abstraction, but on depending on the implementation details after abstracting. A <a href="https://en.wikipedia.org/wiki/Leaky_abstraction">leaky abstraction</a> is an abstraction that exposes details and limitations of its underlying implementation to its users that should ideally be hidden away.</p>

<blockquote><p><em>Consuming abstractions assuming a certain implementation is bad practice</em></p></blockquote>

<p>Recently I came across the below code during a code review. Even though an empty string was not a valid configuration value that was not being checked here as the repository implementation returns a null when there is no entry.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="kt">string</span> <span class="n">config</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">GetConfig</span><span class="p">();</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="n">config</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="p">...</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is a common practice and I have myself fallen for this a lot of times. The fact that the repository returns only a null value is an abstraction detail and is not clear from the contract that it exposes. Anyone could change the repository to start returning an empty string. This will then start failing this code. When taken in isolation the code that uses &lsquo;config&rsquo; must check for null and empty to avoid invalid values. The abstraction contracts (function signatures) must convey whether it always returns a value, whether it can be empty or null. This helps remove unnecessary guarding code or makes guarding mandatory across the code base and also indicates a clear intent.</p>

<p>The <a href="https://en.wikipedia.org/wiki/Robustness_principle">Robustness Principle</a> is a general design guideline for software</p>

<blockquote><p><em>Be conservative in what you do, be liberal in what you accept from others (often reworded as &ldquo;Be conservative in what you send, be liberal in what you accept&rdquo;).</em></p></blockquote>

<p>Applying this principle in this context, we must be conservative in what we return from our function (be it a class or interface) contract. The contract should be as explicit as possible to indicate the nature of values that it returns.</p>

<h3>Stronger Return Types</h3>

<p>A repository returning a string is a weak contract, as it does not clearly express the nature of value it returns. It can return either of these three values - null, an empty string or a valid configuration string. In our application, assuming that null and empty string are invalid we should be having a single representation for this state in the application. C# by its very design encourages us to use this pattern as it embraces the concept of null&rsquo;s - <a href="https://www.linkedin.com/pulse/20141126171912-7082046-tony-hoare-invention-of-the-null-reference-a-billion-dollar-mistake">the billion dollar mistake</a>. But this does not mean we are restricted by it. We can bring in concepts from other languages to help us solve this problem. In F# for example, the Option type represents presence or absence of a value. This is similar to the <a href="https://msdn.microsoft.com/en-us/library/1t3y8s4s.aspx">Nullable type in C#</a>, but not just restricted to value types. <a href="http://fsharpforfunandprofit.com/posts/the-option-type/">Option type</a> is defined as union type with two cases : Some and None. Whenever consuming an option type the compiler forces us to handle both the cases</p>

<blockquote><p><em>In pure F#, <a href="https://fsharpforfunandprofit.com/posts/correctness-exhaustive-pattern-matching/">nulls cannot exist accidentally</a>. A string or object must always be assigned to something at creation, and is immutable thereafter</em></p></blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='fsharp'><span class='line'><span class="k">let</span> <span class="nv">config</span> <span class="o">=</span> <span class="n">getConfig</span>
</span><span class='line'><span class="k">match</span> <span class="n">config</span> <span class="k">with</span>
</span><span class='line'><span class="o">|</span> <span class="n">None</span> <span class="o">-&gt;</span> <span class="n">printfn</span> <span class="s">&quot;Invalid config&quot;</span>
</span><span class='line'><span class="o">|</span> <span class="n">Some</span> <span class="n">c</span> <span class="o">-&gt;</span> <span class="n">printgn</span> <span class="s">&quot;Valid config&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Though C# does not have anything out of the box to define optional values, we can define one of our own. The <a href="https://github.com/ploeh/Booking/blob/master/BookingDomainModel/Maybe.cs">Maybe</a> class is one such implementation of an optional concept. The name is influenced by the option type in Haskell, <a href="https://wiki.haskell.org/Maybe">Maybe</a>. There are also other implementations of Maybe but the concept remains the same - we can represent an optional type in C#.  The code contracts are stronger using Maybe as a return type. If a function always returns a value, say a string, the function contract should remain as a string. If a function cannot return a value always and can return null/empty (assuming that these are invalid values) then it returns a <em>Maybe<string></em>. This makes it clearer for consuming code on whether they should check for null/empty values.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">Maybe</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">config</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">GetConfig</span><span class="p">();</span>
</span><span class='line'><span class="n">config</span><span class="p">.</span><span class="n">Do</span><span class="p">(</span><span class="k">value</span> <span class="p">=&gt;</span> <span class="n">LoadFromFile</span><span class="p">(</span><span class="k">value</span><span class="p">));</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can write different extension methods on the Maybe class, depending on how you want to process the value. In the above example, I have a Do extension method that calls on to a function with the configuration value if any exists. By explicitly stating that a value may or may not be present we have more clarity in code. No longer do we need any unnecessary null checks in the case where a value is always present. This is best achieved when agreed upon as a convention by the development team and enforced through tooling (like code analysis).</p>

<h3>Value Objects</h3>

<p>One of the root problem for having a lot of null/empty checks scattered across the code is <a href="http://blog.ploeh.dk/2015/01/19/from-primitive-obsession-to-domain-modelling/">Primitive Obsession</a>. Just because you can represent a value as a string, it doesn&rsquo;t mean that you always should. Enforcing structural restrictions imposed by the business is best done by encapsulating these constraints within a class, also known as a <a href="http://www.rahulpnath.com/blog/thinking-beyond-primitive-values-value-objects/">Value Object</a>. This leads to classes for representing various non-nullable values for e.g. Name, configuration, Age etc. You can use this in conjunction with <a href="https://en.wikipedia.org/wiki/Null_Object_pattern">Null Object</a> pattern if required. A value object is a class whose equality is based on the value that it holds. So two class instances with same values will be treated equally. In F# you get this by default but in C# you need to override Equals and GetHashCode functions to enforce this equality.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">Configuration</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">private</span> <span class="kt">string</span> <span class="n">configuration</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="nf">Configuration</span><span class="p">(</span><span class="kt">string</span> <span class="n">configuration</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">configuration</span><span class="p">))</span>
</span><span class='line'>            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">configuration</span><span class="p">),</span> <span class="s">&quot;Configuration value cannot be null&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="n">configuration</span> <span class="p">=</span> <span class="n">configuration</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// override Equals and GetHashCode</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Modeling concepts in the domain as classes helps you to contain the domain/business constraints in a single place. This prevents the need to have null checks elsewhere in the code. Value objects being immutable helps enforce class invariants.</p>

<p>The above two methods help create a stronger contract in code. As with any conventions, this is useful only when followed by the whole team. Conventions are best followed if enforced through tooling. You can create custom code analysis rules to enforce return type to be of type if any method is returning null. Even if you are introducing this into a large existing code base you can do this incrementally, by starting to enforce them on commits (if you are using git) like when <a href="http://www.rahulpnath.com/blog/introducing-code-formatting-into-a-large-codebase/">introducing styling into an existing project</a>. What other contracts do you find helpful to make the code more expressive?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Solve the Business Problem, Don't Mimic The Process]]></title>
    <link href="http://rahulpnath.com/blog/solve-the-business-problem-dont-mimic-the-process/"/>
    <updated>2016-12-06T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/solve-the-business-problem-dont-mimic-the-process</id>
    <content type="html"><![CDATA[<p><a href="http://www.dhc-gmbh.com/en/kompetenzen/business-process-management/"><img class="center" alt="Business" src="http://rahulpnath.com/images/business_problem_automation.jpg"/></a></p>

<p>While working with clients I often get into conversations with the domain experts and people involved directly with the business. The discussions usually happen around what the process they are currently doing and how to automate those. Knowing the business process is helpful but getting influenced by that to design the solution is often not effective. Recently our team was in a conversation with a domain expert for a new feature request.</p>

<div class="alert alert-warning">
The series of events mentioned below were modified to fit into the conversational style used in the post.
</div>


<blockquote><p><em><strong>Domain Expert</strong> We need to charge customers a processing fee if they pay using an electronic payment method. Depending on the type of card (mastercard, visa etc) the processing charge percentage differs. The processing fees are always charged in the subsequent billing period after their current payment. For e.g. if a customer pays 1000$ for the month of November, then his December bill will have 2% card processing charge in the December invoice</em></p>

<p><em><strong>Team</strong> That sounds easy, think we have enough details to get started on this. Thank you.</em></p>

<p><em><strong>Domain Expert</strong> Perfect. Ahhh&hellip; Before you go, I think this can be a <a href="http://hangfire.io/">hangfire job</a> that runs on 29 every month, a few days before the billing date, 3rd, and generate these charges for the client. This is what we do manually at present. (And walks off)</em></p>

<p><em><strong>Team</strong> Discussing amongst themselves the team agreed that creating a recurring job is the way to go. Based on the assumption that this job will be run only once a month, the job was to read all the invoices from 29th of the previous month till 28th of the current month and charge the clients. The meeting was dismissed and off went everyone busy to get the new feature out</em></p></blockquote>

<h3>Business has Exceptions</h3>

<p>Problems started coming up the immediate month of feature deployment. Below is the sequence of events that happened.</p>

<ul>
<li><strong>29th</strong> : Nice work, team! The processing charges have been applied as expected.</li>
<li><strong>30th</strong> : Some of the invoices have wrong data. We have deleted them. Can you run the job?</li>
<li><strong>2nd</strong> : A few of our clients (as usual) paid late and we need to charge their processing fees. Can you run the job?</li>
<li><strong>15th</strong> : One of our clients is ending tomorrow, so we need to send them an invoice and it should include the processing fees for their last payment. Can you run the job?</li>
</ul>


<p>But wait! We had decided that we will run this job only once a month and that is the only time we need to process the charges. We cannot run that job over and over again.</p>

<blockquote><p><em>What I’ve noticed over the years is that our users find very creative ways to achieve their business objectives despite the limitations of the system that they’re working with. We developers ultimately see these as requirements, but they are better interpreted as <strong>workarounds</strong>.</em></p>

<p><strong><em>- <a href="http://udidahan.com/2013/04/28/queries-patterns-and-search-food-for-thought/">Udi Dahan</a></em></strong></p></blockquote>

<p>The business was right when it said that <em>&lsquo;This is what we do manually at present.</em> What they did not say though is that there were always exceptions. And in these cases, they did the same process, but just for those exceptions. Business process mostly will be around the majority of the cases and the exceptions always get handled ad-hoc. So for the business it&rsquo;s always that which takes a good part of their time that matters more.</p>

<h3>Finding the Way Out</h3>

<p>The problem, in this case, was that the team modeled the solution exactly as the business did manually. Think kind of a solution is most likely to fail in case of exceptions. The human brain can easily deal with these exceptions. But for a program to solve it that way it needs to be told so, which implies that there need to be alternate flow paths defined. So with the improved understanding of these exception cases, the team does another analysis through the problem. After some discussion the team re-defines their original problem statement - *We need to be able to run the job any number of times and it should have the same effect.</p>

<blockquote><p><em>A payment should get </em>one and only one<em> processing charge associated, no matter however times it is seen by the job.</em></p></blockquote>

<p>With the new implementation, we decided to maintain a list of payments (a strong identifier that does not change) we have seen and processed. So every time a payment is seen, it is matched to see if it is already processed. If a charge is not already applied, a charge is applied and added to the list of processed payments. This ensures that they can run the job anytime. The team added in capability to specify the time range to look for invoices. By default, this ranged from 29th - 28th. The team also added in a way to void out payment charges applied, so that whenever the invoices changed then can just clear that off and re-run the job. These changes gave the flexibility to meet the businesses exception cases.</p>

<h3>Idempotent</h3>

<blockquote><p><em>The term <a href="http://www.enterpriseintegrationpatterns.com/patterns/messaging/IdempotentReceiver.html">idempotent</a> is used in mathematics to describe a function that produces the same result if it is applied to itself, i.e. f(x) = f(f(x)). In Messaging this concept translates into a message that has the same effect whether it is received once or multiple times. This means that a message can safely be re-sent without causing any problems even if the receiver receives duplicates of the same message.</em></p></blockquote>

<p>Being idempotent is what we missed with the first implementation. There was an assumed &lsquo;idempotency&rsquo; that the job will be run only once a month. But this constraint is not something that the code had control of and something it could enforce. The job was also not idempotent at the granular level that it was affecting - payments. Asserting idempotency at the batch level fails when we want to re-run batches (when exceptions like the wrong invoice happens). Idempotency should be enforced at the unit level of change, which is what maintaining a list of processed payments helps with. Any payment that is not processed before will get processed now when the job is run. We can also ensure that the payment will only be processed at most once.</p>

<p>This is just an example where we fail to see beyond the business problem and also see the computing problems accompanying it. Not always will it be easy and fast to rewrite the code. Even if we fail to see these problems the business will eventually make us to. But it is when we can see the computing problems that accompanies a business problem that we start becoming better developers. Applying basic computing principles, probing the domain expert during discussions, sitting with domain experts while they work etc. are all good ways to start seeing the untold business processes. Hope this helps the next time you are into a meeting with domain expert or solving a business problem.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Expiry Notification for Azure Key Vault Keys and Secrets]]></title>
    <link href="http://rahulpnath.com/blog/expiry-notification-for-azure-key-vault-keys-and-secrets/"/>
    <updated>2016-12-01T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/expiry-notification-for-azure-key-vault-keys-and-secrets</id>
    <content type="html"><![CDATA[<p>I came across this <a href="https://social.msdn.microsoft.com/Forums/azure/en-US/90d4b814-f025-42a0-acac-b8c8bf9d8cf8/alert-or-event-on-secret-expiry?forum=AzureKeyVault">question</a> in Azure Key Vault forums looking for options to get notified when Key or Secrets in vault nears expiry. It&rsquo;s useful to know when Object&rsquo;s (Keys/Secrets) near expiry, to take necessary action. I decided to explore on my proposed solution of having a scheduled custom PowerShell script to notify when a key is about to expire. In this post, we will see how to get all objects nearing expiry and scheduling this using Azure Runbook to run daily.</p>

<h3>Getting Expiring Objects</h3>

<p>Both Keys and Secrets can be set with an Expiry date. The expiry date can be set when creating the Object or can be set on an existing Object. This can be set from the UI or using PowerShell scripts (setting the <a href="https://msdn.microsoft.com/en-us/library/dn868045.aspx">-Expires attribute</a>).</p>

<p><img class="center" alt="Azure Key Vault - Set Key Expiry" src="http://rahulpnath.com/images/vaultexpiry_key.png"/></p>

<p>Key Vault (at the time of writing) throws an <a href="https://social.msdn.microsoft.com/Forums/azure/en-US/c0d8953a-c117-4ca4-ad3d-e5d2b1868f9e/get-operation-not-permitted-for-some-of-the-secret-in-my-vault?forum=AzureKeyVault">exception</a> when an expired key is accessed over the API. Also, it does not provide any notification whenever a key/secret is about to expire. The last thing you want is your application go down because of an expired object in the vault. With the Get and List access on the vault, we can retrieve all the keys and secrets in the vault and loop through the elements to see objects that are nearing expiry.</p>

<p>The PowerShell script takes the Vault Name, number of days before with alert should be raised and flags to indicate whether all versions of keys/secrets should be checked for expiry. The full script is available <a href="https://github.com/rahulpnath/Blog/blob/master/KeyVaultExpiryAlerter/Expiry%20Alert.ps1">here</a>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='powershell'><span class='line'><span class="nv">$VaultName</span> <span class="p">=</span> <span class="s1">&#39;&#39;</span>
</span><span class='line'><span class="nv">$IncludeAllKeyVersions</span> <span class="p">=</span> <span class="nv">$true</span>
</span><span class='line'><span class="nv">$IncludeAllSecretVersions</span> <span class="p">=</span> <span class="nv">$true</span>
</span><span class='line'><span class="nv">$AlertBeforeDays</span> <span class="p">=</span> <span class="n">3</span>
</span></code></pre></td></tr></table></div></figure>


<p>All keys and secrets are converted into a common object model, which contains just the Identifier, Name, Version and the Expiry Date if it has one.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='powershell'><span class='line'><span class="k">Function</span> <span class="nb">New-KeyVaultObject</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">param</span>
</span><span class='line'>    <span class="p">(</span>
</span><span class='line'>        <span class="no">[string]</span><span class="nv">$Id</span><span class="p">,</span>
</span><span class='line'>        <span class="no">[string]</span><span class="nv">$Name</span><span class="p">,</span>
</span><span class='line'>        <span class="no">[string]</span><span class="nv">$Version</span><span class="p">,</span>
</span><span class='line'>        <span class="no">[System.Nullable[DateTime]]</span><span class="nv">$Expires</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$server</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">PSObject</span>
</span><span class='line'>    <span class="nv">$server</span> <span class="p">|</span> <span class="nb">Add-Member</span> <span class="n">-MemberType</span> <span class="n">NoteProperty</span> <span class="n">-Name</span> <span class="n">Id</span> <span class="n">-Value</span> <span class="nv">$Id</span>
</span><span class='line'>    <span class="nv">$server</span> <span class="p">|</span> <span class="nb">Add-Member</span> <span class="n">-MemberType</span> <span class="n">NoteProperty</span> <span class="n">-Name</span> <span class="n">Name</span> <span class="n">-Value</span> <span class="nv">$Name</span>
</span><span class='line'>    <span class="nv">$server</span> <span class="p">|</span> <span class="nb">Add-Member</span> <span class="n">-MemberType</span> <span class="n">NoteProperty</span> <span class="n">-Name</span> <span class="n">Version</span> <span class="n">-Value</span> <span class="nv">$Version</span>
</span><span class='line'>    <span class="nv">$server</span> <span class="p">|</span> <span class="nb">Add-Member</span> <span class="n">-MemberType</span> <span class="n">NoteProperty</span> <span class="n">-Name</span> <span class="n">Expires</span> <span class="n">-Value</span> <span class="nv">$Expires</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nv">$server</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Depending on the flag set for retrieving all key/secret version, it fetches objects from the vault and returns in the common object model above.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
</pre></td><td class='code'><pre><code class='powershell'><span class='line'><span class="k">function</span> <span class="nb">Get-AzureKeyVaultObjectKeys</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">param</span>
</span><span class='line'>  <span class="p">(</span>
</span><span class='line'>   <span class="no">[string]</span><span class="nv">$VaultName</span><span class="p">,</span>
</span><span class='line'>   <span class="no">[bool]</span><span class="nv">$IncludeAllVersions</span>
</span><span class='line'>  <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="nv">$vaultObjects</span> <span class="p">=</span> <span class="no">[System.Collections.ArrayList]</span><span class="p">@()</span>
</span><span class='line'>  <span class="nv">$allKeys</span> <span class="p">=</span> <span class="nb">Get-AzureKeyVaultKey</span> <span class="n">-VaultName</span> <span class="nv">$VaultName</span>
</span><span class='line'>  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$key</span> <span class="k">in</span> <span class="nv">$allKeys</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span><span class="p">(</span><span class="nv">$IncludeAllVersions</span><span class="p">){</span>
</span><span class='line'>     <span class="nv">$allSecretVersion</span> <span class="p">=</span> <span class="nb">Get-AzureKeyVaultKey</span> <span class="n">-VaultName</span> <span class="nv">$VaultName</span> <span class="n">-IncludeVersions</span> <span class="n">-Name</span> <span class="nv">$key</span><span class="p">.</span><span class="n">Name</span>
</span><span class='line'>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$key</span> <span class="k">in</span> <span class="nv">$allSecretVersion</span><span class="p">){</span>
</span><span class='line'>         <span class="nv">$vaultObject</span> <span class="p">=</span> <span class="nb">New-KeyVaultObject</span> <span class="n">-Id</span> <span class="nv">$key</span><span class="p">.</span><span class="n">Id</span> <span class="n">-Name</span> <span class="nv">$key</span><span class="p">.</span><span class="n">Name</span> <span class="n">-Version</span> <span class="nv">$key</span><span class="p">.</span><span class="n">Version</span> <span class="n">-Expires</span> <span class="nv">$key</span><span class="p">.</span><span class="n">Expires</span>
</span><span class='line'>         <span class="nv">$vaultObjects</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="nv">$vaultObject</span><span class="p">)</span>
</span><span class='line'>     <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="nv">$vaultObject</span> <span class="p">=</span> <span class="nb">New-KeyVaultObject</span> <span class="n">-Id</span> <span class="nv">$key</span><span class="p">.</span><span class="n">Id</span> <span class="n">-Name</span> <span class="nv">$key</span><span class="p">.</span><span class="n">Name</span> <span class="n">-Version</span> <span class="nv">$key</span><span class="p">.</span><span class="n">Version</span> <span class="n">-Expires</span> <span class="nv">$key</span><span class="p">.</span><span class="n">Expires</span>
</span><span class='line'>      <span class="nv">$vaultObjects</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="nv">$vaultObject</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nv">$vaultObjects</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">function</span> <span class="nb">Get-AzureKeyVaultObjectSecrets</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">param</span>
</span><span class='line'>  <span class="p">(</span>
</span><span class='line'>   <span class="no">[string]</span><span class="nv">$VaultName</span><span class="p">,</span>
</span><span class='line'>   <span class="no">[bool]</span><span class="nv">$IncludeAllVersions</span>
</span><span class='line'>  <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="nv">$vaultObjects</span> <span class="p">=</span> <span class="no">[System.Collections.ArrayList]</span><span class="p">@()</span>
</span><span class='line'>  <span class="nv">$allSecrets</span> <span class="p">=</span> <span class="nb">Get-AzureKeyVaultSecret</span> <span class="n">-VaultName</span> <span class="nv">$VaultName</span>
</span><span class='line'>  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$secret</span> <span class="k">in</span> <span class="nv">$allSecrets</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span><span class="p">(</span><span class="nv">$IncludeAllVersions</span><span class="p">){</span>
</span><span class='line'>     <span class="nv">$allSecretVersion</span> <span class="p">=</span> <span class="nb">Get-AzureKeyVaultSecret</span> <span class="n">-VaultName</span> <span class="nv">$VaultName</span> <span class="n">-IncludeVersions</span> <span class="n">-Name</span> <span class="nv">$secret</span><span class="p">.</span><span class="n">Name</span>
</span><span class='line'>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$secret</span> <span class="k">in</span> <span class="nv">$allSecretVersion</span><span class="p">){</span>
</span><span class='line'>         <span class="nv">$vaultObject</span> <span class="p">=</span> <span class="nb">New-KeyVaultObject</span> <span class="n">-Id</span> <span class="nv">$secret</span><span class="p">.</span><span class="n">Id</span> <span class="n">-Name</span> <span class="nv">$secret</span><span class="p">.</span><span class="n">Name</span> <span class="n">-Version</span> <span class="nv">$secret</span><span class="p">.</span><span class="n">Version</span> <span class="n">-Expires</span> <span class="nv">$secret</span><span class="p">.</span><span class="n">Expires</span>
</span><span class='line'>         <span class="nv">$vaultObjects</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="nv">$vaultObject</span><span class="p">)</span>
</span><span class='line'>     <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="nv">$vaultObject</span> <span class="p">=</span> <span class="nb">New-KeyVaultObject</span> <span class="n">-Id</span> <span class="nv">$secret</span><span class="p">.</span><span class="n">Id</span> <span class="n">-Name</span> <span class="nv">$secret</span><span class="p">.</span><span class="n">Name</span> <span class="n">-Version</span> <span class="nv">$secret</span><span class="p">.</span><span class="n">Version</span> <span class="n">-Expires</span> <span class="nv">$secret</span><span class="p">.</span><span class="n">Expires</span>
</span><span class='line'>      <span class="nv">$vaultObjects</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="nv">$vaultObject</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nv">$vaultObjects</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now that we have all the keys and secrets we want to check for expiry all we need to know is if there are any keys that are expiring in the upcoming days.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='powershell'><span class='line'><span class="nv">$allKeyVaultObjects</span> <span class="p">=</span> <span class="no">[System.Collections.ArrayList]</span><span class="p">@()</span>
</span><span class='line'><span class="nv">$allKeyVaultObjects</span><span class="p">.</span><span class="n">AddRange</span><span class="p">((</span><span class="nb">Get-AzureKeyVaultObjectKeys</span> <span class="n">-VaultName</span> <span class="nv">$VaultName</span> <span class="n">-IncludeAllVersions</span> <span class="nv">$IncludeAllKeyVersions</span><span class="p">))</span>
</span><span class='line'><span class="nv">$allKeyVaultObjects</span><span class="p">.</span><span class="n">AddRange</span><span class="p">((</span><span class="nb">Get-AzureKeyVaultObjectSecrets</span> <span class="n">-VaultName</span> <span class="nv">$VaultName</span> <span class="n">-IncludeAllVersions</span> <span class="nv">$IncludeAllSecretVersions</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Get expired Objects</span>
</span><span class='line'><span class="nv">$today</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Date</span><span class="p">).</span><span class="n">Date</span>
</span><span class='line'><span class="nv">$expiredKeyVaultObjects</span> <span class="p">=</span> <span class="no">[System.Collections.ArrayList]</span><span class="p">@()</span>
</span><span class='line'><span class="k">foreach</span><span class="p">(</span><span class="nv">$vaultObject</span> <span class="k">in</span> <span class="nv">$allKeyVaultObjects</span><span class="p">){</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nv">$vaultObject</span><span class="p">.</span><span class="n">Expires</span> <span class="o">-and</span> <span class="nv">$vaultObject</span><span class="p">.</span><span class="n">Expires</span><span class="p">.</span><span class="n">AddDays</span><span class="p">(-</span><span class="nv">$AlertBeforeDays</span><span class="p">).</span><span class="n">Date</span> <span class="o">-lt</span> <span class="nv">$today</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="c"># add to expiry list</span>
</span><span class='line'>  <span class="nv">$expiredKeyVaultObjects</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="nv">$vaultObject</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Out-Null</span>
</span><span class='line'>  <span class="nb">Write-Output</span> <span class="s2">&quot;Expiring&quot;</span> <span class="nv">$vaultObject</span><span class="p">.</span><span class="n">Id</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Pass to Alerter $expiredKeyVaultObjects</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Scheduling Expiry Notification using Azure Runbook</h3>

<p>You can either run this manually every time you want to get a list of objects that are expired or nearing expiry. Alternatively, you can set up a scheduled task to run the script at a set frequency. Since you are already on Azure, you can try <a href="https://azure.microsoft.com/en-us/services/automation/">Azure Automation</a> and schedule the task for you. A Runbook in Azure Automation account can be granted access to the key vault. The Automation account should have &lsquo;Run as account&rsquo; setup and the service principal created for it can be used to assign Access Policies to access the vault. Check out the <a href="http://rahulpnath.com/blog/accessing-azure-key-vault-from-azure-runbook">Accessing Azure Key Vault From Azure Runbook</a> post for a step by step instruction on how to setup runbook to access key vault. You can then <a href="https://azure.microsoft.com/en-us/documentation/articles/automation-scheduling-a-runbook/">schedule the runbook</a> to execute at fixed time intervals. Feel free to modify the script to send email notifications or push notification or any other that matches your need.</p>

<p>Generally, it is a good practice to rotate your keys and secrets once in a while. Use the expiry attribute to set the expiry and force yourself to keep your sensitive configurations fresh. It&rsquo;s likely that such a notification feature will be built into the key vault. But till then Hope this helps to keep track of keys or secrets that are nearing expiry within the vault and take the necessary action to renew them. The full script is available <a href="https://github.com/rahulpnath/Blog/blob/master/KeyVaultExpiryAlerter/Expiry%20Alert.ps1">here</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Accessing Azure Key Vault From Azure Runbook]]></title>
    <link href="http://rahulpnath.com/blog/accessing-azure-key-vault-from-azure-runbook/"/>
    <updated>2016-11-21T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/accessing-azure-key-vault-from-azure-runbook</id>
    <content type="html"><![CDATA[<p>Azure Automation is a new service in Azure that allows you to automate your Azure management tasks and to orchestrate actions across external systems from right within Azure. If you are new to Azure Automation, get started <a href="https://azure.microsoft.com/en-us/blog/azure-automation-runbook-management/">here</a>. Runbooks live within the Azure Automation account and can execute PowerShell scripts. In this post, I will walk you through on how to use Key Vault from an Azure Automation Runbook.</p>

<p>To create a Runbook go to &lsquo;Add a Runbook&rsquo; under  Automation Account, Runbooks as shown in the image below. Once created you can author your PowerShell script there.</p>

<p><img class="center" alt="Azure Automation Create a Runbook" src="http://rahulpnath.com/images/runbook_create.png"/></p>

<p>In this example I will get all the Keys from an existing key vault, using the <a href="https://msdn.microsoft.com/en-us/library/dn868053.aspx">Get-AzureKeyVaultKey</a> cmdlet. This returns all the key for the given key vault.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='powershell'><span class='line'><span class="nb">Get-AzureKeyVaultKey</span> <span class="n">-VaultName</span> <span class="n">YoutubeVault</span>
</span></code></pre></td></tr></table></div></figure>


<p>If we are to run this script now, it will fail for many reasons - we do not have the key vault cmdlets imported in the runbook nor have we given access to the automation account to access the keys in the vault. Running it gives me the below error.</p>

<p><span style='color:red'><em>Get-AzureKeyVaultKey : The term &lsquo;Get-AzureKeyVaultKey&rsquo; is not recognized as the name of a cmdlet, function script, file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again </em></span>.</p>

<p>Under &lsquo;Assets&rsquo; from the Azure Automation account Resources section select &lsquo;Modules&rsquo; (as shown in the image below) to add in Modules to the runbook. To execute key vault cmdlets in the runbook, we need to add <em>AzureRM.profile</em> and AzureRM.key vault. Search for this under &lsquo;Browse Gallery&rsquo; and import.</p>

<p><img class="center" alt="Azure Runbook Add KeyVault Module" src="http://rahulpnath.com/images/runbook_add_Module.png"/></p>

<p>To give Runbook access to the keys in the vault, it needs to be specified in the Access Policies of the key vault. The &lsquo;Run As Accounts&rsquo; feature will create a new service principal user in Azure Active Directory and assign the Contributor role to this user at the subscription. The &lsquo;Application ID&rsquo; from creating the run as account is used to assign Access Policies for the key vault. In this example, I give the &lsquo;list&rsquo; and &lsquo;get&rsquo; PermissionToKeys.</p>

<p><img class="center" alt="Azure Automation Runbook, set run as account" src="http://rahulpnath.com/images/runbook_run_as_accounts.png"/></p>

<p>You can use the <a href="https://azure.microsoft.com/en-us/documentation/articles/automation-sec-configure-azure-runas-account/#sample-code-to-authenticate-with-resource-manager-resources">sample code below</a>, taken from the AzureAutomationTutorialScript example runbook, to authenticate using the Run As account to manage Resource Manager resources with your runbooks. The <em>AzureRunAsConnection</em> is a connection asset automatically created when we created &lsquo;run as accounts&rsquo; above. This can be found under Assets -> Connections. After the authentication code, I run the same code above to get all the keys from the vault.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='powershell'><span class='line'><span class="nv">$connectionName</span> <span class="p">=</span> <span class="s2">&quot;AzureRunAsConnection&quot;</span>
</span><span class='line'><span class="k">try</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c"># Get the connection &quot;AzureRunAsConnection &quot;</span>
</span><span class='line'>    <span class="nv">$servicePrincipalConnection</span><span class="p">=</span><span class="nb">Get-AutomationConnection</span> <span class="n">-Name</span> <span class="nv">$connectionName</span>
</span><span class='line'>
</span><span class='line'>    <span class="s2">&quot;Logging in to Azure...&quot;</span>
</span><span class='line'>    <span class="nb">Add-AzureRmAccount</span> <span class="p">`</span>
</span><span class='line'>        <span class="n">-ServicePrincipal</span> <span class="p">`</span>
</span><span class='line'>        <span class="n">-TenantId</span> <span class="nv">$servicePrincipalConnection</span><span class="p">.</span><span class="n">TenantId</span> <span class="p">`</span>
</span><span class='line'>        <span class="n">-ApplicationId</span> <span class="nv">$servicePrincipalConnection</span><span class="p">.</span><span class="n">ApplicationId</span> <span class="p">`</span>
</span><span class='line'>        <span class="n">-CertificateThumbprint</span> <span class="nv">$servicePrincipalConnection</span><span class="p">.</span><span class="n">CertificateThumbprint</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">catch</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(!</span><span class="nv">$servicePrincipalConnection</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="nv">$ErrorMessage</span> <span class="p">=</span> <span class="s2">&quot;Connection $connectionName not found.&quot;</span>
</span><span class='line'>        <span class="k">throw</span> <span class="nv">$ErrorMessage</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span><span class="p">{</span>
</span><span class='line'>        <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Exception</span>
</span><span class='line'>        <span class="k">throw</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Exception</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nb">Get-AzureKeyVaultKey</span> <span class="n">-VaultName</span> <span class="n">YoutubeVault</span>
</span></code></pre></td></tr></table></div></figure>


<p>On execution, the Runbook can connect to the key vault and retrieve all the keys. Based on the permissions set on the vault you can perform different actions on the key vault. This helps in automating a lot of tasks that otherwise needs to be done manually. Hope this helps you connect Runbooks with Key Vault.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Azure Key Vault: Digital Signatures and Offline Verification]]></title>
    <link href="http://rahulpnath.com/blog/azure-key-vault-digital-signatures-and-offline-verification/"/>
    <updated>2016-11-15T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/azure-key-vault-digital-signatures-and-offline-verification</id>
    <content type="html"><![CDATA[<p>Digital Signature is a mechanism to ensure the validity of a digital document or message. Digital signatures use <a href="http://www.rahulpnath.com/blog/getting-started-with-azure-key-vault/">asymmetric cryptography</a> - uses a public and private key pair.</p>

<blockquote><p><em>A valid <a href="https://en.wikipedia.org/wiki/Digital_signature">digital signature</a> gives a recipient reason to believe that the message was created by a known sender (authentication), that the sender cannot deny having sent the message (non-repudiation), and that the message was not altered in transit (integrity)</em></p></blockquote>

<p>The below diagram shows the overview of the different steps involved in the Digital Signature process. We generate a hash of the data that we need to protect and encrypt the hash value using a private key pair. This signed hash is sent along with the original data. The receiver generates a hash of the data received and also decrypts the attached signature using the public key. If both the hashes are same, the signature is valid, and the document has not been tampered with.</p>

<p><a href="https://commons.wikimedia.org/wiki/File:Digital_Signature_diagram.svg"><img class="center" alt="Azure Key Vault - Verify Signature Offline" src="http://rahulpnath.com/images/signing_verification.png"/></a></p>

<p>Azure Key Vault supports sign and verify operations and can be used to implement Digital Signatures. In this post, we will explore how to sign and verify a message using Key Vault. Verifying the hash locally is the recommended approach as per the <a href="https://msdn.microsoft.com/en-us/library/azure/dn903623.aspx#BKMK_KeyOperations">documentation</a> and we will explore how this can be achieved.</p>

<blockquote><p><em>Verification of signed hashes is supported as a convenience operation for applications that may not have access to [public] key material; it is recommended that, for best application performance, verify operations are performed locally.</em></p></blockquote>

<h3>Signing Data</h3>

<p>Sign and Verify operations on Key Vault are allowed only on hashed data. So the application calling these API methods should locally hash the data before invoking the method. The algorithm property value passed to the Key Vault Client API depends on the hashing algorithm used to hash the data. Below are the <a href="https://msdn.microsoft.com/library/en-us/Mt149357.aspx">supported algorithms</a>.</p>

<ul>
<li><em>RS256: RSASSA-PKCS-v1_5 using SHA-256. The application supplied digest value must be computed using SHA-256 and must be 32 bytes in length.</em></li>
<li><em>RS384: RSASSA-PKCS-v1_5 using SHA-384. The application supplied digest value must be computed using SHA-384 and must be 48 bytes in length.</em></li>
<li><em>RS512: RSASSA-PKCS-v1_5 using SHA-512. The application supplied digest value must be computed using SHA-512 and must be 64 bytes in length.</em></li>
<li><em>RSNULL: See [RFC2437], a specialized use-case to enable certain TLS scenarios.</em></li>
</ul>


<p>The below code sample uses SHA-256 hashing algorithm to hash and sign the data.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="kt">var</span> <span class="n">textToEncrypt</span> <span class="p">=</span> <span class="s">&quot;This is a test message&quot;</span><span class="p">;</span>
</span><span class='line'><span class="kt">var</span> <span class="n">byteData</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">Unicode</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">textToEncrypt</span><span class="p">);</span>
</span><span class='line'><span class="kt">var</span> <span class="n">hasher</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SHA256CryptoServiceProvider</span><span class="p">();</span>
</span><span class='line'><span class="kt">var</span> <span class="n">digest</span> <span class="p">=</span> <span class="n">hasher</span><span class="p">.</span><span class="n">ComputeHash</span><span class="p">(</span><span class="n">byteData</span><span class="p">);</span>
</span><span class='line'><span class="kt">var</span> <span class="n">signedResult</span> <span class="p">=</span> <span class="k">await</span> <span class="n">keyVaultClient</span>
</span><span class='line'>    <span class="p">.</span><span class="n">SignAsync</span><span class="p">(</span><span class="n">keyIdentifier</span><span class="p">,</span> <span class="n">JsonWebKeySignatureAlgorithm</span><span class="p">.</span><span class="n">RS256</span><span class="p">,</span> <span class="n">digest</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Verify Online</h3>

<p>To verify a signature online, the keyVaultClient supports a <a href="https://msdn.microsoft.com/en-us/library/microsoft.azure.keyvault.keyvaultclient.verifyasync.aspx">Verify method</a>. It takes the key identifier, algorithm, digest and signature to verify if the signature is valid for the given digest.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="kt">var</span> <span class="n">isVerified</span> <span class="p">=</span> <span class="k">await</span> <span class="n">keyVaultClient</span>
</span><span class='line'>    <span class="p">.</span><span class="n">VerifyAsync</span><span class="p">(</span><span class="n">keyIdentifier</span><span class="p">,</span> <span class="n">JsonWebKeySignatureAlgorithm</span><span class="p">.</span><span class="n">RS256</span><span class="p">,</span> <span class="n">digest</span><span class="p">,</span> <span class="n">signedResult</span><span class="p">.</span><span class="n">Result</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Verify Offline</h3>

<p>To Verify offline, we need access to the public portion of the key used to sign the data. The client application that needs to verify signatures can connect to the vault and get the key details or use a public key shared out of band. The <a href="http://www.rahulpnath.com/blog/authenticating-a-client-application-with-azure-key-vault/">AD application used to authenticate</a> with the key vault should have Get access for retrieving the public key from the vault. Get access can be set using the PermissionToKeys switch when registering the AD application with the key vault. Assuming we have access to the public key as a JSON string, we can use the <a href="https://msdn.microsoft.com/en-us/library/system.security.cryptography.rsacryptoserviceprovider(v=vs.110).aspx">RSACryptoServiceProvider</a> to verify the signature offline.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="kt">var</span> <span class="n">key</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">JsonWebKey</span><span class="p">&gt;(</span><span class="n">jsonWebKey</span><span class="p">);</span>
</span><span class='line'><span class="kt">var</span> <span class="n">rsa</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RSACryptoServiceProvider</span><span class="p">();</span>
</span><span class='line'><span class="kt">var</span> <span class="n">p</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RSAParameters</span><span class="p">()</span> <span class="p">{</span> <span class="n">Modulus</span> <span class="p">=</span> <span class="n">key</span><span class="p">.</span><span class="n">N</span><span class="p">,</span> <span class="n">Exponent</span> <span class="p">=</span> <span class="n">key</span><span class="p">.</span><span class="n">E</span> <span class="p">};</span>
</span><span class='line'><span class="n">rsa</span><span class="p">.</span><span class="n">ImportParameters</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
</span><span class='line'><span class="n">isVerified</span> <span class="p">=</span> <span class="n">rsa</span><span class="p">.</span><span class="n">VerifyHash</span><span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="s">&quot;Sha256&quot;</span><span class="p">,</span> <span class="n">signedResult</span><span class="p">.</span><span class="n">Result</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>The signature verification succeeds if the message and the signature were not tampered. If either of message or signature were  modified then the signature validation fails.</p>

<p>You can get the sample code <a href="https://github.com/rahulpnath/Blog/tree/master/VerifySignatureOffline">here</a>. Hope this helps you to implement Digital Signatures using Key Vault.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Staying in the Learning Loop]]></title>
    <link href="http://rahulpnath.com/blog/staying-in-the-learning-loop/"/>
    <updated>2016-11-07T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/staying-in-the-learning-loop</id>
    <content type="html"><![CDATA[<p>The current state of the IT industry demands one to be constantly on the go and learning something new. New technologies, frameworks, languages etc. are getting released almost every other day. It is easy to get overwhelmed with all this information. The best way to keep up is to ignore most of it. But every now and then you would want to learn something new either because of project demands or out of personal interests. It is important to have a learning plan for yourself and stick through with it when wanting to learn something. If not it&rsquo;s easy to get distracted. These are some of the ways how I try to structure my learning.</p>

<p><a href="https://www.keele.ac.uk/media/keeleuniversity/lpdc/images/LPDC-Banner-Blue.jpg">
<img  alt="Make writing a habit - write daily" src="http://rahulpnath.com/images/learning_continuosly.png"/>
</a></p>

<h4><strong>Choosing and Sticking to a Topic</strong></h4>

<p>The most important thing in learning something new is to decide on what to learn. This could either be driven by work needs or personal interests. It&rsquo;s easier when driven by work needs as you do not have much to choose on. But still, you need to make sure that you stay within the boundaries of what you are trying to learn. It&rsquo;s easy to get off track as there might be a lot of things that come up which you are not aware of. At times understanding things with a certain level of abstraction is important. Just like social networks distracting you off from real work, different terminologies can get you off on a different path. So make sure you always stick to your end goal.</p>

<h4><strong>Books, Blogs, Videos</strong></h4>

<p>There are different ways that you can learn something new. It could either be books, videos, podcasts, blogs etc. There is no such thing as the best mode to learn. Mode of learning is person specific. So don&rsquo;t try to just imitate what your friend does. Try to find what works for you the best. Whenever I am learning something new, <a href="http://www.rahulpnath.com/blog/language-agnostic-books-for-every-developer-2/">books</a> work the best. Books give a structured approach to a new topic and eases your way through the topic. Though I have a Kindle, for technical books I <a href="http://www.rahulpnath.com/blog/ebook-or-hard-copy/">prefer hard copies</a>. Often I find the need to refer back or forward a few pages and it feels best on a physical book.  I find blogs useful for learning more about a topic that I already have some idea about. For getting an overview of topics and interesting things I find videos and podcasts useful. So depending upon the need I mix and match these different learning modes.</p>

<p><img alt="Current Reading List" src="http://rahulpnath.com/images/learning_books.jpg"/></p>

<h4><strong>Open Source Projects, Forums, Demo application</strong></h4>

<p>It is important that you try out whatever your learn. There are different ways that you can learn by doing and depends on the individual. When learning a new topic I choose to come up with a sample application to be built using the new technology that I am learning. I created <a href="https://www.microsoft.com/en-us/store/p/picfinity/9wzdncrdwxx8">Picfinity</a> when I was learning Window 8 Modern applications. Once comfortable with a topic I choose to either answer <a href="http://www.rahulpnath.com/blog/stars-do-count/">questions on forums</a> (mostly <a href="https://social.msdn.microsoft.com/profile/rahul%20p%20nath?type=forum&amp;referrer=http://social.msdn.microsoft.com/Forums/azure/en-US/home?forum=AzureKeyVault">msdn</a> or <a href="http://stackexchange.com/users/2205373/rahul-p-nath">stack overflow</a>). Contributing to open source projects is also another approach to gets some hands-on experience. Contributing to open source projects also helps the community and improves your self-confidence. <a href="https://github.com/">Github</a> is a good place to start with open source contribution.</p>

<h4><strong>Freelancing</strong></h4>

<p>Not always you get to implement what you learn at your work. Implementing in real world projects is an important aspect of learning. <a href="http://www.rahulpnath.com/blog/getting-started-with-freelancing-jobs-online/">Freelancing</a> is a good way to get work in areas that you want to improve or learn. Bid for projects that uses technologies that you are learning. It might be hard to get offered projects on technologies that you have no prior experience with. Showcasing any sample applications that you have built while learning increases your chances of getting the job. I used Picfinity to show that I can build Windows 8 and phone applications. This landed me opportunities to build different windows phone and windows 8 application.</p>

<h4><strong>Blog</strong></h4>

<p>Sharing your learnings helps improve your own understanding of the topic. It also helps others taking your same path and learning the new topic. Each one of us has a different perspective of understanding and learning things. So don&rsquo;t worry if you are writing about something that is already been written about. Make sure you blog your learnings and if you are new to blogging then there is no better time to <a href="http://www.rahulpnath.com/blog/category/blogging/">get started</a>. Blogs act as a good resume when applying for a job.</p>

<p>With new technologies and frameworks coming up every other day it is hard to keep up with all of them. It is not necessary to understand everything that is out there. What is important is that you should be able to learn quickly when the need arises. Also keep yourself aware of the changes in the industry and technologies you use. It does not matter if you do not know all the latest technologies. What matters is how fast you can learn a new concept. Have a learning plan! What do you find the most effective way to learn? Sound off in the comments</p>

<p><strong>Edit:</strong> Came across this interesting <a href="http://hanselminutes.com/543/becoming-a-more-social-developer-with-daphne-chong">podcast on Hanselminutes</a> where Scott talks to Daphne.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Managing Key Vault Through Azure Portal]]></title>
    <link href="http://rahulpnath.com/blog/managing-key-vault-through-azure-portal/"/>
    <updated>2016-11-01T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/managing-key-vault-through-azure-portal</id>
    <content type="html"><![CDATA[<p>You can now manage Key Vault through the Azure portal. Prior to this the Key Vault&rsquo;s were managed either using <a href="http://www.rahulpnath.com/blog/how-the-deprecation-of-switch-azuremode-affects-azure-key-vault/">Powershell</a>, <a href="http://www.rahulpnath.com/blog/managing-azure-key-vault-using-azure-resource-manager-arm-templates/">ARM Templates</a> or <a href="http://www.rahulpnath.com/blog/managing-azure-key-vault-over-the-rest-api/">REST API</a>. Managing key Vault is now easy and user-friendly for the nontechnical people. In this post, I will walk through the new features in Azure Portal to manage key vault.</p>

<blockquote><p><em>If you find any difference between what you see in the portal versus those in the screenshots below, it&rsquo;s likely that the portal is updated</em></p></blockquote>

<p>In the new Azure portal search for &lsquo;key vault&rsquo; to access this new feature. Or you can go to &lsquo;More Services&rsquo; and scroll down to &lsquo;Security + Identity&rsquo; section in the menu. Selecting Key Vault takes you to all the available Key Vaults under your subscription. You can further filter the Vault&rsquo;s list by the vault name using the filter box or based on your subscriptions.</p>

<p><img  alt="Key Vault in Azure Portal" src="http://rahulpnath.com/images/keyvaultportal_menu_option.png"/></p>

<h4><strong>Creating Key Vault</strong></h4>

<p>To create a new Key Vault select the &lsquo;Create&rsquo; option. By entering the Vault Name, Subscription, Resource Group and Location you can create a new Key Vault.</p>

<p><img  alt="Create Key Vault in Azure Portal" src="http://rahulpnath.com/images/keyvaultportal_create_key_vault.png"/></p>

<p>The pricing tier defaults to Standard and it does not support HSM backed keys. This means you will be only able to create Software keys. You can select the  Premium pricing tier if you need HSM backed keys. By default the login with which you create the subscription with gets granted access to the vault and is added to the access policies. You can grant additional applications or users access and control the permissions. Below I am adding in an AD application.</p>

<p><img  alt="Key Vault Add Access Policy" src="http://rahulpnath.com/images/keyvaultportal_access_policy.png"/></p>

<p>You can specify the Key Permissions and the Secret Permissions that the ServicePrincipal.</p>

<p><img  alt="Access Policy set Secret Permissions" src="http://rahulpnath.com/images/keyvaultportal_secretpermissions.png"/></p>

<h4><strong>Keys and Secrets</strong></h4>

<p>Once the Vault is created you can add in Keys and Secrets into the vault. This can be done by selecting the Vault that was just created from the Vaults list. From here you can manage different aspects of the Vault and also manage Keys and Secrets.</p>

<p><img  alt="Access Policy set Secret Permissions" src="http://rahulpnath.com/images/keyvaultportal_keyvault.png"/></p>

<p>The Azure Portal experience of Key Vault is good. It covers most of the functionalities needed when using a Key Vault. How do you find the new UI experience?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Maintaining a Blogging Schedule]]></title>
    <link href="http://rahulpnath.com/blog/maintaining-a-blogging-schedule/"/>
    <updated>2016-10-24T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/maintaining-a-blogging-schedule</id>
    <content type="html"><![CDATA[<p>Consistency is important in blogging. It does not matter if you are bad at writing, have nothing to write or nobody reads your blog. What matters is whether you write on a predictable schedule - once a month, once a week, once a year, one per day etc. If you do not have a schedule you are more likely to fall off from sticking to blogging. I had <a href="http://www.rahulpnath.com/blog/own-your-urls/">written before</a>, I always struggled to write regularly. But since the start of this year, I have been blogging to a schedule (once a week) and have been successful with that. This post looks into some of the challenges that I faced and things that I have incorporated to stick to a schedule.</p>

<p><a href="https://www.flickr.com/photos/12389767@N04/3097124543/">
<img  alt="Make writing a habit - write daily" src="http://rahulpnath.com/images/bloggingSchedule_writedaily.jpg"/>
</a></p>

<h3>Make Writing a Habit</h3>

<p>Writing posts was hard and I always procrastinated on it. It often took me more than a week to complete a post. There&rsquo;s a saying, <strong><em>If it hurts, do it more often</em></strong> - So to make writing easy I had to write more often.</p>

<blockquote><p><em>I write only when inspiration strikes. Fortunately it strikes every morning at nine o&#8217;clock sharp.</em></p>

<p><em>- <a href="http://www.goodreads.com/quotes/302963-i-write-only-when-inspiration-strikes-fortunately-it-strikes-every">Somerset Maugham</a></em></p></blockquote>

<h4><strong>Generating Topics</strong></h4>

<p>Till a year back I struggled to find topics to blog. I did not find any &lsquo;cool thing&rsquo; that was worth blogging. Not much has changed even now on doing &lsquo;cool things&rsquo;. The only thing that changed was that I decided to write every day - no matter what I do or don&rsquo;t do.</p>

<blockquote><p><em>I have always struggled to find topics to blog, but then I realized all I need is to pay attention to things that I do daily</em></p></blockquote>

<p>A year back I asked <a href="https://simpleprogrammer.com/about-simple-programmer/">John Somnez from SimpleProgrammer</a> the same question.</p>

<p><img  alt="email to John Somnez (SimpleProgrammer) on finding a blogging schedule" src="http://rahulpnath.com/images/bloggingSchedule_john_email.png"/></p>

<p>Though I did not get a reply from John, it kept me thinking. Late last year I started a Daily challenge of &lsquo;<em>Generating at least one blog topic a day</em>&rsquo; for a month. I did not have to write anything, just find a topic to blog and add it to a OneNote list. I did this for a month and found that I had enough topics to write on. Since the challenge did not have anything to do with writing, I did not restrict my thoughts. This is when I realized that it is not the lack of topics that I don&rsquo;t blog, but the fear of writing. That&rsquo;s when I started the &lsquo;Write Everyday&rsquo; daily challenge.</p>

<h4><strong>Write Everyday</strong></h4>

<p>This is one of the most important things that I found to be able to write posts regularly - <strong>Write Everyday</strong>. Yes every day, no matter what happens, I write at least one line towards a post. Since the goal is to <em>Write just one line for a blog post</em>, I hardly miss this goal. <a href="http://www.rahulpnath.com/blog/morning_routine/">Keeping the goal small and simple</a> is a trick that I picked from the book Mini Habits and find it useful. You can follow this for anything that you want to make a habit.</p>

<h4><strong>Make it Visible</strong></h4>

<p>Seeing something progressing to completion helps me to get it done faster. I used to write elsewhere and then copy it to my blog and publish it. This did not give me a sense of progression. I now have a <a href="http://rahulpnath.com/blog/optimizing-octopress-workflow-for-new-posts/">draft post workflow</a>, integrated with my blogging platform. I can preview this blog along with the draft posts on my laptop. This helps give a sense of progression and also makes the end goal visible.</p>

<blockquote><p><em>Making your goal clear and visible helps you achieve it faster</em></p></blockquote>

<p>I also use this to keep track of new post ideas. Whenever I find a topic to blog, I add it as a draft. I add bullet points to the post whenever I get more thoughts on that topic. Once there are enough points to write about, I work on that post.</p>

<h3>Make Blogging All About Writing</h3>

<p>The last thing that I want is to get stuck with mundane repetitive tasks of publishing a post to get in the way of writing. The more regular I became in writing, I started noticing a lot of repetitive tasks in my blogging workflow. When you do any activity repetitively you notice tasks that you do over and over again. I started modifying my blog engine for my needs and to reduce manual effort.</p>

<h4><strong>Write in Advance</strong></h4>

<p>Having posts ready to be published is helpful as it gives the flexibility to slack a bit when in need. It&rsquo;s a great feeling to have blog posts ready to be published (right now I have posts ready for a month). I modified my blogging engine to support <a href="http://rahulpnath.com/blog/automatic_deployment_of_future_posts_with_octopress">publishing posts on future dates</a>. This helps me set publishing dates in the future for posts and it gets automatically deployed on the day. Automating the publishing helped make blogging more about writing. I can forget about it as soon as I complete a post by specifying the date I want it to be published and be rest assured that it will get published.</p>

<h4><strong>Make Writing Accessible</strong></h4>

<p>You never know when you have that free time and want to blog. Maybe it&rsquo;s while traveling, or waiting in a queue or at your work desk. You might be <a href="http://rahulpnath.com/blog/staying-productive-offline">offline or connected</a> Making it possible to write from irrespective of the kind of device (laptop, mobile, tablet) and connectivity was key for me. I have my draft posts synchronized through Dropbox and available on all my devices. This helps use all the pockets of time that I get for myself.</p>

<p>These are the things that have helped me pick a schedule and follow it. I have been successful in publishing one post per week for the past 10 months and want to keep at it going forward. Now that I am able to publish regularly, I want to improve the speed at which I write posts. Though I reduced the time from over a week to days, I still find this too long and want to reduce it to a day. Modifying the way images are added, optimized and served is also something that I am trying to optimize currently. Do you <a href="http://www.rahulpnath.com/blog/own-your-urls/">have a blog</a>? If not start one and stick to a schedule that works for you!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Review: Six Months and Counting - Logitech MX Master]]></title>
    <link href="http://rahulpnath.com/blog/review-six-months-and-counting-logitech-mx-master/"/>
    <updated>2016-10-18T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/review-six-months-and-counting-logitech-mx-master</id>
    <content type="html"><![CDATA[<p>It&rsquo;s been six months with the <a href="http://amzn.to/2ddLmUf">Logitech MX Master</a> mouse and I absolutely love it for daily use. I picked this mouse a week after reading <a href="http://www.hanselman.com/blog/FindingThePerfectMouse.aspx">Hanselman&rsquo;s review</a>. It feels just as it sounded in his review - Perfect!.</p>

<p><a href="http://www.logitech.com/en-us/product/mx-master">
    <img  alt="Logitech MX Master" src="http://rahulpnath.com/images/logitech_mxmaster.jpg"/>
</a></p>

<h4><strong>Key Features</strong></h4>

<ul>
<li><p>The mouse fits perfectly into the hand and supports the wrist in a native position. It is suitable for long duration use.</p></li>
<li><p>The battery is rechargeable and the mouse comes with a micro-USB charging cable. After a full charge, the mouse lasts me for 2-3 weeks.   The mouse can be used while charging, so there is no downtime. The LED lights indicate the charge status. If not the software also warns when the battery is low.</p></li>
<li><p>I connect the mouse using the Logitech Unifying Receiver. But the mouse also supports connecting over Bluetooth. This is useful in cases when you want to connect with multiple computers.</p></li>
<li><p>The mouse supports Easy Switch technology.  You can pair up to 3 devices and switch between them using buttons on the bottom side of the mouse. I have not used this feature as I mostly work on just one laptop.</p></li>
<li><p>Darkfield Laser Sensor tracks flawlessly over all surfaces. I use the MX Master across wooden and glass surfaces and find it smooth over both.</p></li>
<li><p>The mouse scroll supports smooth scrolling and &lsquo;Ratchet&rsquo; mode (click, click, click) scroll. It supports automatic and manual mode shifting. So when reading long documents you can be on smooth scrolling and when navigating code or shorter texts you can use Ratchet mode to feel greater control. It also has buttons to</p></li>
</ul>


<p>The mouse has an accompanying software that allows customizations of mouse buttons.</p>

<p><img  alt="Logitech MX Master Software" src="http://rahulpnath.com/images/logitech_mxmaster_software.png"/></p>

<p>The software allows setting application specific actions for buttons. For e.g. I have the Gesture button to archive emails in Outlook, &lsquo;Navigate to Definition&rsquo; in Visual Studio, close tab in Chrome etc. You can configure this to any action on applications of your choice (provided it supports keyboard shortcuts that can be linked to).</p>

<p><img  alt="Logitech MX Master Software customizations" src="http://rahulpnath.com/images/logitech_mxmaster_customize.png"/></p>

<h4><strong>Issue</strong></h4>

<p>The only issue that I faced so long is with the Mouse scroll mode. The &lsquo;Ratchet&rsquo; mode no longer works for me. It is always in smooth scrolling mode and the mechanical key to shift modes does not work anymore. Google tells me that this is a <a href="https://community.logitech.com/s/question/0D531000051026rCAA">common issue</a> with the mouse .
<a href="https://www.youtube.com/watch?v=KR9fLd_ViYw">This video</a> walks through on how to open up the mouse and fix the mechanical part that clicks in to switch the scroll modes. I have not tried this myself as I don&rsquo;t feel much a problem without the Ratchet mode.</p>

<p>Other than the Ratchet mode issue, I have not found any other issues with the mouse.</p>

<div align="center">
<blockquote class="instagram-media" data-instgrm-captioned data-instgrm-version="7" style=" background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:658px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);"><div style="padding:8px;"> <div style=" background:#F8F8F8; line-height:0; margin-top:40px; padding:41.712962963% 0; text-align:center; width:100%;"> <div style=" background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAMUExURczMzPf399fX1+bm5mzY9AMAAADiSURBVDjLvZXbEsMgCES5/P8/t9FuRVCRmU73JWlzosgSIIZURCjo/ad+EQJJB4Hv8BFt+IDpQoCx1wjOSBFhh2XssxEIYn3ulI/6MNReE07UIWJEv8UEOWDS88LY97kqyTliJKKtuYBbruAyVh5wOHiXmpi5we58Ek028czwyuQdLKPG1Bkb4NnM+VeAnfHqn1k4+GPT6uGQcvu2h2OVuIf/gWUFyy8OWEpdyZSa3aVCqpVoVvzZZ2VTnn2wU8qzVjDDetO90GSy9mVLqtgYSy231MxrY6I2gGqjrTY0L8fxCxfCBbhWrsYYAAAAAElFTkSuQmCC); display:block; height:44px; margin:0 auto -44px; position:relative; top:-22px; width:44px;"></div></div> <p style=" margin:8px 0 0 0; padding:0 4px;"> <a href="https://www.instagram.com/p/BC11BabgPpV/" style=" color:#000; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none; word-wrap:break-word;" target="_blank">Trying out the logitech mx master mouse. Liking it!</a></p> <p style=" color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;">A photo posted by Rahul P Nath (@rahulpnath) on <time style=" font-family:Arial,sans-serif; font-size:14px; line-height:17px;" datetime="2016-03-12T05:22:06+00:00">Mar 11, 2016 at 9:22pm PST</time></p></div></blockquote>
<script async defer src="//platform.instagram.com/en_US/embeds.js"></script>
</div>


<p><br />
If you are looking for a new mouse and willing to spend a little more than usual, I recommend the <a href="http://amzn.to/2ddLmUf">Logitech MX Master</a>. What mouse do you use?</p>

<p>* <em>Amazon links are affiliated.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Staying Productive Offline]]></title>
    <link href="http://rahulpnath.com/blog/staying-productive-offline/"/>
    <updated>2016-10-10T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/staying-productive-offline</id>
    <content type="html"><![CDATA[<p>Last month I was in Trivandrum (Kerala, India) for a month&rsquo;s vacation. This was also my first trip back to India after <a href="http://www.rahulpnath.com/blog/finding-a-job-abroad/">moving to Sydney</a>. While in India I chose not to have a mobile connection and be offline on the go (at home I had a broadband connection). So while traveling places or moving around I had <a href="http://www.rahulpnath.com/blog/review-two-months-and-counting-android-and-nexus-5/">my mobile</a> in <a href="https://en.wikipedia.org/wiki/Airplane_mode">airplane mode</a>. But even then there was time that I resorted to my mobile to spend time. When traveling by bus/train, afternoons in hotels (when everyone rests) etc, I had a lot of &lsquo;me time&rsquo;.</p>

<p><img  alt="Living an offline Life" src="http://rahulpnath.com/images/offlinelife.png"/></p>

<p>Below are some of the things that I have my phone geared up for offline mode.</p>

<h4><strong>Blogging</strong></h4>

<p>Blogging is one of the things that I enjoy doing most these days. To keep up with <a href="http://www.rahulpnath.com/blog/morning_routine/">my routine</a>, I try to blog every day to keep up with <a href="http://rahulpnath.com/blog/blogging-schedule/">my schedule</a>. I have modified <a href="http://rahulpnath.com/blog/optimizing-octopress-workflow-for-new-posts/">my blogging workflow</a> to give the flexibility to blog from any of my devices. Currently, I am writing this blog while on a train and &lsquo;<a href="https://en.wikipedia.org/wiki/Online_and_offline">disconnected</a>&rsquo;. When back home and connected, all the offline content synchronizes through Dropbox. The content written while offline is now available for <a href="http://rahulpnath.com/blog/continuos-delivery-of-octopress-blog-using-travisci-and-docker/">publishing from my laptop</a>. Making writing accessible from everywhere helps me to stick with my <a href="http://www.rahulpnath.com/blog/morning_routine/">mini habits</a>.</p>

<h4><strong>Reading</strong></h4>

<p>I always have books, articles downloaded and available for offline reading. For books, I use the Kindle application. Most of the time I have my Kindle for reading, if not I use the mobile application. For blog posts and articles I use Pocket. Whenever I am connected and find interesting posts to read later, I <a href="https://getpocket.com/add/?ep=1">Add to Pocket</a>. Pocket&rsquo;s mobile application <a href="https://help.getpocket.com/article/960-using-pocket-offline-on-android">downloads articles</a> and makes them available for offline reading.</p>

<p><img alt="Amazon Kindle and Pocket for offline reading" src="http://rahulpnath.com/images/offlinelife_reading.png"/></p>

<h4><strong>Game</strong></h4>

<p>I usually do not have many games on my mobile. But in case I feel bored I play the <a href="http://mashable.com/2014/09/25/chrome-t-rex-game/">game available on Chrome browser</a> (only in offline mode). When offline a T. Rex dinosaur comes up in the browser with the message &lsquo;Unable to connect to the Internet&rsquo;. Tapping on the dinosaur starts the game.</p>

<p><img  alt="Google Chrome offline T Rex game" src="http://rahulpnath.com/images/offlinelife_chrome_game.gif"/></p>

<h4><strong>To-Do List</strong></h4>

<p>Offline time is good to manage your To-Do lists and <a href="http://www.rahulpnath.com/blog/morning_routine/">do a brain dump</a>. I use Todoist to manage my tasks and activities. The <a href="https://support.todoist.com/hc/en-us/articles/205383721-Apps">Todoist mobile application</a> stores all tasks offline. It allows adding tasks when disconnected and synchronizes it to the server when connected. I also use OneNote for capturing notes which also has an offline mode.</p>

<h4><strong>Trip Planner</strong></h4>

<p>For short local trips, the recently launched <a href="https://get.google.com/trips/">Google Trips</a> is useful. Google Now already shows trip summaries and alerts on the home page. Google Trips takes this to the next level and allows to manage all trip data at one place. It helps collate all the travel booking in one place and makes it available in offline mode.</p>

<p><img  alt="Google Trips for managing trip data offline" src="http://rahulpnath.com/images/offlinelife_trips.png"/></p>

<p>These are the common things that I have my mobile setup for offline mode. I have had this setup while I was in Sydney, as I try to stay disconnected when commuting to work. Staying off the internet helps me get more things done!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Introducing Code Formatting into a Large Code Base]]></title>
    <link href="http://rahulpnath.com/blog/introducing-code-formatting-into-a-large-codebase/"/>
    <updated>2016-10-03T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/introducing-code-formatting-into-a-large-codebase</id>
    <content type="html"><![CDATA[<p>Code Formatting is an important aspect of writing code. If followed well it helps keep the code more readable and easy to work with. Here are some of the different aspects of formatting code and my personal preferences. I then explore options to enforce code formatting and ways to introduce it into an existing code base.</p>

<p>Below are some of the popular formatting rules and those that have a high value when enforced in a project.</p>

<h4><strong>Tabs vs Spaces</strong></h4>

<p>One of the most debated topic in code formatting is whether to use tabs or spaces to intend code. I never knew such a debate existed until my most recent project. It had developers from different parts of the world and with different preferences. I came across the below excerpt from Jeff Atwood, to which I completely agree.</p>

<blockquote><p><em>Choose tabs, choose spaces, choose whatever layout conventions make sense to you and your team. It doesn&rsquo;t actually matter which coding styles you pick. What does matter is that you, and everyone else on your team, <strong>sticks with those conventions and uses them consistently.</strong></em></p>

<p><em>That said, only a moron would use tabs to format their code.</em></p>

<p><em>- <a href="https://blog.codinghorror.com/death-to-the-space-infidels/">Jeff Atwood</a></em></p></blockquote>

<p>Settings for these are often available at the IDE level. In Visual Studio this is available under <a href="https://msdn.microsoft.com/en-us/library/7sffa753.aspx">Options, Text Editor, All Languages, Tabs</a>. Be aware of what you choose and make sure you have the same settings across your team members.</p>

<h4><strong>Horizontal Alignment</strong></h4>

<p>Avoid aligning by common separators (=;,) when they occur in adjacent lines. This kind of alignment falls out of order when we rename variables or properties. It happens when you chaange property names.</p>

<figure class='code'><figcaption><span>Not Refactoring friendly and needs extra effort to keep it formatted</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="kt">var</span> <span class="n">person</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">FirstName</span> <span class="p">=</span> <span class="s">&quot;Rahul&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="n">LastName</span>  <span class="p">=</span> <span class="s">&quot;Nath&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="n">Site</span>      <span class="p">=</span> <span class="s">&quot;www.rahulpnath.com&quot;</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Refactoring friendly</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="kt">var</span> <span class="n">person</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">FirstName</span> <span class="p">=</span> <span class="s">&quot;Rahul&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="n">LastName</span> <span class="p">=</span> <span class="s">&quot;Nath&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="n">Site</span> <span class="p">=</span> <span class="s">&quot;www.rahulpnath.com&quot;</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<h4><strong>Horizontal Formatting</strong></h4>

<p><em>You should never have to scroll to the right</em> - I caught on with this recommendation from the book Clean Code (<a href="http://www.rahulpnath.com/blog/language-agnostic-books-for-every-developer-2/">a recommended read</a>). It is also recommended that a function should fit on the screen, without needing to scroll up or down. This encourages to keep functions short and specific.</p>

<blockquote><p><em>We should strive to keep our lines short. The old Hollerith limit of 80 is a bit arbitrary, and I’m not opposed to lines edging out to 100 or even 120. But beyond that is probably just careless</em></p>

<p><em>- Uncle Bob</em></p></blockquote>

<p>The <a href="https://visualstudiogallery.msdn.microsoft.com/d0d33361-18e2-46c0-8ff2-4adea1e34fef">Productivity Power Tools</a> extension for Visual Studio allows adding a Column Guide. A Column Guide reminds developers their full line of code or comments may not fit on a single screen.</p>

<p><img class="center" alt="Code Formatting Maximum Width Column Guide in Visual Studio using Power Tools"
src="http://rahulpnath.com/images/codeformatting_column_guide.png" /></p>

<h4><strong>Aligning Function Parameters</strong></h4>

<p>Always try to keep the number of parameters as less as possible. In cases where there are more parameters or longer function names, the team must choose a style. There are different styling formats followed when splitting parameters to a new line.</p>

<p>Allowing parameters to take the <strong><em>natural flow of IDE</em></strong> (Visual Studio) is the simplest approach. This often leads to poor readability and code cluttering.</p>

<p><img class="center" alt="Function Parameters taking natural flow of IDE"
src="http://rahulpnath.com/images/codeformatting_functionparameters_naturalflowide.png" /></p>

<p>Breaking parameters into separate lines is important for readability. Use the Column guide to decide when to break function parameters into different lines. There are different approaches followed when splitting parameters into new lines. Keeping the first parameter on the same line as the function and then having all other <strong><em>parameters on new line aligned with the first parameter</em></strong> is another approach. This works well when viewed in the same font and resolution used when writing. When you change font or resolution this kind of formatting falls out of place.</p>

<p><img class="center" alt="Function Parameters on new line aligned with first parameter"
src="http://rahulpnath.com/images/codeformatting_functionparameters_alignzoom.png" /></p>

<p>A better variant of the above style is to have the parameters in the new line aligned to the left. This ensures parameters stay in the same place when changing font or resolutions. The one that I prefer is to have all parameters in a new line. This formatting works well with different font sizes and resolutions.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="kt">int</span> <span class="nf">ThisIsALongFunctionNameWithLotsOfParameters</span><span class="p">(</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">parameter1</span><span class="p">,</span>
</span><span class='line'>    <span class="kt">string</span> <span class="n">parameter2</span><span class="p">,</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">parameter3</span><span class="p">,</span>
</span><span class='line'>    <span class="kt">string</span> <span class="n">optionalParameter</span> <span class="p">=</span> <span class="s">&quot;Test&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h4><strong>Visibility Based Ordering</strong></h4>

<p>It is a good practice to maintain a specific order of items within a class. Have all properties declared first, then constructors, public methods, protected methods, private methods etc. This is up to the team to  determine the order, but sticking on to it makes the code more readable.</p>

<h3>Code Analysis Tools</h3>

<p>Checking for styling and formatting issues in a code review requests is a boring task. It’s best to automate style checks at build time (local and server builds). Making build throw errors for styling issues forces developers to fix them. Once developers get used to the rules, writing code without any formatting issues becomes second nature.  <a href="https://stylecop.codeplex.com">StyleCop</a> is an open source static code analysis tool from Microsoft that checks C# code for conformance to StyleCop&rsquo;s recommended coding styles and a subset of Microsoft&rsquo;s .NET Framework Design Guidelines. It has a Visual Studio plugin and also integrates well with <a href="https://stylecop.codeplex.com/wikipage?title=Setting%20Up%20StyleCop%20MSBuild%20Integration">MsBuild</a>.</p>

<h4><strong>Cleaning up a Large Code Base</strong></h4>

<p>Introducing StyleCop (or any code format enforcement) into a large pre-existing code base is challenging. Turning the tool on would immediately throw hundreds and thousands of errors. Trying to fix them in a stretch might impact the ongoing development process. This often causes us to delay the introduction of such enforcement&rsquo;s into the project and it continues to be a technical debt.</p>

<p>Taking an incremental approach, fixing one by one as and when a file is changed seems a good idea. Teams can come with the <a href="http://programmer.97things.oreilly.com/wiki/index.php/The_Boy_Scout_Rule">Boy Scout Rule</a> - &lsquo;<em>Leave the file cleaner than you find</em>&rsquo;. Every time a file is touched for a fix, run StyleCop analysis and fix the errors. Over a period of time, this will make the project clean. The only problem with this approach is developers often tend to ignore/forget running the analysis and fix them.</p>

<blockquote><p><em>Trivial things like code formatting is hard to mandate within a team unless it is enforced through tooling</em></p></blockquote>

<h3>Source Control Hooks</h3>

<p>We can plug into various hooks that source controls give to enforce code formatting on developer machines. In git, you can add a <a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks">custom pre-commit hook</a> to run the StyleCop analysis on all the staged files. <a href="https://github.com/bbadjari/stylecopcli">StyleCopcli</a> is an open source application that wraps over the StyleCop DLLs and allows running the analysis from the command line. So in the hook, I use this CLI to run StyleCop analysis on all the staged files.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bat'><span class='line'>#!<span class="n">/bin/sh</span>
</span><span class='line'><span class="k">echo</span> <span class="s2">&quot;Running Code Analysis&quot;</span>
</span><span class='line'>.<span class="n">/stylecopcli/StyleCopCLI.exe</span> -cs $(git diff --cached --name-only)
</span><span class='line'><span class="k">if</span> [ $? <span class="o">=</span> <span class="m">2</span> ]
</span><span class='line'>    then
</span><span class='line'>        <span class="k">echo</span> Commit Failed! Fix StyleCop Errors
</span><span class='line'>        exit <span class="m">1</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>        <span class="k">echo</span> No SyleCop Errors!
</span><span class='line'>        exit <span class="m">0</span>
</span><span class='line'>fi
</span></code></pre></td></tr></table></div></figure>


<p>If there are any StyleCop validation errors the commit is aborted, forcing the developer to fix it. The git hooks work fine when committing from a command line or UI tools like Source Tree. However, Visual Studio git plugin does not run the git hooks and fails to do the check.</p>

<p><img class="center" alt="StyleCop git hook failing commit in console" src="http://rahulpnath.com/images/code_formatting_git_hook_console.png" /></p>

<p><img class="center" alt="StyleCop git hook failing commit in Source Tree" src="http://rahulpnath.com/images/code_formatting_git_hook_sourcetree.png" /></p>

<p>Over a period of time, most of the files will get cleaned and remaining can be done all at once with less effort. Once the entire code base passes all StyleCop rules, this can be enforced in the build server. This ensures that no more bad formatted code gets checked into the source control.</p>

<p>Code is read more than written. So it is important to keep it readable and well-formatted. It also makes navigating code bases easier and faster. These are minor things that are often <a href="https://vimeo.com/97329157">overlooked by developers</a>, but have a high impact on productivity when followed. Do you enforce code formatting rules in your current project? What are the rules that you find important. Sound off in the comments below!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Introduce Tests when Fixing Bugs]]></title>
    <link href="http://rahulpnath.com/blog/introduce-tests-when-fixing-bugs/"/>
    <updated>2016-09-26T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/introduce-tests-when-fixing-bugs</id>
    <content type="html"><![CDATA[<p><em>When creating a subscription for a client, the calculated number of months was off by one at times</em> - This was a bug reported from production application that I was currently working on. Though, not a blocker, it was creating enough issues for the end users that it required a hotfix. One of my friends picked this issue up and started working on it. A while later, while I was checking the status of that bug I noticed him playing around with  <a href="https://www.linqpad.net/">Linqpad</a>. He was testing a method to calculate the number of months between two dates with different values.</p>

<p><a href="https://www.flickr.com/photos/toomore/23066277453" class="center" title="Image By Toomore Chiang, from https://www.flickr.com/photos/toomore/23066277453"><img src="http://rahulpnath.com/images\testing.jpg" class="center" alt="Testing"></a></p>

<p>We often test our code elsewhere because it&rsquo;s coupled with other code making it difficult to test at the source itself. The fact that we need to test an isolated part of a larger piece of code is a &lsquo;<a href="https://en.wikipedia.org/wiki/Code_smell">Code smell</a>&rsquo;. There possibly is a class or method that can be extracted and unit tested separately.</p>

<blockquote><p><em>Having to test code elsewhere other than the source is a Smell. Look for a method or class waiting to be extracted</em></p></blockquote>

<p>In this specific case, below is how the code that calculates month difference between two dates looked like. As you can see below, the code is coupled with the newAccount, which in turn is coupled with a few other entities that I have omitted. Added to this, this method existed in an MVC controller, which had other dependencies.</p>

<figure class='code'><figcaption><span>Existing Code</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="p">...</span>
</span><span class='line'><span class="kt">var</span> <span class="n">date1</span> <span class="p">=</span> <span class="n">newAccount</span><span class="p">.</span><span class="n">StartDate</span><span class="p">;</span>
</span><span class='line'><span class="kt">var</span> <span class="n">date2</span> <span class="p">=</span> <span class="n">newAccount</span><span class="p">.</span><span class="n">EndDate</span><span class="p">;</span>
</span><span class='line'><span class="kt">int</span> <span class="n">monthsApart</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="n">Abs</span><span class="p">(</span><span class="m">12</span> <span class="p">*</span> <span class="p">(</span><span class="n">date1</span><span class="p">.</span><span class="n">Year</span> <span class="p">-</span> <span class="n">date2</span><span class="p">.</span><span class="n">Year</span><span class="p">)</span> <span class="p">+</span> <span class="n">date1</span><span class="p">.</span><span class="n">Month</span> <span class="p">-</span> <span class="n">date2</span><span class="p">.</span><span class="n">Month</span><span class="p">)</span> <span class="p">-</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'><span class="kt">decimal</span> <span class="n">daysInMonth1</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">DaysInMonth</span><span class="p">(</span><span class="n">date1</span><span class="p">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">date1</span><span class="p">.</span><span class="n">Month</span><span class="p">);</span>
</span><span class='line'><span class="kt">decimal</span> <span class="n">daysInMonth2</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">DaysInMonth</span><span class="p">(</span><span class="n">date2</span><span class="p">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">date2</span><span class="p">.</span><span class="n">Month</span><span class="p">);</span>
</span><span class='line'><span class="kt">decimal</span> <span class="n">dayPercentage</span> <span class="p">=</span> <span class="p">((</span><span class="n">daysInMonth1</span> <span class="p">-</span> <span class="n">date1</span><span class="p">.</span><span class="n">Day</span><span class="p">)</span> <span class="p">/</span> <span class="n">daysInMonth1</span><span class="p">)</span>
</span><span class='line'>                      <span class="p">+</span> <span class="p">(</span><span class="n">date2</span><span class="p">.</span><span class="n">Day</span> <span class="p">/</span> <span class="n">daysInMonth2</span><span class="p">);</span>
</span><span class='line'><span class="kt">var</span> <span class="n">months</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Math</span><span class="p">.</span><span class="n">Ceiling</span><span class="p">(</span><span class="n">monthsApart</span> <span class="p">+</span> <span class="n">dayPercentage</span><span class="p">);</span>
</span><span class='line'><span class="p">...</span>
</span></code></pre></td></tr></table></div></figure>


<p>This explains why it was easier to copy this code across and test it in Linqpad. It was difficult to construct the whole hierarchy of objects and to test this. So the easiest thing to fix the bug in is to test elsewhere and fit back in its original place.</p>

<h3>Extract Method Refactoring</h3>

<p>This is one of the scenario where <a href="http://refactoring.com/catalog/extractMethod.html">Extract Method</a> Refactoring fits in best. According to the definition</p>

<blockquote><p><em>You have a code fragment that can be grouped together. <strong>Turn the fragment into a method whose name explains the purpose of the method.</strong></em></p></blockquote>

<p>Extract Method Refactoring is also referred in <a href="http://www.amazon.com/gp/product/0131177052/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0131177052&amp;linkCode=as2&amp;tag=rahulpnath-20&amp;linkId=TTKEEYQLEMTOXPPQ">Working Effectively With Legacy Code</a> and <a href="http://www.amazon.com/gp/product/0131495054/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0131495054&amp;linkCode=as2&amp;tag=rahulpnath-20&amp;linkId=XR55UAOEPPMVMFK3">xUnit Test Patterns</a> (to refactor test code).  It helps separate logic from rest of the object hierarchy and test individually. In this scenario, we can extract the logic to calculate the number of months between two dates into a separate method.</p>

<p>For <a href="http://butunclebob.com/ArticleS.UncleBob.TheThreeRulesOfTdd">Test driving</a> the extracted method, all I do initially is to extract the method. As the method purely depends on its passed in parameters and not on any instance variables, I mark it as a static method. This removes the dependency from the MVC controller class parameters and the need to construct them in the tests . The test cases includes the failed &lsquo;off by one&rsquo; case (<em>(&ldquo;25-Aug-2017&rdquo;, &ldquo;25-Feb-2018&rdquo;, 6)</em>). With tests that pass and fail it&rsquo;s now safe to make changes to the extracted method to fix the failing cases.</p>

<figure class='code'><figcaption><span>Tests</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="na">[Theory]</span>
</span><span class='line'><span class="na">[InlineData(&quot;10-Feb-2016&quot;, &quot;10-Mar-2016&quot;, 1)]</span>
</span><span class='line'><span class="na">[InlineData(&quot;10-Feb-2016&quot;, &quot;11-Mar-2016&quot;, 2)]</span>
</span><span class='line'><span class="na">[InlineData(&quot;10-Feb-2015&quot;, &quot;11-Mar-2016&quot;, 14)]</span>
</span><span class='line'><span class="na">[InlineData(&quot;01-Feb-2015&quot;, &quot;01-Mar-2015&quot;, 1)]</span>
</span><span class='line'><span class="na">[InlineData(&quot;21-Sep-2016&quot;, &quot;22-Sep-2016&quot;, 1)]</span>
</span><span class='line'><span class="na">[InlineData(&quot;25-Aug-2017&quot;, &quot;25-Feb-2018&quot;, 6)]</span>
</span><span class='line'><span class="na">[InlineData(&quot;12-Aug-2016&quot;, &quot;15-Mar-2019&quot;, 32)]</span>
</span><span class='line'><span class="k">public</span> <span class="k">void</span> <span class="nf">MonthsToReturnsExpectedMonths</span><span class="p">(</span>
</span><span class='line'>    <span class="kt">string</span> <span class="n">date1</span><span class="p">,</span>
</span><span class='line'>    <span class="kt">string</span> <span class="n">date2</span><span class="p">,</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">expected</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="kt">var</span> <span class="n">actual</span> <span class="p">=</span> <span class="n">SubscriptionController</span><span class="p">.</span><span class="n">MonthsTo</span><span class="p">(</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">date1</span><span class="p">),</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">date2</span><span class="p">));</span>
</span><span class='line'>    <span class="n">Assert</span><span class="p">.</span><span class="n">Equal</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">actual</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>More than the algorithm used to solve the original issue what is more important is in identifying such scenarios and extracting them as a method. Make the least possible change to make it testable and fix step by step.</p>

<blockquote><p><em>Whenever there are code fragments that depend only on a subset of properties of your class or function inputs, it could be extracted into a separate method.</em></p></blockquote>

<figure class='code'><figcaption><span>Extracted method after Refactoring.</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="kt">int</span> <span class="nf">MonthsTo</span><span class="p">(</span><span class="n">DateTime</span> <span class="n">date1</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">date2</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">months</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="n">Abs</span><span class="p">(</span><span class="m">12</span><span class="p">*(</span><span class="n">date1</span><span class="p">.</span><span class="n">Year</span> <span class="p">-</span> <span class="n">date2</span><span class="p">.</span><span class="n">Year</span><span class="p">)</span> <span class="p">+</span> <span class="n">date1</span><span class="p">.</span><span class="n">Month</span> <span class="p">-</span> <span class="n">date2</span><span class="p">.</span><span class="n">Month</span><span class="p">);</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">date2</span><span class="p">.</span><span class="n">Date</span><span class="p">.</span><span class="n">Day</span> <span class="p">&gt;</span> <span class="n">date1</span><span class="p">.</span><span class="n">Date</span><span class="p">.</span><span class="n">Day</span><span class="p">)</span>
</span><span class='line'>        <span class="n">months</span> <span class="p">=</span> <span class="n">months</span> <span class="p">+</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">months</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Introduce Value Object</h3>

<p>Now that we have fixed the bug and have tests covering the different combinations, let&rsquo;s see if this method can live elsewhere and make it reusable. The start date and end date on account always go together and is a domain concept that can be extracted out as an &lsquo;Account Term Range&rsquo;. It can be represented as a DateRange <a href="http://www.rahulpnath.com/blog/thinking-beyond-primitive-values-value-objects/">Value Object</a>. We can then introduce a method in the DateRange Value Object to return the number of months in the range. This makes the function reusable and also <a href="http://www.rahulpnath.com/blog/refactoring-to-improve-readability-separating-business-language-and-programming-language-semantics/">code more readable</a>. I made the original refactored method as an extension method on DateTime and used it from DateRange Value Object.</p>

<figure class='code'><figcaption><span>Encapsulate into Value Object</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">DateTimeExtensions</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">static</span> <span class="kt">int</span> <span class="nf">MonthsTo</span><span class="p">(</span><span class="k">this</span> <span class="n">DateTime</span> <span class="n">date1</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">date2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="kt">int</span> <span class="n">months</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="n">Abs</span><span class="p">(</span><span class="m">12</span><span class="p">*(</span><span class="n">date1</span><span class="p">.</span><span class="n">Year</span> <span class="p">-</span> <span class="n">date2</span><span class="p">.</span><span class="n">Year</span><span class="p">)</span> <span class="p">+</span> <span class="n">date1</span><span class="p">.</span><span class="n">Month</span> <span class="p">-</span> <span class="n">date2</span><span class="p">.</span><span class="n">Month</span><span class="p">);</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">date2</span><span class="p">.</span><span class="n">Date</span><span class="p">.</span><span class="n">Day</span> <span class="p">&gt;</span> <span class="n">date1</span><span class="p">.</span><span class="n">Date</span><span class="p">.</span><span class="n">Day</span><span class="p">)</span>
</span><span class='line'>            <span class="n">months</span> <span class="p">=</span> <span class="n">months</span> <span class="p">+</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">months</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">DateRange</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="n">DateTime</span> <span class="n">StartDate</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="n">DateTime</span> <span class="n">EndDate</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="nf">DateRange</span><span class="p">(</span><span class="n">DateTime</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">endDate</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="c1">// Ignoring null checks</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">endDate</span> <span class="p">&lt;</span> <span class="n">startDate</span><span class="p">)</span>
</span><span class='line'>            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentException</span><span class="p">(</span><span class="s">&quot;End Date cannot be less than Start Date&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="n">StartDate</span> <span class="p">=</span> <span class="n">startDate</span><span class="p">;</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="n">EndDate</span> <span class="p">=</span> <span class="n">endDate</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="nf">GetMonths</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">StartDate</span><span class="p">.</span><span class="n">MonthsTo</span><span class="p">(</span><span class="n">EndDate</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">...</span> <span class="c1">// Rest of Value Object Code to override Equals and GetHashCode</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you are new to TDD or just getting started with tests, introducing tests while fixing bugs is a good place to start. This might also help make code decoupled and readable. Try <a href="http://www.rahulpnath.com/blog/is-code-coverage-a-lie/">covering a fix with tests</a> the next time you fix a bug!</p>

<h4><strong>References</strong></h4>

<div>
    <div class="row">
        <div class="col-sm-6 col-md-3">
            <div class="thumbnail">
                <a href="http://www.amazon.com/gp/product/0131495054/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0131495054&linkCode=as2&tag=rahulpnath-20&linkId=XR55UAOEPPMVMFK3">
                    <img src="http://rahulpnath.com/images/books_xunit.jpg" data-holder-rendered="true" style="display: block;">
                </a>
            </div>
        </div>
        <div class="col-sm-6 col-md-3">
            <div class="thumbnail">
                <a href="http://www.amazon.com/gp/product/0321503627/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0321503627&linkCode=as2&tag=rahulpnath-20&linkId=TR6UCCVP6CMGBBZQ">
                    <img src="http://rahulpnath.com/images/books_goos.jpeg" data-holder-rendered="true" style="display: block;">
                </a>
            </div>
        </div>
        <div class="col-sm-6 col-md-3">
            <div class="thumbnail">
                <a href="http://www.amazon.com/gp/product/0131177052/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0131177052&linkCode=as2&tag=rahulpnath-20&linkId=TTKEEYQLEMTOXPPQ">
                    <img src="http://rahulpnath.com/images/books_welc.jpg" data-holder-rendered="true" style="display: block;">
                </a>
            </div>
        </div>
    </div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Keeping Sensitive Configuration Data Out of Source Control]]></title>
    <link href="http://rahulpnath.com/blog/keeping-sensitive-configuration-data-out-of-source-control/"/>
    <updated>2016-09-19T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/keeping-sensitive-configuration-data-out-of-source-control</id>
    <content type="html"><![CDATA[<p>Most applications today deals with some form of sensitive information. The most commonly seen are database connection strings, API keys, token etc. The web.config seems the best place to have these values, but it definitely is not. In most cases it gets pushed into the source control systems as well. If it is a private repository then you at least have one level of security on top of it. It still exposes sensitive information to anyone who has access to the repository. It’s worse when the <a href="http://www.internetnews.com/blog/skerner/github-search-exposes-passwords.html">repository is public</a>.</p>

<p><img alt="Keep sensitive data out of source control" src="http://rahulpnath.com/images/sensitivedata_source_control.png" /></p>

<p>There are different ways you can  avoid pushing sensitive data into source control. In this post, I will explore options that I am familiar with.</p>

<blockquote><p><em>Use configuration files as template definitions for the configuration data your application requires. Have the actual values stored elsewhere</em></p></blockquote>

<h3>Azure App Settings</h3>

<p>If you are deploying your application as a Web App on Azure, you can store <a href="https://azure.microsoft.com/en-us/blog/windows-azure-web-sites-how-application-strings-and-connection-strings-work/">application settings and connection strings in Azure</a>. At runtime, Windows Azure Web Sites automatically retrieves these values for you and makes them available to code running in your website. This removes the need for having sensitive data in the configuration file.</p>

<p><img alt="Azure App Settings and Connection Strings" src="http://rahulpnath.com/images/sensitiveData_azure_app_settings.png" /></p>

<h3>Release Management Tools</h3>

<p>Release management tools like Octopus Deploy, Microsoft Release Management, that performs configuration transformation. It supports creating different environments (development, production) and corresponding configurations. On creating a package for an environment, it applies the corresponding environment configurations</p>

<p><img alt="Release Management Tools - Octopus Deploy" src="http://rahulpnath.com/images/sensitiveData_releaseManagement_tool_octopus.png" /></p>

<p>Packaging embeds the configuration value into the configuration file. This makes it available to anyone who has access to the host systems.</p>

<h3>Azure Key Vault</h3>

<p>Azure Key Vault acts as a centralized repository for all sensitive information. Key vault stores cryptographic keys and Secrets and makes them available over a HTTP Api. The objects (keys and secrets) in key vault has unique identifier to retrieve them. Check <a href="http://www.rahulpnath.com/blog/azure-key-vault-in-a-real-world-application/">Azure Key Vault in real world application</a> for more details on how to achieve this. A client application can <a href="http://www.rahulpnath.com/blog/authenticating-a-client-application-with-azure-key-vault/">authenticate with Azure Key Vault using a ClientID/secret or ClientID/certificate</a>. Using certificate to authenticate is the preferred approach. To get Keys/Secret from key vault all you need is the AD Application Id, the client secret or certificate identifier and the key/secret names. The certificate itself can be deployed separately into the application host.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='XML'><span class='line'><span class="nt">&lt;appSettings&gt;</span>
</span><span class='line'>  <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;KeyVaultUrl&quot;</span> <span class="na">value=</span><span class="s">&quot;https://testvaultrahul.vault.azure.net&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;ADApplicationId&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;ADCertificateThumbprint&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;DbConnectionString&quot;</span> <span class="na">value=</span><span class="s">&quot;SqlConnectionString&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;add</span> <span class="na">key =</span><span class="s">&quot;ApiToken&quot;</span> <span class="na">value=</span><span class="s">&quot;ApiToken/cfedea84815e4ca8bc19cf8eb943ee13&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/appSettings&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you are using the &lsquo;client secret&rsquo; to authenticate then the configuration file will have the Secret. In either cases, you should follow either of the previous approaches to keep the Application Id and authentication information out of configuration. The advantage of using <a href="http://www.rahulpnath.com/blog/category/azure-key-vault/">Key Vault</a> is that it is a centralized  repository for all your sensitive data, across different applications. You can also restrict access permissions per application.</p>

<p>These are some approaches to keep sensitive information out of source control. What approach do you use? Irrespective of the approach you use, make sure that you don’t check them in!</p>
]]></content>
  </entry>
  
</feed>
