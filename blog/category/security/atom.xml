<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: security | Rahul Nath]]></title>
  <link href="http://rahulpnath.com/blog/category/security/atom.xml" rel="self"/>
  <link href="http://rahulpnath.com/"/>
  <updated>2018-10-27T00:01:59+00:00</updated>
  <id>http://rahulpnath.com/</id>
  <author>
    <name><![CDATA[Rahul Nath]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Subresource Integrity (SRI)]]></title>
    <link href="http://rahulpnath.com/blog/subresource-integrity-sri/"/>
    <updated>2018-08-28T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/subresource-integrity-sri</id>
    <content type="html"><![CDATA[<p><em>This article is part of a series of articles - <a href="/blog/ok-i-have-got-https-what-next/">Ok I have got HTTPS! What Next?</a>. In this post, we explore how to use Subresource Integrity and the issues it solves.</em></p>

<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity">Subresource Integrity (SRI)</a> is a security feature that enables browsers to verify that files they fetch (for example, from a CDN) are delivered without unexpected manipulation. It works by allowing you to provide a cryptographic hash that a fetched file must match.</p>

<p><img src="/images/sri.png" class="center" alt="Subresource integrity" /></p>

<p>Using the integrity attribute on <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script">script</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link">link</a> element enables browsers to verify externally linked files before loading them. The integrity attribute takes a base64-encoded hash prefixed the corresponding hash algorithm prefix(at present sha256,sha3384, sha512), as shown in the example below.</p>

<p>&#8220;`javascript Integrity attribute as part of the script tag</p>

<p><script
  src="https://cdnjs.cloudflare.com/ajax/libs/redux/4.0.0/redux.js"
  integrity="sha256-KLkq+W1kKUA6iR5s5Xa/tdzU0yAmXNu7qIGKR/PBoUE="
  crossorigin="anonymous" />
```</p>

<h3>Generating SRI Hash</h3>

<p>To generate the SRI hash for files that are accessible over a URL, you can use <a href="https://www.srihash.org/">srihash.org</a> or <a href="https://allyoucan.cloud/tools/srigenerator/">srigenerator</a> depending on what hash algorithm version you want. If you&rsquo;re going to generate it on your local files, you can use OpenSSL command-line tool (which should be part of your git bash shell if you are looking around for it, like I did)</p>

<pre><code class="bash">openssl dgst -sha256 -binary FILENAME.js | openssl base64 -A
</code></pre>

<h3>Third-Party Libraries</h3>

<p>For third-party libraries (js and CSS) referred via CDN, you can grab the script/link element along with the integrity attribute from the CDN sites. Here is an example below from <a href="https://cdnjs.com/">cdnjs</a>.</p>

<p><img src="/images/sri_redux.png" alt="Generate script tag along with SRI Hash" class="center" /></p>

<p>When referring third party libraries via CDN its <a href="https://www.hanselman.com/blog/CDNsFailButYourScriptsDontHaveToFallbackFromCDNToLocalJQuery.aspx">good to fall back to a local copy</a>. In cases where the CDN is unreachable or the integrity check fails it can fall back to a local copy. I chose to include the integrity attribute on the fallback copy as well.</p>

<pre><code class="javascript">&lt;script&gt;
    window.jQuery || 
    document.write('&lt;script src="/javascripts/libs/jquery/jquery-2.0.3.min.js" crossorigin="anonymous" integrity="sha256-ruuHogwePywKZ7bI1vHGGs7ScbBLhkNUcSSeRjhSUko="&gt;\x3C/script&gt;')
&lt;/script&gt;
</code></pre>

<h3>Application Specific Files</h3>

<p>For application specific javascript files, you need to generate the hash everytime you modify it. You could look at integrating this with your build pipeline to make it seamless. You can use the OpenSSL command line tool as shown above to generate the hash during your application build process.</p>

<h3>Inline JavaScript</h3>

<p><em>The <a href="https://html.spec.whatwg.org/multipage/scripting.html#attr-script-integrity">integrity</a> attribute must not be specified when embedding a module script or when the src attribute is not specified.</em> This means that SRI cannot be used for inline javascript. Even though inline javascript should be avoided, there still are scenarios where you might use that or have dynamically generated javascript. In these cases, we can use <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src">nonce</a> attribute on script tag and whitelist that nonce in the <a href="https://rahulpnath.com/blog/http-content-security-policy-csp/">CSP Headers</a>.</p>

<blockquote><p><strong>nonce-&lt;base64-value></strong> <br/>
<em>A whitelist for specific inline scripts using a cryptographic nonce (number used once). The server must generate a unique nonce value each time it transmits a policy. It is critical to provide an unguessable nonce, as bypassing a resource’s policy is otherwise trivial. See unsafe inline script for example. Specifying nonce makes a modern browser ignore &lsquo;unsafe-inline&rsquo; which could still be set for older browsers without nonce support.</em></p></blockquote>

<p>For the jquery fallback above we need a nonce attribute since this is loaded inline.</p>

<pre><code class="js Nonce attribute">&lt;script nonce="anF1ZXJ5ZmFsbGJhY2s="&gt;
    window.jQuery || 
    document.write('&lt;script src="/javascripts/libs/jquery/jquery-2.0.3.min.js" crossorigin="anonymous" integrity="sha256-ruuHogwePywKZ7bI1vHGGs7ScbBLhkNUcSSeRjhSUko="&gt;\x3C/script&gt;')
&lt;/script&gt;
</code></pre>

<p>We can then specify this nonce on the CSP headers for the script-src. The nonce value can be anything that is base64 encoded.</p>

<pre><code class="xml Web.config CSP header">&lt;add 
  name="Content-Security-Policy" 
  value="default-src 'self';script-src c.disquscdn.com 'self' 'nonce-anF1ZXJ5ZmFsbGJhY2s=' 'nonce-ZGlzcXVzc2NyaXB0'; /&gt;
</code></pre>

<p>Using nonce allows us to get away with having an inline script. However, this should be avoided if possible. As you may have noticed, by having a nonce on the attribute does not validate the script contents of the associated tag. It executes anything that is within that tag. So if you have dynamic content within the script block, this can be used to your disadvantage by attackers. So use it only if it&rsquo;s absolutely necessary. However, having the nonce attribute for those cases is better so that you can limit inline javascript to those specific script tags.</p>

<h3>Browser Support</h3>

<p><a href="https://caniuse.com/#search=sri">Check if</a> your browser supports Subresource Integrity. Compared to a while back most of the browsers now support SRI.</p>

<p><a href="https://caniuse.com/#search=sri">
  <img src="/images/sri_browser.png" alt="SRI Browser Support" class="center" />
</a></p>

<p>Using SRI, we can make sure that the dependencies that we have are loaded are as expected and not modified in flight or at source by a malicious attacker. There is always a risk that you need to be willing to take when including external dependencies as they could be already having a threat embedded at the time of hash generation. For popular libraries, this is less likely. For those unpopular ones, it&rsquo;s always a good idea to take a quick look at the code to ensure it&rsquo;s not malicious. Using some tools to assist you with this is also a good idea, which we will look into in a separate article.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[HTTP Content Security Policy (CSP)]]></title>
    <link href="http://rahulpnath.com/blog/http-content-security-policy-csp/"/>
    <updated>2018-07-24T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/http-content-security-policy-csp</id>
    <content type="html"><![CDATA[<p><em>This article is part of a series of articles - <a href="/blog/ok-i-have-got-https-what-next/">Ok I have got HTTPS! What Next?</a>. In this post, we explore how to use HSTS security header and the issues it solves.</em></p>

<p>Content Security Policy (CSP) is a security response header or a <meta> element that instructs the browser, sources of information that it should trust for our website. A browser that supports CSP&rsquo;s then treats this list specified as a whitelist and only allows resources to be loaded only for those sources. CSP&rsquo;s allow you to specify source locations for a variety of resource types which are referred to as <a href="https://developer.mozilla.org/en-US/docs/Glossary/Fetch_directive">fetch directives</a>(e.g. _script-src, img-src,style-src* etc).</p>

<p><img src="/images/content-security-policy.png" alt="Content Security Policy"  class="center" /></p>

<p>CSP is an added layer of security that helps to detect and mitigate certain types of attacks, including Cross Site Scripting (XSS) and data injection attacks. These attacks are used for everything from data theft to site defacement or distribution of malware.</p>

<pre><code class="text Example">Content-Security-Policy: default-src 'self' *.rahulpnath.com
</code></pre>

<h3>Setting CSP Headers</h3>

<p><strong>Web Server Configuration</strong></p>

<p>CSP&rsquo;s can be set via the configuration file of your web server host if you want to specify it as part of the header. In my case I use Azure Web App, so all I need to do is add in a web.config file to my root with the header values. Below is an example which specified CSP headers (including Report Only) and <a href="/blog/http-strict-transport-security-sts-or-hsts/">STS headers</a>.</p>

<pre><code class="xml Web.config Sample">&lt;configuration&gt;
  &lt;system.webServer&gt;
    &lt;httpProtocol&gt;
      &lt;customHeaders&gt;
        &lt;add name="Content-Security-Policy" value="upgrade-insecure-requests;"/&gt;
        &lt;add name="Content-Security-Policy-Report-Only" value="default-src 'none';report-uri https://rahulpnath.report-uri.com/r/d/csp/reportOnly" /&gt;
        &lt;add name="Strict-Transport-Security" value="max-age=31536000; includeSubDomains; preload"/&gt;
      &lt;/customHeaders&gt;
    &lt;/httpProtocol&gt;
    ...
</code></pre>

<p><strong>Using Fiddler</strong></p>

<p>However if all you want is to play around with the CSP header and don&rsquo;t have access to your Web server or the configuration file, you can still test these headers. You can inject in the headers into the response using a <a href="blog/fiddler-free-web-debugging-proxy/">Web Proxy like Fiddler</a></p>

<p>To modify the request/response in-flight you can use one of the most powerful feature in Fiddler - <a href="https://www.telerik.com/blogs/understanding-fiddlerscript">Fiddler Script</a></p>

<blockquote><p>Fiddler Script allows you to enhance Fiddler’s UI, add new features, and modify requests and responses “on the fly” to introduce any behavior you’d like.</p></blockquote>

<p>Using the below script, we can inject &lsquo;Content-Security-Policy&rsquo; header whenever the request matches a specific criteria.</p>

<p><img src="/images/https_csp_fiddler_script.png" alt="Fiddler Script to update CSP"  class="center" /></p>

<pre><code class="javascript Fiddler Script - Inject CSP Header">if (oSession.HostnameIs("rahulpnath.com")) {
  oSession.oResponse.headers["Content-Security-Policy"] =
    "default-src 'none'; img-src 'self';script-src 'self';style-src 'self'";
}
</code></pre>

<p>By injecting these headers, we can play around with the CSP headers for the webiste without affecting other users. Once you have the CSP rules that cater to your site you can commit this to the actual website. Even with all the CSP headers set, you can additionally set the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to">report-to</a> (or deprecated <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri">report-uri</a>) directive on the policy to capture any policies that you may have missed.</p>

<h3>Content-Security-Policy-Report-Only</h3>

<p>The <em>Content-Security-Policy_Report-Only</em> header allows to test the header settings without any impact and also to capture any CSP headers that you might have missed on your website. The browser uses this for reporting purposes only and does not enforce the policies. We can specify a report endpoint to which the browser will send any CSP violations as a JSON object.</p>

<p>Below is an example of a CSP violation POST request send from the browser to the report URL that I had specified for this blog. I am using an endpoint from the <a href="https://report-uri.com/">Report URI</a> service (more on this later)</p>

<pre><code class="json Example">POST https://rahulpnath.report-uri.com/r/d/csp/reportOnly HTTP/1.1
{
    "csp-report": {
        "document-uri": "https://www.rahulpnath.com/",
        "referrer": "",
        "violated-directive": "img-src",
        "effective-directive": "img-src",
        "original-policy": "default-src 'none';report-uri https://rahulpnath.report-uri.com/r/d/csp/reportOnly",
        "disposition": "report",
        "blocked-uri": "https://www.rahulpnath.com/apple-touch-icon-120x120.png",
        "line-number": 29,
        "source-file": "https://www.rahulpnath.com/",
        "status-code": 0,
        "script-sample": ""
    }
}
</code></pre>

<h3>Generating CSP Policies</h3>

<p>Coming up with the CSP policies for your site can be a bit tricky as there are a lot of options and directives involved. Your site might also be pulling in dependencies from a variety of sources. Setting CSP policies is also an excellent time to review your application dependencies and manage them correctly. For e.g., if you have a javascript file from an untrusted source, etc. There are a few ways by which you can go about generating CSP policies. Below are two ways I found useful and easy to get started.</p>

<p><strong>Using Fiddler</strong></p>

<p>The <a href="https://github.com/david-risney/CSP-Fiddler-Extension">CSP Fiddler Extension</a> is a Fiddler extension that helps you produce a strong CSP for a web page (or website). Install the extension and with Fiddler running navigate to your web pages using a browser that supports CSP.</p>

<blockquote><p><em>The extension adds mock Content-Security-Policy-Report-Only headers to servers&#8217; responses and uses the report-uri <a href="https://fiddlercsp.deletethis.net/unsafe-inline.">https://fiddlercsp.deletethis.net/unsafe-inline.</a> The extension then listens to the specified report-uri and generates a CSP based on the gathered information</em></p></blockquote>

<p><img src="/images/https_csp_fiddler_rule_collector.png" class="center" alt="Fiddler CSP Rule Collector" /></p>

<p><strong>Using Report URI</strong></p>

<p><a href="https://report-uri.com/">ReportURI</a> is a real-time security reporting tool which can be used to collect various metrics about your website. One of the features it provides is giving a nice little wizard interface for creating your CSP headers. <a href="https://report-uri.com/#prices">Pricing</a> is usage based and provides the first 10000 reports of the month free (which is what I am using for this blog).</p>

<p>ReportURI gives a dashboard summarizing the various stats of your site and also provides features to explore these in detail.</p>

<p><img src="/images/csp_report_uri_dashboard.png" alt="Report Uri Dashboard" class="center" /></p>

<p>One of the cool features is the <a href="https://scotthelme.co.uk/report-uri-csp-wizard/">CSP Wizard</a> which as the name suggests, provides a wizard-like UI to build out CSP&rsquo;s for the site. The websites need to be configured to report CSP errors to a specific endpoint on your ReportURI endpoint (as shown below). The header value can be set either on CSP header or the Report Only header.</p>

<blockquote><p><em>You can find your report URL from the Setup tab on Report URI. Make sure you use the URL under the options Report Type: CSP and Report Disposition: <strong>Wizard</strong></em></p></blockquote>

<pre><code class="text">Content-Security-Policy-Report-Only: default-src 'none';report-uri https://&lt;subdomain&gt;.report-uri.com/r/d/csp/wizard
</code></pre>

<p>Once all configured and reports start coming in you can use the Wizard to pick and choose what sources you need to whitelist for your website. You might see a lot of unwanted sources and entries in the wizard as it just reflects what is reported to it. You need to filter it out manually and build the list.</p>

<p>Once you have the CSP&rsquo;s set you can check out if your site does the Harlem Shake by pressing F12 and running the below script. Though this is not any sort of test, it is a fun exercise to do.</p>

<div class="alert alert-warning">
<b>Copy pasting scripts from unknown source is not at all recommended and is one of the most powerful ways that an attacker can get access to your account.</b> Having a well defined CSP prevents such script attacks as well on your sites. Don&#8217;t be suprised if your banking site also shakes to the tune of the script below. 
</div>


<p><em>That said do give the below script a try! I did go through the code pasted below and it is not malicious. All it does modify your dom elements and plays a music. The original source is available below but I do not control it and it could have change since the time of writing.</em></p>

<pre><code class="javascript Harlem Shake - F12 on Browser tab and run below script (Check your Volume)">//Source: http://pastebin.com/aJna4paJ
javascript:(function(){function c(){var e=document.createElement("link");e.setAttribute("type","text/css");
e.setAttribute("rel","stylesheet");e.setAttribute("href",f);e.setAttribute("class",l);
document.body.appendChild(e)}function h(){var e=document.getElementsByClassName(l);
for(var t=0;t&lt;e.length;t++){document.body.removeChild(e[t])}}function p(){var e=document.createElement("div");
e.setAttribute("class",a);document.body.appendChild(e);setTimeout(function(){document.body.removeChild(e)},100)}
function d(e){return{height:e.offsetHeight,width:e.offsetWidth}}function v(i){var s=d(i);
return s.height&gt;e&amp;&amp;s.height&lt;n&amp;&amp;s.width&gt;t&amp;&amp;s.width&lt;r}function m(e){var t=e;var n=0;
while(!!t){n+=t.offsetTop;t=t.offsetParent}return n}function g(){var e=document.documentElement;
if(!!window.innerWidth){return window.innerHeight}else if(e&amp;&amp;!isNaN(e.clientHeight)){return e.clientHeight}return 0}
function y(){if(window.pageYOffset){return window.pageYOffset}return Math.max(document.documentElement.scrollTop,document.body.scrollTop)}
function E(e){var t=m(e);return t&gt;=w&amp;&amp;t&lt;=b+w}function S(){var e=document.createElement("audio");e.setAttribute("class",l);
e.src=i;e.loop=false;e.addEventListener("canplay",function(){setTimeout(function(){x(k)},500);
setTimeout(function(){N();p();for(var e=0;e&lt;O.length;e++){T(O[e])}},15500)},true);
e.addEventListener("ended",function(){N();h()},true);
e.innerHTML=" &lt;p&gt;If you are reading this, it is because your browser does not support the audio element. We recommend that you get a new browser.&lt;/p&gt; &lt;p&gt;";
document.body.appendChild(e);e.play()}function x(e){e.className+=" "+s+" "+o}
function T(e){e.className+=" "+s+" "+u[Math.floor(Math.random()*u.length)]}function N(){var e=document.getElementsByClassName(s);
var t=new RegExp("\\b"+s+"\\b");for(var n=0;n&lt;e.length;){e[n].className=e[n].className.replace(t,"")}}var e=30;var t=30;
var n=350;var r=350;var i="//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake.mp3";var s="mw-harlem_shake_me";
var o="im_first";var u=["im_drunk","im_baked","im_trippin","im_blown"];var a="mw-strobe_light";
var f="//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css";var l="mw_added_css";var b=g();var w=y();
var C=document.getElementsByTagName("*");var k=null;for(var L=0;L&lt;C.length;L++){var A=C[L];if(v(A)){if(E(A)){k=A;break}}}
if(A===null){console.warn("Could not find a node of the right size. Please try a different page.");return}c();S();
var O=[];for(var L=0;L&lt;C.length;L++){var A=C[L];if(v(A)){O.push(A)}}})()
</code></pre>

<p>I am still playing around with the CSP headers for this blog and currently testing it out using the ReportOnly header along with ReportURI. Hope this helps you to start putting the correct CSP headers for your site as well!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[HTTP Strict Transport Security (STS or HSTS)]]></title>
    <link href="http://rahulpnath.com/blog/http-strict-transport-security-sts-or-hsts/"/>
    <updated>2018-07-10T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/http-strict-transport-security-sts-or-hsts</id>
    <content type="html"><![CDATA[<p><em>This article is part of a series of articles - <a href="/blog/ok-i-have-got-https-what-next/">Ok I have got HTTPS! What Next?</a>. In this post, we explore how to use HSTS security header and the issues it solves.</em></p>

<p>When you enter a domain name in the browser without specifying the protocol (HTTP or HTTPS) the browser by default sends the first request over HTTP. For a server that supports only HTTPS, when it sees such a request, it redirects the request over to HTTPS. The server responds to the client with a <em>302 Redirect</em>, redirecting the client to HTTPS, from which on the browser starts requesting over HTTPS. As you can see here, the very first request that the client makes is over an insecure channel (HTTP), so is also vulnerable to attacks. You could be prone to man-in-the-middle (MITM) attack, and someone could spoof that request and point you to a different site, inject malicious scripts, etc. <strong>The first insecure HTTP request is made everytime you enter the domain name in the browser or make an explicit call over HTTP.</strong></p>

<p><img src="/images/hsts_tofu.png" alt="Trust on First Use" class="center"></p>

<blockquote><p><em>The HTTP <strong>Strict-Transport-Security</strong> response header (often abbreviated as HSTS) lets a website tell browsers that it should only be accessed using HTTPS, instead of using HTTP</em></p></blockquote>

<p>By using the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">HTTP Strict Transport Security</a> (HSTS) header on your response headers, you are instructing the browser to make calls over HTTPS instead of HTTP for your site.</p>

<pre><code class="text Syntax">Strict-Transport-Security: max-age=&lt;expire-time&gt;
Strict-Transport-Security: max-age=&lt;expire-time&gt;; includeSubDomains
Strict-Transport-Security: max-age=&lt;expire-time&gt;; preload
</code></pre>

<p>There are a few directives that you can set on the header which determines how the browser uses the header. By just setting the header with a <em>max-age</em> (required) directive, you tell the browser the <em>time in seconds that the browser should remember that a site is only to be accessed using HTTPS</em>. By default, the setting affects only the current subdomain. Additionally, you can set the <em>includeSubDomains</em> directive to apply this rule to all subdomain of the site. <strong>Before including all subdomains make sure those are served over HTTPS as well so that you do end up blocking your other sites on the same domain (if any).</strong></p>

<p>As you can see with the HSTS header specified, the browser now only makes one insecure request (the one that it makes everytime the cache expires or the very first request). Once it has established a successful connection with the server, all further requests are over HTTPS for the <em>max_age</em> (cache expiry) set. <strong>With the HSTS header the surface area of the attack gets reduced to just one request as compared to all initial requests going over HTTP (when we did not have the HSTS header).</strong></p>

<p>To verify the HSTS header setting has been applied for your website open your browser in Incognito/In-Private browsing mode. It is to make sure that the browser acts as if it is seeing the site for the very first time (as HSTS header caches do not get shared across regular/incognito sessions)</p>

<blockquote><p><em>The HSTS header settings do not get shared across between the regular and incognito browsing session (at least in Chrome and think this is the same for other browsers as well).</em></p></blockquote>

<p>Open the Developer tools window and monitor the Network requests made by the browser. Request your website over HTTP (either explicitly or just entering the domain name) in this case my blog <a href="http://rahulpnath.com">http://rahulpnath.com</a>. As you can see the very first request go over HTTP and the server returns a <em>301 Moved Permanently</em> status with the https version of the site. For any subsequent requests over HTTP, the browser returns a <em>307 Internal Redirect</em>. This redirect happens within the boundary of your browser and redirects to the HTTPS site. You can use <a href="https://rahulpnath.com/blog/fiddler-free-web-debugging-proxy/">Fiddler</a> to verify that this request does not cross the browser boundary. (The request does not get to Fiddler.)</p>

<p><img src="/images/hsts_without_preload.png" alt="HSTS without preload" class ="center" /></p>

<p>We could still argue that there is still a potential threat with the very first request sent over HTTP which is still vulnerable to MITM attack. To solve that we can use the <em>preload</em> directive and submit out domain to an <a href="https://hstspreload.org/">HSTS Preload list</a>, which when successfully added, propagates to the source code of Browsers.</p>

<blockquote><p><em>Most major browsers (Chrome, Firefox, Opera, Safari, IE 11 and Edge) also have HSTS preload lists based on the Chrome list.</em></p></blockquote>

<p>The Browsers hardcode these domains from the preload approved list into their source code (e.g., here is <a href="https://chromium.googlesource.com/chromium/src/net/+/master/http/transport_security_state_static.json">Chrome&rsquo;s list</a>) and gets shipped with their releases. You can check for the preloaded site in the browser as well. Again for chrome navigate to <em>chrome://net-internals/#hsts</em> and query for the HSTS domain.</p>

<p><img src="/images/hsts_preload_static_json.png" alt="HSTS preloaded site hardcoded" class ="center" /></p>

<p>If STS is not set at all or you have not made the very first request to the server (when preload is false) querying for the domain returns &lsquo;Not Found.&rsquo; Below are two variations that you can see depending on whether you have <em>preload</em> set or not. The <em>dynamic_*_*</em> indicates that STS is set after the first load of the site and the <em>static_*_*</em> indicates that it is set from the preload list.</p>

<blockquote><p><em>If you are wondering why this blog does not have _static_*_*</em> set it is because the preload list that it is part of has not yet made into a stable version of Chrome. However, the preload site does show that it is currently preloaded (probably in a beta version at the time of writing)._</p></blockquote>

<p><img src="/images/chrome_hsts_preload.png" alt="Verifying HSTS preload" class ="center" /></p>

<p>With the preload set and your domain hardcoded into the preload list and available as part of the browser version you are on, any request made over HTTP is redirected internally (307) to HTTPS without even going to the server. It means <strong>we have entirely got rid of the first untrusted HTTP request.</strong></p>

<p><img src="/images/hsts_internal_redirect_scott.png" alt="HSTS preload request flow" class ="center" /></p>

<p>Have you already got HSTS set on your site?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ok I Have Got HTTPS! What Next?]]></title>
    <link href="http://rahulpnath.com/blog/ok-i-have-got-https-what-next/"/>
    <updated>2018-07-09T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/ok-i-have-got-https-what-next</id>
    <content type="html"><![CDATA[<p>Security is of more and more a concern these days and we <a href="https://rahulpnath.com/blog/https-for-free-and-why-you-should-care/">saw why it&rsquo;s important to move on to HTTPs</a>. Hope you have already moved on to HTTPS, If not right now is a perfect time - this is one of the things that you should not be putting off for later. Also, do check out the <a href="https://httpsiseasy.com/">HTTPS is Easy</a> series by Troy Hunt on how simple it is to get onboard with HTTPS. Most of the things mentioned here, I started exploring after getting introduced to it by <a href="https://scotthelme.co.uk/">Scott Helme</a> and <a href="https://www.troyhunt.com/">Troy Hunt</a> at the <a href="https://rahulpnath.com/blog/ndc-security-2018-overview-and-key-takeaways/">NDC Security conference</a>.</p>

<p><a href="https://securityheaders.com/?q=rahulpnath.com&followRedirects=on">
    <img
        src="/images/https_next.png"
        alt="Security Report Summary from SecurityHeaders.com"
        class="center" />
</a></p>

<p>Once you have moved on to HTTPS you might be thinking is that it? Or is there still more that I need to be doing? An excellent place to start is <a href="https://securityheaders.com/">SecurityHeaders.com</a>, which analyses security headers on your website and provides a rating score for the site. The site also gives a short description of the various headers, appropriate links to explore more about them. Some of the headers are easy to add and immediately provides added security to your website.</p>

<div class="alert alert-warning">
Just because you have an A+ Rating (or a good rating) does not mean that your site is not vulnerable to any attacks. These are just some guidelines to help you along the way to tighten up your website security.
</div>


<blockquote><p><em>I have been trying to walk the talk here - implementing these headers one by one on this blog as and when I am writing this</em></p></blockquote>

<p>In this post will walk through some of the headers that I added to this blog. I am planning to write this as a multi-series article, with each article specific to a header/other feature, why I added it and how I went about adding and verifying it.</p>

<ul>
<li><a href="/blog/http-strict-transport-security-sts-or-hsts">HTTP Strict-Transport-Security (HSTS/STS)</a></li>
<li><a href="/blog/http-content-security-policy-csp/">Content-Security-Policy (CSP)</a></li>
<li><a href="/blog/subresource-integrity-sri/">Subresource Integrity</a></li>
<li>Development Tools</li>
</ul>


<p>I will be updating the links to the relevant posts here as I publish them and will add to the list as and when I come across new topics. One of the tricky thing with security is that very often something new comes up. The best we can do is to proactively do things that we can do to support and protect ourselves.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Tip of the Week: Check If You Have Been Hacked!]]></title>
    <link href="http://rahulpnath.com/blog/check-if-you-have-been-hacked/"/>
    <updated>2018-05-31T00:00:00+00:00</updated>
    <id>http://rahulpnath.com/blog/check-if-you-have-been-hacked</id>
    <content type="html"><![CDATA[<p><img src="/images/password_manager.jpg" alt ="https://pixabay.com/en/data-security-keyboard-computer-1590455/" class="center" /></p>

<p>With more and more data breaches happening it is possible that your personal information and passwords are already compromised. If you have been lazy and reusing passwords (just like me until a while back) across multiple sites then it is good to check if your password is already compromised. It necessarily need not be one of your social media account or bank account that needs to be compromised for an attacker to get your credentials. If you have been reusing passwords across sites, it might be that one site where security is not given much importance for that gets breached, exposing your credentials to the attacker or anyone who has the breached data. Often hackers use this information to try and enumerate other sites, social network, bank logins to try and login assuming the behaviour of password reuse.</p>

<blockquote><p><em>Check your <a href="https://haveibeenpwned.com/">email</a> or <a href="https://haveibeenpwned.com/Passwords">password</a> to see if any has been part of a data breach.</em></p></blockquote>

<p>To check if you have been part of a data breach you can use the service <a href="https://haveibeenpwned.com/">haveibeenpwned</a>. If you have been part of any data breaches, then it will show you the details. In addition to that, you can also use the <a href="https://haveibeenpwned.com/Passwords">Pwned Passwords</a> list to check if the password that you use has been part of any data breaches. It&rsquo;s good to change your password if you find yours in there. If you are worried about entering your password in haveibeenpwned site, the good thing is that it uses <a href="https://www.troyhunt.com/ive-just-launched-pwned-passwords-version-2/">k-anonymity model</a>, which means that your full password is not sent across the wire.</p>

<h3>Next Steps</h3>

<ul>
<li>Update your passwords on all sites that you use if you have been reusing passwords. If you don&rsquo;t have much time to do this in one shot, you can do this incrementally as and when you next visit them.</li>
<li>Make sure you have unique passwords for each of the site. <a href="https://www.troyhunt.com/only-secure-password-is-one-you-cant/">A good password is one that you cannot remember</a>. So if you are not using a <a href="https://rahulpnath.com/blog/password-manager-get-one-if-you-havent-already/">Password Manager</a> it&rsquo;s a good idea to start using. If you don&rsquo;t want to spend money on a password manager, you can always use a <a href="https://www.lastpass.com/password-generator">random password generator</a> to generate one for you. Remembering that password might be hard, you could either write it down or save it in the browser (not that I am recommending it over getting a Password Manager, but better than reusing passwords).</li>
</ul>

]]></content>
  </entry>
  
</feed>
