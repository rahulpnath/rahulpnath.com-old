<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>Rahul Nath</title>
  <meta name="author" content="Rahul Nath">

  
<meta name="description" content="Rahul Nath on Programming and life in general" />


<meta name="keywords" content=".NET, programming, rahul nath, rahul, C#, India" />

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://rahulpnath.com/blog/page/4">
  
<!-- Favicon -->
  <link href="/favicon.png" type="image/png" rel="icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
<!-- End Favicon -->
  <link href="http://feeds2.feedburner.com/rahulpnath" rel="alternate" title="Rahul Nath" type="application/atom+xml">

  <script src="/javascripts/libs/jquery/jquery-2.0.3.min.js"></script>

<link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">


  
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">

  
   <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-43172163-1', 'auto');
    ga('send', 'pageview');

  </script>


</head>

  <body   >
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Rahul Nath</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a rel="index" href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
                <li >
                    <a href="/apps">Apps</a>
                </li>
                <li >
                    <a href="/about">About</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="http://feeds2.feedburner.com/rahulpnath" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="search navbar-form navbar-right" action="http://google.com/cse" method="GET">
                    <input type="hidden" name="cx" value="013909293779229500224:v37rx6hsidk" />
                    <input name="ie" type="hidden" value="UTF-8">
                    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9">
    <div class="blog-index" itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="name" content="Rahul Nath" />
    <meta itemprop="description" content="Rahul Nath on Programming and life in general" />
    <meta itemprop="url" content="http://rahulpnath.com" />
      
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-capitalize">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-08-25T09:53:00+05:30"  data-updated="true" itemprop="datePublished dateCreated">Aug 25<sup>th</sup>, 2013</time>
        

<span class="glyphicon glyphicon-tags"></span>&nbsp; Posted in&nbsp; 
<span class="categories">
  
    <a class='category' href='/blog/category/windows-phone/'>windows phone</a>, <a class='category' href='/blog/category/wp7/'>wp7</a>
  
</span>


        
      </p>
    
    
      <h1 class="entry-title" itemprop="name headline"><a href="/blog/windows-phone-series-jump-lists/" itemprop="url">Windows Phone Series – Jump Lists</a></h1>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>One of the best things about the windows phone is that way you can navigate large lists of data.  Jumplist provides an easy and fast way to navigate large data, just like we do in the contacts hub or the apps collection. It would be great to have this behaviour even in the apps that we develop so that we can give a consistent experience to our application users.
Jumplist can be implemented using LongListSelector, which is part of the <a href="http://phone.codeplex.com/">Windows Phone toolkit</a> for Windows phone 7. With Windows Phone 8 this is included along with the sdk. Implementing jump list with the longlistselector is easy enough, that you can get this into your application in a few minutes. Lets see how.
If you are already using a listbox then you should be changing it to a longlistselector or if you are already using that, then you might be using it in the “ungrouped mode”, by setting IsFlatList=”True”. Change this to False.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;toolkit:LongListSelector</span> <span class="na">Name=</span><span class="s">&quot;allPersons&quot;</span> <span class="na">IsFlatList=</span><span class="s">&quot;False&quot;</span> <span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;/toolkit:LongListSelector&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We need to specify a few templates for the date to be rendered to our needs as shown below. In this example we would be looking at a contacts sample.</p>

<p><img src="/images/wp_jumplist_items.png" alt="windows_phone_jumplist_items" /><img src="/images/wp_jumplist_groups.png" alt="windows_phone_jumplist_groups" /></p>

<p><strong>ItemTemplate</strong></p>

<p>The itemtemplate specifies how the bound list of items should be displayed. This would be the same as that you have been using earlier for your listbox.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;toolkit:LongListSelector.ItemTemplate&gt;</span>
</span><span class='line'>    <span class="nt">&lt;DataTemplate&gt;</span>
</span><span class='line'>        <span class="nt">&lt;TextBlock</span> <span class="na">Text=</span><span class="s">&quot;{Binding Name}&quot;</span> <span class="na">FontSize=</span><span class="s">&quot;30&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/DataTemplate&gt;</span>
</span><span class='line'><span class="nt">&lt;/toolkit:LongListSelector.ItemTemplate&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>GroupHeaderTemplate</strong></p>

<p>The groupheadertemplate specifies the template for each header of the group.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'> <span class="nt">&lt;toolkit:LongListSelector.GroupHeaderTemplate&gt;</span>
</span><span class='line'>    <span class="nt">&lt;DataTemplate&gt;</span>
</span><span class='line'>       <span class="nt">&lt;Border</span> <span class="na">Background=</span><span class="s">&quot;Red&quot;</span> <span class="na">HorizontalAlignment=</span><span class="s">&quot;Left&quot;</span> <span class="na">Width=</span><span class="s">&quot;50&quot;</span> <span class="na">Height=</span><span class="s">&quot;50&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>         <span class="nt">&lt;TextBlock</span> <span class="na">Text=</span><span class="s">&quot;{Binding Title}&quot;</span> <span class="na">FontSize=</span><span class="s">&quot;30&quot;</span> <span class="na">HorizontalAlignment=</span><span class="s">&quot;Center&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>       <span class="nt">&lt;/Border&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/DataTemplate&gt;</span>
</span><span class='line'><span class="nt">&lt;/toolkit:LongListSelector.GroupHeaderTemplate&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>GroupItemTemplate</strong></p>

<p>The groupitemtemplate specifies the template for the headers, when in group view mode. This is the display that would be presented when we are to choose a group to navigate to.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'> <span class="nt">&lt;toolkit:LongListSelector.GroupItemTemplate&gt;</span>
</span><span class='line'>    <span class="nt">&lt;DataTemplate&gt;</span>
</span><span class='line'>        <span class="nt">&lt;Button</span> <span class="na">IsEnabled=</span><span class="s">&quot;{Binding HasData}&quot;</span> <span class="na">BorderThickness=</span><span class="s">&quot;0&quot;</span> <span class="na">Background=</span><span class="s">&quot;Transparent&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>            <span class="nt">&lt;Border</span> <span class="na">Background=</span><span class="s">&quot;Red&quot;</span> <span class="na">BorderThickness=</span><span class="s">&quot;0&quot;</span> <span class="na">Width=</span><span class="s">&quot;60&quot;</span> <span class="na">Height=</span><span class="s">&quot;60&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>                <span class="nt">&lt;TextBlock</span> <span class="na">VerticalAlignment=</span><span class="s">&quot;Center&quot;</span> <span class="na">HorizontalAlignment=</span><span class="s">&quot;Center&quot;</span> <span class="na">FontSize=</span><span class="s">&quot;38&quot;</span> <span class="na">Margin=</span><span class="s">&quot;4&quot;</span> <span class="na">Text=</span><span class="s">&quot;{Binding Title}&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>            <span class="nt">&lt;/Border&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/Button&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/DataTemplate&gt;</span>
</span><span class='line'><span class="nt">&lt;/toolkit:LongListSelector.GroupItemTemplate&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>GroupItemsPanel</strong></p>

<p>The groupitemspanel specifies the panel to be used to display the groupitems. If we are using only alphabets as the group headers, then we would want to wrap each of these items. If our group items are long enough then it would be better to leave it as default which would be a stackpanel.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'> <span class="nt">&lt;toolkit:LongListSelector.GroupItemsPanel&gt;</span>
</span><span class='line'>    <span class="nt">&lt;ItemsPanelTemplate&gt;</span>
</span><span class='line'>        <span class="nt">&lt;toolkit:WrapPanel</span> <span class="na">Margin=</span><span class="s">&quot;5&quot;</span> <span class="na">Background=</span><span class="s">&quot;Black&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/ItemsPanelTemplate&gt;</span>
</span><span class='line'><span class="nt">&lt;/toolkit:LongListSelector.GroupItemsPanel&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We need to group the data that gets bound to the list. For a normal listbox you would either bind a List or an ObservableCollection. In this we would need to group the data that gets bound to the control as groups that we want to display. In this example our data is a list of Persons, and we would want to group the data with their starting character. If the starting character is an alphabet, then we would display that person under that character. For any non-alphabet we would group it under ‘#’. The GroupedPersons in our DataRepository would return the data for us.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'> <span class="k">public</span> <span class="k">static</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Group</span><span class="p">&lt;</span><span class="n">Person</span><span class="p">&gt;&gt;</span> <span class="n">GroupedPersons</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">get</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">List</span><span class="p">&lt;</span><span class="n">Group</span><span class="p">&lt;</span><span class="n">Person</span><span class="p">&gt;&gt;</span> <span class="n">groupedArticles</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Group</span><span class="p">&lt;</span><span class="n">Person</span><span class="p">&gt;&gt;();</span>
</span><span class='line'>        <span class="kt">char</span><span class="p">[]</span> <span class="n">az</span> <span class="p">=</span> <span class="n">Enumerable</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="sc">&#39;a&#39;</span><span class="p">,</span> <span class="m">26</span><span class="p">).</span><span class="n">Select</span><span class="p">(</span><span class="n">a</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">a</span><span class="p">).</span><span class="n">ToArray</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">foreach</span> <span class="p">(</span><span class="kt">char</span> <span class="n">letter</span> <span class="k">in</span> <span class="n">az</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">Group</span><span class="p">&lt;</span><span class="n">Person</span><span class="p">&gt;</span> <span class="n">groupedLetter</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Group</span><span class="p">&lt;</span><span class="n">Person</span><span class="p">&gt;()</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">Title</span> <span class="p">=</span> <span class="n">letter</span><span class="p">.</span><span class="n">ToString</span><span class="p">(),</span>
</span><span class='line'>                <span class="n">Items</span> <span class="p">=</span> <span class="n">Persons</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">a</span> <span class="p">=&gt;</span> <span class="n">a</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="n">letter</span><span class="p">.</span><span class="n">ToString</span><span class="p">(),</span> <span class="n">StringComparison</span><span class="p">.</span><span class="n">CurrentCultureIgnoreCase</span><span class="p">)).</span><span class="n">Where</span><span class="p">(</span><span class="n">a</span> <span class="p">=&gt;</span> <span class="n">a</span> <span class="p">!=</span> <span class="k">null</span><span class="p">).</span><span class="n">ToList</span><span class="p">()</span>
</span><span class='line'>            <span class="p">};</span>
</span><span class='line'>            <span class="n">groupedLetter</span><span class="p">.</span><span class="n">HasData</span> <span class="p">=</span> <span class="n">groupedLetter</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Any</span><span class="p">();</span>
</span><span class='line'>            <span class="n">groupedArticles</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">groupedLetter</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// Articles that start with a number should be added to # tag</span>
</span><span class='line'>        <span class="kt">var</span> <span class="n">list</span> <span class="p">=</span> <span class="n">groupedArticles</span><span class="p">.</span><span class="n">SelectMany</span><span class="p">(</span><span class="n">a</span> <span class="p">=&gt;</span> <span class="n">a</span><span class="p">.</span><span class="n">Items</span><span class="p">).</span><span class="n">ToList</span><span class="p">();</span>
</span><span class='line'>        <span class="kt">var</span> <span class="n">nonAlphabetIssues</span> <span class="p">=</span> <span class="n">Persons</span><span class="p">.</span><span class="n">Except</span><span class="p">(</span><span class="n">list</span><span class="p">);</span>
</span><span class='line'>        <span class="n">groupedArticles</span><span class="p">.</span><span class="n">Insert</span><span class="p">(</span>
</span><span class='line'>            <span class="m">0</span><span class="p">,</span>
</span><span class='line'>            <span class="k">new</span> <span class="n">Group</span><span class="p">&lt;</span><span class="n">Person</span><span class="p">&gt;()</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">Items</span> <span class="p">=</span> <span class="n">nonAlphabetIssues</span><span class="p">.</span><span class="n">ToList</span><span class="p">(),</span>
</span><span class='line'>                <span class="n">Title</span> <span class="p">=</span> <span class="s">&quot;#&quot;</span><span class="p">,</span>
</span><span class='line'>                <span class="n">HasData</span> <span class="p">=</span> <span class="n">nonAlphabetIssues</span><span class="p">.</span><span class="n">Any</span><span class="p">()</span>
</span><span class='line'>            <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">groupedArticles</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>To get all the characters from A-Z we use the below code, after which it is some simple logics, that would is self explanatory</p>

<pre><code class="csharp"> char[] az = Enumerable.Range('a', 26).Select(a =&gt; (char)a).ToArray();
</code></pre>

<p>This should now have made your flat list into a easily navigable jump list, that your users would love to use and make it easier for them to use you application.</p>

<p>You can find the code for this sample <a href="https://github.com/rahulpnath/JumpList">here</a></p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-capitalize">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-08-18T21:34:48+05:30"  data-updated="true" itemprop="datePublished dateCreated">Aug 18<sup>th</sup>, 2013</time>
        

<span class="glyphicon glyphicon-tags"></span>&nbsp; Posted in&nbsp; 
<span class="categories">
  
    <a class='category' href='/blog/category/reviews/'>reviews</a>, <a class='category' href='/blog/category/web/'>web</a>
  
</span>


        
      </p>
    
    
      <h1 class="entry-title" itemprop="name headline"><a href="/blog/http-a-short-dive/" itemprop="url">HTTP – A Short Dive</a></h1>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>Day in and day out, knowingly or unknowingly we get to use http. While accessing a web site, even the current one that you are reading, you are using http. Http is an application protocol that forms the basis of data communication for the web. As an end user of web pages, it is not necessary to be aware of the protocol, but as developers we ought to know in detail about the protocol and its possibilities.</p>

<p>You could find in detail about the entire protocol spec, <a href="http://www.w3.org/Protocols/rfc2616/rfc2616.html">here</a>.  If you have already gone through it in its entirety then this blog might be of very little or no help at all. For the others, who I suppose majority of us would be this is just about pointing you to another resource that would take hardly a couple of hours of your time, to get enough information on the protocol.</p>

<p><img class="left" src="/images/http_succinctly.png"  alt="http succinctly" /></p>

<p>With all the concise and precise information , <strong><a href="http://www.syncfusion.com/resources/techportal/ebooks?UTM_medium=rahulblogreview">Syncfusion’s Succinctly series</a></strong> has a very good resource covering <a href="http://www.syncfusion.com/resources/techportal/ebooks/http?UTM_medium=rahulblogreview"><strong>HTTP</strong></a>.  As the name, succinctly suggests, this book series gives you enough information that enables you to master a wide range of topics.  All you need to do is to fill up a contact form and get access to all the books in kindle and pdf format, all for free.  As a company this is a a very good contribution that Syncfusion is making to the community giving away all these resources for free.</p>

<p>The HTTP Succinctly book is written by <a href="http://odetocode.com/">Scott Allen</a> and it covers Resources, Messages, Connections, Web Architecture, State and Security.</p>

<p>The book details on the url format , encoding and various media types and how they are served when a request is made. It expands on the request , response  messages and and different response status codes.  Scott goes on to explain on how http uses the underlying tcp protocol, to transfer messages across the network and how browsers open parallel connections to speed up the way web sites are delivered to us.  If it was not for proxies and caching the web would not be as scalable as it is today. The protocol would not be complete without mentioning about these and so does this one.  Http being a stateless protocol, maintaining state is a very important thing for developers to provide a good experience to the users. The book touches on cookies, its uses, types and downsides. The book closes on discussing about security and different modes of authentication.
The HTTP Succinctly discusses on all the important topics of the protocol required to us as developers, and I would strongly urge any web developer to read through this 55 pages of concise and precise information. Having such books takes away the need for searching through the web and figuring out all related articles and blog posts to get the required information.  Hope to see more books getting added into this series of books.</p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-capitalize">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-07-26T10:51:51+05:30"  data-updated="true" itemprop="datePublished dateCreated">Jul 26<sup>th</sup>, 2013</time>
        

<span class="glyphicon glyphicon-tags"></span>&nbsp; Posted in&nbsp; 
<span class="categories">
  
    <a class='category' href='/blog/category/windows-phone/'>windows phone</a>
  
</span>


        
      </p>
    
    
      <h1 class="entry-title" itemprop="name headline"><a href="/blog/mvvm-a-windows-phone-scenario/" itemprop="url">MVVM – A Windows phone scenario</a></h1>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>With multiple platforms/devices, embracing the same technology, common architectural patterns become more popular as they provide us with what we want the most – <strong>Reusability. </strong>MVVM has turned out to be a must use architectural pattern while developing for Windows phone/Windows 8 store apps. I had blogged on this, <a href="http://rahulpnath.com/blog/mvvm-does-it-really-matter/">Why MVVM matters</a>.</p>

<p>In this post will take a quick look into the scenarios that would come across while we develop a windows phone app and how that could possibly(as there could be many other ways/approaches too) be implemented using MVVM. I would be covering shorter scenarios in this same post, and those that would be better off in a different one would be linked here . <a href="http://mvvmlight.codeplex.com/">MVVM Light</a> is a very popular toolkit that assists in getting started with MVVM quickly and we would also be using the same. This can be easily added in as a <a href="http://nuget.org/packages/mvvmLight">nuget package</a>
MVVM Light does come with a ViewModelBase class, that all your View Models are to inherit so that you do not have to worry about implementing the <a href="http://msdn.microsoft.com/en-in/library/system.componentmodel.inotifypropertychanged.aspx">INotifyPropertyChanged</a> interface. I would still think of having a intermediate view model base class specific to our app and have all the reusable piece of code that you want across your ViewModels.</p>

<p>Common MVVM scenarios that we come across while developing and probable approaches are discussed below. There might be different ways of achieving the same, and at times we might go off the ‘purist’  MVVM implementation,  i.e.  of not having a code behind at all. As for me I am ok to have code behind at a minimum if it is really required and does not affect the original intent of MVVM(separations of concerns, testability and reusability)</p>

<p><strong>Scenarios</strong></p>

<ol>
<li><p> Binding the View – ViewModel</p></li>
<li><p> ViewModel and Model</p></li>
<li><p> Basic Commanding</p></li>
<li><p> Advanced Commanding</p></li>
<li><p> Page Navigations and Parameters</p></li>
<li><p> Page Events</p></li>
<li><p> Application Bar<strong> </strong></p></li>
</ol>


<p>We will discuss each on in details and the sample that we would be using is that of a photo browser, for <a href="http://500px.com/">500px</a>. You can get the api access <a href="http://developers.500px.com/">here</a></p>

<p><strong>1. Binding the View-ViewModel</strong></p>

<p>MVVM Light comes default with a ViewModelLocator(<strong>VML</strong>) class that will help you with the binding of the ViewModels(<strong>VM’s</strong>) with the corresponding View. The VML will have public properties for the different view models that you have. You can either have different public properties for each of your view model here, or have a property for MainViewModel and then that would in turn have other ViewModel properties. The VML uses a SimpleIOC container to resolve type instances. In simple terms, with an IoC container all we are trying to solve is to minimize the dependency between different types/classes, so that we would never have to instantiate one class(complex type) in another. So whenever a instance of a class is required, the IoC container would generate it for us , and all we would be concerned would be of the interface that we require. For IoC to resolve types for us we need to register the interface and the original class that implements the interface.
Below you see how we are registering for the interface IDataService and setting its implementation class to DataService. Similarly we can also register classes, which would be how we would be registering our VM’s.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">SimpleIoc</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">IDataService</span><span class="p">,</span> <span class="n">DataService</span><span class="p">&gt;();</span>
</span><span class='line'><span class="n">SimpleIoc</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">MainViewModel</span><span class="p">&gt;();</span>
</span></code></pre></td></tr></table></div></figure>


<p>When installing the nuget package itself an instance of the VML is added into the app.xaml class, which can be used in all the View classes to data-bind to the VM.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;Application.Resources&gt;</span>
</span><span class='line'>       <span class="nt">&lt;ResourceDictionary&gt;</span>
</span><span class='line'>           <span class="c">&lt;!--Global View Model Locator--&gt;</span>
</span><span class='line'>           <span class="nt">&lt;vm:ViewModelLocator</span> <span class="na">x:Key=</span><span class="s">&quot;Locator&quot;</span>
</span><span class='line'>               <span class="na">d:IsDataSource=</span><span class="s">&quot;True&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'> .....
</span><span class='line'><span class="nt">&lt;Application.Resources&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This instance is used in all the view classes as below  in the xaml.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'>DataContext=&quot;{Binding Main, Source={StaticResource Locator}}&quot;
</span></code></pre></td></tr></table></div></figure>


<p>The Main property returns the View model that should be bound with the view. The ‘ServiceLocator.Current’, returns the default instance of the SimpleIoc. The GetInstance always returns the same instance of the ViewModel as if it would have for a Singleton. If you need a new instance then you would need to pass a specific key(any identifier value) to get a different instance.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="n">MainViewModel</span> <span class="n">Main</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">get</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">ServiceLocator</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">MainViewModel</span><span class="p">&gt;();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>What about the other Views and View Models?</strong></p>

<p>Mostly the main VM would be the one that would be like a hub page, from which the user be able to navigate onto other pages and detailed views., say from a list of friends to a friend, a list of photos to a specific photo. One common thing that we do wrong is to think of View – ViewModel as a one-to-one relationship, meaning one view will have only one ViewModel bound to it.  In our sample app we have a list of photos that needs to be displayed on the main page and on selecting one of the photo, we should be taken to the photo’s detail page. So the mistake to do here would be to have an observable list of Photos in the MainViewModel. We should rather have a list of PhotoViewModel , that would be bound to the list control in the main page. So the MainViewModel would have a property SelectedPhoto, which would be of PhotoViewModel type, that would become the data context of the PhotoDetail page.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'>DataContext=&quot;{Binding Main.SelectedPhoto, Source={StaticResource Locator}}&quot;
</span></code></pre></td></tr></table></div></figure>


<p>For views that are not at all related to each other, we can have separate properties in the VML, like say for Settings, About page.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'>DataContext=&quot;{Binding About, Source={StaticResource Locator}}&quot;
</span></code></pre></td></tr></table></div></figure>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="n">AboutViewModel</span> <span class="n">About</span>
</span><span class='line'> <span class="p">{</span>
</span><span class='line'>    <span class="k">get</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">ServiceLocator</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">AboutViewModel</span><span class="p">&gt;();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>So whenever you have hierarchical pages, it would mostly be that your parent/callee will have the ViewModel property that you would bind to like SelectedPhoto in MainViewModel and for cases you have separate navigations you can have a property exposed in VML like About, Main.</p>

<p><strong>2. ViewModel and Model</strong></p>

<p>Like I mentioned above, one common mistake that we make is to think of View-ViewModel as a one-to-one relationship and normally end up binding the UI to models and not VM’s. We soon tend to hit into problems, such as adding custom properties into models, not finding ways to trigger property changed etc. So it is always best to wrap your models in the VMs. In cases where you are sure you would never want to change/format the data format then you can directly bind to a model. In  cases where you would want to format the data (like say you have a First Name &amp; Last Name property on the model and you want to display Full Name)  you would rather wrap the data into a VM and bind that. You could always use <a href="http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx">ValueConverters</a>, to format the data specific to the UI, but that always comes with a price, especially on a phone device. Phone’s come with lesser hardware resource and you would want to make the maximum use of it. So it is better to have properties exposed on VM itself rather than having converters all over the UI to format the data. But still you would be in positions where you would absolutely want to use a converter where you should. That is a wise decision that one should make for yourself. (a <a href="https://groups.google.com/forum/?fromgroups#!topic/wpf-disciples/P-JwzRB_GE8">thread</a> that discusses on this )</p>

<p><strong>3. Basic Commanding</strong></p>

<p>It’s not just the data that gets displayed needs to be separated out cleanly. User actions and actions taken should also be cleanly separated from the UI. Commands is what would help us here. Commanding support is currently only for elements that inherit from <a href="http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.buttonbase.aspx">ButtonBase</a>. As in any mvvm implementation, mvvmlight also has a wrapper that implements <a href="http://msdn.microsoft.com/en-us/library/system.windows.input.icommand.aspx">ICommand</a> interface for us, which is RelayCommand. An instance of this can be directly bound to the Command property, for those elements that inherits from ButtonBase. Below is how you would wire up the command to a button on a page</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;Button</span> <span class="na">Content=</span><span class="s">&quot;My Command&quot;</span> <span class="na">Command=</span><span class="s">&quot;{Binding MyCommand}&quot;</span>
</span><span class='line'>    <span class="na">VerticalAlignment=</span><span class="s">&quot;Center&quot;</span> <span class="na">HorizontalAlignment=</span><span class="s">&quot;Center&quot;</span> <span class="nt">/&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="nf">MainViewModel</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">MyCommand</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RelayCommand</span><span class="p">(</span><span class="n">OnMyCommand</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">public</span> <span class="n">RelayCommand</span> <span class="n">MyCommand</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">OnMyCommand</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="n">MessageBox</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&quot;You clicked me :)&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>4. Advanced Commanding</strong></p>

<p>It’s not just UI elements that inherit from Buttonbase that we would be using, and hence we definitely need alternatives to bind events of such elements. ListBox SelectionChanged, Page loaded etc are very common events that one would be interested in while developing phone apps. There are a couple of approaches that one could follow here</p>

<ul>
<li><strong>Wire-up the command from code behind</strong></li>
</ul>


<p>We could  easily wire up all such events from the code-behind class, and have it invoked on the view model. Some might argue here that we are going off the MVVM pattern, which says ‘no code behind’. I don’t this it ever said that in the first place. It is just about decoupling the UI from the code and this is still done. Even binding/commanding is still going to generate code and do the wiring of commands. As long as there is a clear separation of logics and concerns we are good. So I think this this is very well acceptable and the easiest in fact of all the approaches.</p>

<p>Code Behind:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">private</span> <span class="n">MainViewModel</span> <span class="n">viewModel</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'> <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="n">DataContext</span> <span class="k">as</span> <span class="n">MainViewModel</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnNavigatedTo</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Navigation</span><span class="p">.</span><span class="n">NavigationEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="k">base</span><span class="p">.</span><span class="n">OnNavigatedTo</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
</span><span class='line'><span class="n">viewModel</span><span class="p">.</span><span class="n">OnnavigatedToCommand</span><span class="p">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">NavigationContext</span><span class="p">.</span><span class="n">QueryString</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>View Model</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="nf">MainViewModel</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">OnnavigatedToCommand</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RelayCommand</span><span class="p">&lt;</span><span class="n">IDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;(</span><span class="n">OnNavigatedTo</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">public</span> <span class="n">RelayCommand</span><span class="p">&lt;</span><span class="n">IDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;</span> <span class="n">OnnavigatedToCommand</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">OnNavigatedTo</span><span class="p">(</span><span class="n">IDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">parameters</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="c1">// do whatever you want to here</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li> <strong>EventToCommand Behavior</strong></li>
</ul>


<p>With the EventToCommand behavior introduced for Blend, can be used to bind an ICommand from the UI elements. Though it was introduced for Blend, it can be used independently. You would need to add a reference to System.Windows.Interactivity.dll, which is were all these behaviors are implemented. There is a detailed <a href="http://geekswithblogs.net/lbugnion/archive/2009/11/05/mvvm-light-toolkit-v3-alpha-2-eventtocommand-behavior.aspx">post</a> out here on to how to use EventToCommand to trigger commands directly from the UI.</p>

<p>Just to keep a sample here, below would be how it would look like</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'>xmlns:i=&quot;clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity&quot;
</span><span class='line'>xmlns:command=&quot;clr-namespace:GalaSoft.MvvmLight.Command;assembly=GalaSoft.MvvmLight.Extras.WP71&quot;
</span><span class='line'>...
</span><span class='line'><span class="nt">&lt;ListBox&gt;</span>
</span><span class='line'><span class="nt">&lt;i:Interaction.Triggers&gt;</span>
</span><span class='line'><span class="nt">&lt;i:EventTrigger</span> <span class="na">EventName=</span><span class="s">&quot;SelectionChanged&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;command:EventToCommand</span> <span class="na">Command=</span><span class="s">&quot;{Binding SelectionChangedCommand}&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/i:EventTrigger&gt;</span>
</span><span class='line'><span class="nt">&lt;/i:Interaction.Triggers&gt;</span>
</span><span class='line'><span class="nt">&lt;ListBox.Items&gt;</span>
</span><span class='line'><span class="nt">&lt;ListBoxItem&gt;</span>Item1<span class="nt">&lt;/ListBoxItem&gt;</span>
</span><span class='line'><span class="nt">&lt;ListBoxItem&gt;</span>Item2<span class="nt">&lt;/ListBoxItem&gt;</span>
</span><span class='line'><span class="nt">&lt;ListBoxItem&gt;</span>Item3<span class="nt">&lt;/ListBoxItem&gt;</span>
</span><span class='line'><span class="nt">&lt;/ListBox.Items&gt;</span>
</span><span class='line'><span class="nt">&lt;/ListBox&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="nf">MainViewModel</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">SelectionChangedCommand</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RelayCommand</span><span class="p">(</span><span class="n">OnSelectionChangedCommand</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">public</span> <span class="n">RelayCommand</span> <span class="n">SelectionChangedCommand</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">OnSelectionChangedCommand</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="c1">// do whatever you want to here</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><strong>Messenger</strong></li>
</ul>


<p>We could also use a messenger service, to propogate UI events to VM’s. MVVMLight  has a built in messenger service that can be used for this. In simple terms a messenger is nothing but a decoupled eventing system, something of a publisher-subscriber model. In the messenger one entity  would send a message and there would be another entity that listens for this message and acts upon it.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">Selector_OnSelectionChanged</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">SelectionChangedEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">Messenger</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">Send</span><span class="p">&lt;</span><span class="n">NotificationMessage</span><span class="p">&gt;(</span>
</span><span class='line'>        <span class="k">new</span> <span class="nf">NotificationMessage</span><span class="p">(</span><span class="s">&quot;You could have your own items here by using a generic NotificationMessage&lt;&gt;&quot;</span><span class="p">));</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="err">…</span>
</span><span class='line'>
</span><span class='line'><span class="k">public</span> <span class="nf">MainViewModel</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">MessengerInstance</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">NotificationMessage</span><span class="p">&gt;(</span><span class="k">this</span><span class="p">,</span> <span class="n">OnSelectionChanged</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">OnSelectionChanged</span><span class="p">(</span><span class="n">NotificationMessage</span> <span class="n">message</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="c1">// do whatever you want to here</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>As you see above, in the code behind we send a Notification message indicating a click has happened. In the VM we register for the notification message and act upon it. We could send generic objects via the notification message and also create our own messages by inheriting from MessageBase of mvvmlight. This <a href="http://msdn.microsoft.com/en-us/magazine/jj694937.aspx">article</a> gives more information and scenarios around this</p>

<p>We are still left with a lot more scenarios to cover here and I would be covering them in a separate post to keep this one &lsquo;short&rsquo; :)</p>

<p><strong>Edit</strong>: Check out <a href="http://rahulpnath.com/blog/mvvm-a-windows-phone-scenario-part-2/">MVVM – A Windows Phone Scenario – Part 2</a> for the rest of the scenarios</p>

<p> </p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-capitalize">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-04-17T16:34:01+05:30"  data-updated="true" itemprop="datePublished dateCreated">Apr 17<sup>th</sup>, 2013</time>
        

<span class="glyphicon glyphicon-tags"></span>&nbsp; Posted in&nbsp; 
<span class="categories">
  
    <a class='category' href='/blog/category/dot-net/'>.net</a>, <a class='category' href='/blog/category/windows-phone/'>windows phone</a>, <a class='category' href='/blog/category/wp7/'>wp7</a>
  
</span>


        
      </p>
    
    
      <h1 class="entry-title" itemprop="name headline"><a href="/blog/windows-phone-series-mvvm-and-applicationbar/" itemprop="url">Windows Phone Series – MVVM and ApplicationBar</a></h1>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>ApplicationBar on a windows phone, is to provide users of your app with quick access to the most commonly used tasks. For a mail app this would be refresh/new mail, for a photo app it might be like/unlike button, settings etc are common buttons that appear in an ApplicationBar . But then not always do we have them as static, and we would want to add/remove icons/menu items to that based on the applications current state.For example, you would want to add the like/unlike button only if the user is logged in, or even the settings icon would be only for logged in users. Whatever might be your scenario, if you are looking for to add/remove icons from the application bar from your code then this article is for you.</p>

<p>In a normal app which uses code-behind, this can be easily done by accessing the ‘ApplicationBar’ in the code-behind class like below</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">ApplicationBar</span><span class="p">.</span><span class="n">Buttons</span><span class="p">.</span><span class="n">Add</span><span class="p">(&lt;</span><span class="n">your</span> <span class="n">button</span><span class="p">&gt;);</span>
</span></code></pre></td></tr></table></div></figure>


<p>When you are using MVVM you would want to do this from your ViewModel(VM). Below are the approaches that you could use to achieve the same</p>

<p><strong>1. Mesenger Service</strong></p>

<p>Whenever we need to communicate between VM’s or between your view model and View then we would want to do that in the most decoupled manner. When using <a href="http://www.galasoft.ch/mvvm/">MVVMLight</a>, we could use the Messenger class to achieve this. We would send a message indicating that we want to add a new appbar button from the ViewModel, and the View code behind, which already has registered for such an event would get notified and add the icon for us .</p>

<p>Below is how the Code-behind would look like . We register for a NotificationMessage(you could also use your own notification class for this), and see what kind of button needs to be added and adds that to the ApplicationBar. On click of the appbar button, we wire up the click event to a command of the ViewModel. Though there is some code behind in here, we are not going away from MVVM here, as we still have clear separation of concerns and also testability is not affected.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">MainPage</span> <span class="p">:</span> <span class="n">PhoneApplicationPage</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="n">MainViewModel</span> <span class="n">viewModel</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">get</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="n">DataContext</span> <span class="k">as</span> <span class="n">MainViewModel</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="n">ApplicationBarIconButton</span> <span class="n">settingsButton</span><span class="p">;</span>
</span><span class='line'>    <span class="c1">// Constructor</span>
</span><span class='line'>    <span class="k">public</span> <span class="nf">MainPage</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">InitializeComponent</span><span class="p">();</span>
</span><span class='line'>        <span class="n">settingsButton</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ApplicationBarIconButton</span><span class="p">()</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">Text</span> <span class="p">=</span> <span class="s">&quot;Settings&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="n">IconUri</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span><span class="p">(</span><span class="s">&quot;Images/appbar.feature.settings.rest.png&quot;</span><span class="p">,</span> <span class="n">UriKind</span><span class="p">.</span><span class="n">Relative</span><span class="p">)</span>
</span><span class='line'>        <span class="p">};</span>
</span><span class='line'>        <span class="n">settingsButton</span><span class="p">.</span><span class="n">Click</span> <span class="p">+=</span> <span class="n">settingsButton_Click</span><span class="p">;</span>
</span><span class='line'>        <span class="c1">// Register for the messenger </span>
</span><span class='line'>        <span class="n">Messenger</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">NotificationMessage</span><span class="p">&gt;(</span><span class="k">this</span><span class="p">,</span> <span class="n">OnNotificationMessage</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">void</span> <span class="nf">settingsButton_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">viewModel</span><span class="p">.</span><span class="n">SettingsCommand</span><span class="p">.</span><span class="n">Execute</span><span class="p">(</span><span class="k">null</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnNotificationMessage</span><span class="p">(</span><span class="n">NotificationMessage</span> <span class="n">message</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="c1">// Check here for the notification</span>
</span><span class='line'>        <span class="c1">// You can also build cutoms notification message here for this by inheriting from MessageBase</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">Notification</span> <span class="p">==</span> <span class="s">&quot;AddSettings&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">ApplicationBar</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">ApplicationBar</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ApplicationBar</span><span class="p">();</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="n">ApplicationBar</span><span class="p">.</span><span class="n">Buttons</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">settingsButton</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<hr />

<p><strong>2. ApplicationBar Service</strong></p>

<p>Like we use <a href="http://www.geekchamp.com/articles/mvvm-in-real-life-windows-phone-applications-part2">NavigationService</a>, for navigating from VM’s we could also create a ApplicationBarService, that can be used to add application bar icons from ViewModels. For this I have created a base class, MyModelBase, for all my VM’s which inturn inherits from ViewModelBase of MVVMLight. This base class holds an interface for the ApplicationBarService.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">MyModelBase</span><span class="p">:</span> <span class="n">ViewModelBase</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="n">IApplicationBarService</span> <span class="n">ApplicationBar</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="nf">MyModelBase</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="nf">MyModelBase</span><span class="p">(</span><span class="n">IApplicationBarService</span> <span class="n">appBar</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">ApplicationBar</span> <span class="p">=</span> <span class="n">appBar</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The interface IApplicationBarService, would have the functions that we would want to Add/Remove icons from the application bar. For now I have just put in the AddButton. You could also add RemoveButton and any other things that you would want in there.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">interface</span> <span class="n">IApplicationBarService</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">IApplicationBar</span> <span class="n">ApplicationBar</span> <span class="p">{</span> <span class="k">get</span><span class="p">;}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">void</span> <span class="nf">AddButton</span><span class="p">(</span><span class="kt">string</span> <span class="n">title</span><span class="p">,</span> <span class="n">Uri</span> <span class="n">imageUrl</span><span class="p">,</span> <span class="n">Action</span> <span class="n">OnClick</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Implementation for this interface is as below</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">ApplicationBarService</span><span class="p">:</span> <span class="n">IApplicationBarService</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">void</span> <span class="nf">AddButton</span><span class="p">(</span><span class="kt">string</span> <span class="n">title</span><span class="p">,</span> <span class="n">Uri</span> <span class="n">imageUrl</span><span class="p">,</span> <span class="n">Action</span> <span class="n">OnClick</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">ApplicationBarIconButton</span> <span class="n">newButton</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ApplicationBarIconButton</span><span class="p">()</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">Text</span> <span class="p">=</span> <span class="n">title</span><span class="p">,</span>
</span><span class='line'>                <span class="n">IconUri</span> <span class="p">=</span> <span class="n">imageUrl</span><span class="p">,</span>
</span><span class='line'>            <span class="p">};</span>
</span><span class='line'>        <span class="n">newButton</span><span class="p">.</span><span class="n">Click</span> <span class="p">+=</span> <span class="p">((</span><span class="n">sender</span><span class="p">,</span><span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span><span class="n">OnClick</span><span class="p">.</span><span class="n">Invoke</span><span class="p">();})</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">ApplicationBar</span><span class="p">.</span><span class="n">Buttons</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">newButton</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="n">IApplicationBar</span> <span class="n">ApplicationBar</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">get</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">currentPage</span> <span class="p">=</span> <span class="p">((</span><span class="n">App</span><span class="p">)</span><span class="n">Application</span><span class="p">.</span><span class="n">Current</span><span class="p">).</span><span class="n">RootFrame</span><span class="p">.</span><span class="n">Content</span> <span class="k">as</span> <span class="n">PhoneApplicationPage</span><span class="p">;</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">currentPage</span><span class="p">.</span><span class="n">ApplicationBar</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">currentPage</span><span class="p">.</span><span class="n">ApplicationBar</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ApplicationBar</span><span class="p">();</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">currentPage</span><span class="p">.</span><span class="n">ApplicationBar</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The ApplicationBar property reads gets the current ApplicationBar from the current page. If it is not defined then it would simply create a new one. The Add function just adds a new button and wires up the click event of the button, to the function that is passed in by the VM. We could also use Commands here, for now I just wanted to keep it simple</p>

<p>In cases where you don’t want to add buttons dynamically, but just have static buttons you could also use BindableApplicationBar implementations that are there. One such implementation is there along with the <a href="http://phone7.codeplex.com/">Phone7.Fx</a> library. There are also many other implementations for the same.</p>

<p>Hope this helps you to decouple your application bar icons from the ViewModel.You can find a <a href="https://github.com/rahulpnath/Blog/tree/master/PhoneAppBarMvvm">sample</a> implementation for this. In the sample both these approaches are shown for adding icons. You could figure out the Remove pretty easily.</p>

<p><img src="/images/wp_applicationbar_icon_mvvm.png" alt="windows phone applicationbar mvvm" /></p>

<p>Hope it helps!!</p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-capitalize">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-04-12T13:10:46+05:30"  data-updated="true" itemprop="datePublished dateCreated">Apr 12<sup>th</sup>, 2013</time>
        

<span class="glyphicon glyphicon-tags"></span>&nbsp; Posted in&nbsp; 
<span class="categories">
  
    <a class='category' href='/blog/category/dot-net/'>.net</a>, <a class='category' href='/blog/category/windows-phone/'>windows phone</a>, <a class='category' href='/blog/category/wp7/'>wp7</a>
  
</span>


        
      </p>
    
    
      <h1 class="entry-title" itemprop="name headline"><a href="/blog/windows-phone-series-preloading-content/" itemprop="url">Windows Phone Series – Preloading Content</a></h1>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>Mostly phone apps, connect to a service for the data and wrap them up to a cool UI for user consumption. But at times we would have apps that comes with a lot of preloaded content, with offline capability using <a href="http://visualstudiogallery.msdn.microsoft.com/cd120b42-30f4-446e-8287-45387a4f40b7">sqlite</a>.  Offline scenarios might either start of with preloaded content or get content on the apps first launch. This article is more for the scenario where we have preloaded content bundled with the app, and then on launch of the app, it would also get new content and updates to existing content. Complete knowledge of the pre-loaded content at the time of development would be rare. All you would know would be the metadata schema and how/where to look for the preloaded content.</p>

<p>We would not be creating a fully functional sample here, but would be touching on important aspects and the approaches that can be used to tackle similar scenarios and some code snippets</p>

<p>This <a href="http://blogs.windows.com/windows_phone/b/wpdev/archive/2013/03/12/using-the-sqlite-database-engine-with-windows-phone-8-apps.aspx">article</a> here would help you out on setting up sqlite for windows phone apps. Mostly we would be storing metadata of files/media that gets preloaded in the sqlite and keep the original files/media(preloaded content) packaged along with the xap, ideally by setting the <a href="http://msdn.microsoft.com/en-in/library/windowsphone/develop/ff967560(v=vs.105).aspx#BKMK_Media">Build Action to Content</a>.  Now in cases where we are expecting to update the existing content and also get new content we would have to copy out the entire media/files into the IsolatedStorage, so that we can do any further updates or additions.</p>

<p>Assuming that we have a folder “MyPreloadedContent” as indicated in the image below, which would be where all our preloaded content is going to be . Most of the time with preloaded content, we would not know what exact data would be in there. It might contain files, images, folders etc. We would want an easy way to set Build Action to Content for all the files/folders that gets placed under the folder( even if it is done outside of Visual Studio).</p>

<p><img src="/images/preloaded_content_Visual_studio.png" alt="preloaded content Visual studio" /></p>

<p>For this we would need to tweek the project file, to tell it that whatever is under MyPreloadedContent should be treated as ‘Content’. Edit the csproj file from notepad or any other text editor that you use(<a href="http://notepad-plus-plus.org/">Notepad++</a> is my personal favorite). Scroll down to wherever the other Content files are specified, like “<Content Include="ApplicationIcon.png">” for example. Add in the below line to make all the content put into that folder to be treated as Content, and save the csproj file.</p>

<pre><code>&lt;strong&gt;&lt;span style="font-size:large;"&gt;&lt;Content Include="MyPreloadedContent**" /&gt;&lt;/span&gt;&lt;/strong&gt;
</code></pre>

<p>Now you could open that folder and put in some content into that. For now I put in some image files and also a sub folder  as below</p>

<p><img src="/images/preloaded_content_explorer.png" alt="preloaded content explorer" /></p>

<p>You would need to reload the projects/solution in visual studio to see that those files are automatically included into the solution. If not in a Visual studio,  msbuild would automatically include all the files as Content.</p>

<p><img src="/images/preloaded_content_vs_refresh.png" alt="preloaded content visual studio refresh" /></p>

<p>Now that we have all the files copied into that folder to be automatically included into the solution you need to now need to copy out all these files onto the IsolatedStorage when the app starts for the first time. You would want to do this, so that if there are any updates onto the files that you copied(which would be delivered to you via a web service in a real scenario), you can overwrite the files in the IsolatedStorage so that the new content would be taken then on.</p>

<p>Now comes the next challenge of getting all the files that are under MyPreloadedContent folder, so that you can copy them over to IsolatedStorage. Since this files would be copied at a later point of time, say at the time of packaging, we would not be able to know all the file names and directory structure prior.</p>

<p>We can use <a href="http://msdn.microsoft.com/en-us/library/vstudio/bb126445.aspx">T4 ( Text Templating Transformation Toolkit) templates</a> to help us out here. Using T4 templates we can generate a class file that will have a property returning us all the file names in the MyPreloadedContent directory.</p>

<p>To create a T4 template, add a new item to the project <strong>MyFiles.tt. </strong>Select Ok if you get any warning message</p>

<p><img src="/images/preloaded_content_t4_template.jpg" alt="preloaded content t4 template" /></p>

<p>In a T4 template it would be a mix of text and code, that would be used to generate a new file that would be a class in our case which would expose a function to get all the file names under the folder . Below is the entire text/code that would go into the new file that we just created(<strong>MyFiles.tt</strong>)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="p">&lt;</span><span class="err">#@</span> <span class="n">template</span> <span class="n">debug</span><span class="p">=</span><span class="s">&quot;false&quot;</span> <span class="n">hostspecific</span><span class="p">=</span><span class="s">&quot;true&quot;</span> <span class="n">language</span><span class="p">=</span><span class="s">&quot;C#&quot;</span> <span class="err">#</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">&lt;</span><span class="err">#@</span> <span class="n">output</span> <span class="n">extension</span><span class="p">=</span><span class="s">&quot;.gen.cs&quot;</span> <span class="err">#</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">&lt;</span><span class="err">#@</span> <span class="n">import</span> <span class="n">namespace</span><span class="p">=</span><span class="s">&quot;System.IO&quot;</span><span class="err">#</span><span class="p">&gt;</span>
</span><span class='line'><span class="c1">// &lt;auto-generated /&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="k">namespace</span> <span class="nn">PreloadedContent</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">class</span> <span class="nc">MyFiles</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">private</span> <span class="k">static</span> <span class="kt">string</span><span class="p">[]</span> <span class="nf">MyPreloadedContentFiles</span><span class="p">()</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">new</span><span class="p">[]</span> <span class="p">{</span>
</span><span class='line'><span class="p">&lt;</span><span class="err">#</span>
</span><span class='line'>            <span class="n">DirectoryInfo</span> <span class="n">directoryInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DirectoryInfo</span><span class="p">(</span>
</span><span class='line'>               <span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span><span class="n">Path</span><span class="p">.</span><span class="n">GetDirectoryName</span><span class="p">(</span><span class="n">Host</span><span class="p">.</span><span class="n">TemplateFile</span><span class="p">),</span><span class="s">&quot;MyPreloadedContent&quot;</span><span class="p">));</span>
</span><span class='line'>        <span class="k">foreach</span><span class="p">(</span><span class="n">FileInfo</span> <span class="n">file</span> <span class="k">in</span> <span class="n">directoryInfo</span><span class="p">.</span><span class="n">GetFiles</span><span class="p">(</span><span class="s">&quot;*.*&quot;</span><span class="p">,</span> <span class="n">SearchOption</span><span class="p">.</span><span class="n">AllDirectories</span><span class="p">))</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="k">if</span> <span class="p">(!</span><span class="n">file</span><span class="p">.</span><span class="n">FullName</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="s">@&quot;.&quot;</span><span class="p">))</span>
</span><span class='line'>                <span class="p">{</span><span class="err">#</span><span class="p">&gt;</span>
</span><span class='line'>                      <span class="s">&quot;&lt;#= file.FullName.Substring(</span>
</span><span class='line'>                      <span class="n">file</span><span class="p">.</span><span class="n">FullName</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="s">&quot;MyPreloadedContent&quot;</span><span class="p">)).</span><span class="n">Replace</span><span class="p">(</span><span class="s">@&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;/&quot;</span><span class="p">)</span> <span class="err">#</span><span class="p">&gt;</span><span class="s">&quot;,</span>
</span><span class='line'><span class="p">&lt;</span><span class="err">#</span>              <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'><span class="err">#</span><span class="p">&gt;</span>
</span><span class='line'>                        <span class="p">};</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>It just says to read the directory MyPreloadedContent and iterate to get all the files in that and writes it out by trimming of the absolute path and putting in only the relative path. Save the MyFiles.tt, and in Visual Studio right click on it and say “Run Custom Tool”. This would generate the cs file with an extension “.gen.cs” as we have mentioned in “<strong>&lt;#@ output extension=&ldquo;.gen.cs&rdquo; #>”.  </strong>The generated class would look like below</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">namespace</span> <span class="nn">PreloadedContent</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">class</span> <span class="nc">MyFiles</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">private</span> <span class="k">static</span> <span class="kt">string</span><span class="p">[]</span> <span class="nf">MyPreloadedContentFiles</span><span class="p">()</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">new</span><span class="p">[]</span> <span class="p">{</span>
</span><span class='line'>                           <span class="s">&quot;MyPreloadedContent/picfinity login.png&quot;</span><span class="p">,</span>
</span><span class='line'>                           <span class="s">&quot;MyPreloadedContent/Search.png&quot;</span><span class="p">,</span>
</span><span class='line'>                           <span class="s">&quot;MyPreloadedContent/Share.png&quot;</span><span class="p">,</span>
</span><span class='line'>                           <span class="s">&quot;MyPreloadedContent/upload.png&quot;</span><span class="p">,</span>
</span><span class='line'>                           <span class="s">&quot;MyPreloadedContent/Profile/profile info.png&quot;</span><span class="p">,</span>
</span><span class='line'>                           <span class="s">&quot;MyPreloadedContent/Profile/Profile.png&quot;</span><span class="p">,</span>
</span><span class='line'>                        <span class="p">};</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The above class has all the file paths to the content and you could iterate that to copy out the files into the IsolatedStorage.</p>

<p>There are a couple of ways, by which you can ensure that the template file is run before the actual code gets compiled. This is to make sure that this generated class is going to be updated with the latest files that would be copied into the folder at build time i.e your templates are transformed at build time. This <a href="http://msdn.microsoft.com/en-us/library/ee847423.aspx">article</a> details out the methods to get that integrated into the build. On a build server where you dont have Visual Studio installed you would need to copy out these files mentioned <a href="http://msdn.microsoft.com/en-us/library/ee847423.aspx#buildserver">here</a> explicitly</p>

<p>With that integrated you are all set to go to build your app with preloaded content. You would not need to know anything about the file names/ structure of the content and it would just work as long as the metadata that drives it correct.</p>

<p>Hope it helps!!</p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-capitalize">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-04-08T10:42:07+05:30"  data-updated="true" itemprop="datePublished dateCreated">Apr 8<sup>th</sup>, 2013</time>
        

<span class="glyphicon glyphicon-tags"></span>&nbsp; Posted in&nbsp; 
<span class="categories">
  
    <a class='category' href='/blog/category/dot-net/'>.net</a>, <a class='category' href='/blog/category/thoughts/'>thoughts</a>, <a class='category' href='/blog/category/windows-8/'>windows 8</a>, <a class='category' href='/blog/category/windows-phone/'>windows phone</a>, <a class='category' href='/blog/category/wp7/'>wp7</a>, <a class='category' href='/blog/category/wpf/'>wpf</a>
  
</span>


        
      </p>
    
    
      <h1 class="entry-title" itemprop="name headline"><a href="/blog/mvvm-does-it-really-matter/" itemprop="url">MVVM – Does it really matter?</a></h1>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>MVVM (Model-View-ViewModel), is a popular architectural pattern since WPF/Silverlight. Separation of concerns(UI/code), testability etc are some of the key things that motivates one to go via the MVVM route. There are innumerous articles out there, just like this <a href="http://msdn.microsoft.com/en-in/library/hh848246.aspx">one</a>, that gets into the details of how and why one should use MVVM.</p>

<p>With Windows phone also embracing xaml and silverlight, any one who knew silverlight turned a phone developer overnight. MVVM did find its way into this space too. But most of the phone app developers, unlike those who developed for enterprise. would have never cared for MVVM , as they rarely would have written test cases for their apps, nor were they actually concerned on the UI/code separation. Since most of the apps were just out of a hobby, the only idea was just to have it up and available in the store as fast as possible. I might not be fully correct here, but I do know at least a dozen people,including me, who did this, so am good enough to put out that statement</p>

<p>With windows 8 too taking the store way and having the same development platform of silverlight/xaml, don’t be surprised MVVM  showed up there too. Now anyone who had an app on the phone, had to do a lot of copy pasting over the code to have the same application available in both the stores. This gives MVVM a totally new dimension for motivation that was not spoken  about earlier – <strong><em>Reusability. </em></strong></p>

<p>Having an application for phone and windows 8 app store with the minimum amount of rework is best possible by using MVVM and also a couple of other techniques. There is a detailed <a href="http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj681693(v=vs.105">article</a>.aspx) on msdn on how how to maximize code reuse between Windows Phone 8 and Windows 8.</p>

<p>MVVM does really matter now, if we do not want to end up copy pasting code from phone app to the windows 8 store app. Also fixing and adding in new features would become more easier with following MVVM</p>

<p><a href="http://nuget.org/packages/Portable.MvvmLightLibs/">MVVM Toolkit</a> is a very popular helper library for implementing MVVM pattern, as is available on nuget as a PCL(Portable class library)</p>

<p><strong>MVVM<em>, It really does matter !!!</em></strong></p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-capitalize">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-03-03T14:23:45+05:30"  data-updated="true" itemprop="datePublished dateCreated">Mar 3<sup>rd</sup>, 2013</time>
        

<span class="glyphicon glyphicon-tags"></span>&nbsp; Posted in&nbsp; 
<span class="categories">
  
    <a class='category' href='/blog/category/dot-net/'>.net</a>, <a class='category' href='/blog/category/windows-phone/'>windows phone</a>, <a class='category' href='/blog/category/wp7/'>wp7</a>
  
</span>


        
      </p>
    
    
      <h1 class="entry-title" itemprop="name headline"><a href="/blog/windows-phone-series-incremental-loading/" itemprop="url">Windows Phone Series – Incremental Loading</a></h1>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>Some time back we had a look on doing <a href="http://rahulpnath.wordpress.com/2012/10/28/windows-8-series-incremental-loading/">Incremental Loading with a Windows 8 store app</a>. This same scenario is something that one would come across quite frequently while developing a Windows Phone application too. We have a couple of options in dealing with this while on a Windows phone application. In an ideal case while binding to a large data on a windows phone application, we might be using a <a href="http://msdn.microsoft.com/en-US/library/windowsphone/develop/microsoft.phone.controls.longlistselector(v=vs.105">LongListSelector</a>.aspx) or a Listbox control.</p>

<p>While using a LongListSelector, we can use the Link event(if you are using <a href="http://phone.codeplex.com/">Windows Phone 7.1 toolkit</a>) Or the <a href="http://msdn.microsoft.com/en-US/library/windowsphone/develop/microsoft.phone.controls.longlistselector.itemrealized(v=vs.105">ItemRealized</a>.aspx) event(if you are on Windows phone 8.0). Basically we would be doing the same thing in either of these cases, checking the current item that is getting realized and see what is the index of the item in the whole list of data that you have currently and check if its time for you to fetch the next set of data from your data source(possibly a web service). As usual for the sample we will be using the <a href="http://500px.com/popular">500px</a> api.</p>

<p>Below is the piece of code that will fetch us the photo from the <a href="http://developers.500px.com/">500px api</a> to populate the listbox data.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">private</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">requestPerPage</span> <span class="p">=</span> <span class="m">20</span><span class="p">;</span>
</span><span class='line'><span class="k">private</span> <span class="kt">int</span> <span class="n">currentPage</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'><span class="k">private</span> <span class="kt">bool</span> <span class="n">isCurrentlyLoading</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">private</span> <span class="n">ObservableCollection</span><span class="p">&lt;</span><span class="n">Photo</span><span class="p">&gt;</span> <span class="n">Photos</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ObservableCollection</span><span class="p">&lt;</span><span class="n">Photo</span><span class="p">&gt;();</span>
</span><span class='line'>
</span><span class='line'><span class="k">private</span> <span class="kt">string</span> <span class="n">datasourceUrl</span><span class="p">=</span><span class="s">&quot;https://api.500px.com/v1/photos?feature=popular&amp;consumer_key=&quot;</span>
</span><span class='line'>          <span class="p">+</span> <span class="n">consumerKey</span> <span class="p">+</span> <span class="s">&quot;&amp;rpp=&quot;</span> <span class="p">+</span> <span class="n">requestPerPage</span><span class="p">.</span><span class="n">ToString</span><span class="p">()</span> <span class="p">+</span> <span class="s">&quot;&amp;page={0}&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">LoadDataFromSource</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">isCurrentlyLoading</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">var</span> <span class="n">query</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">datasourceUrl</span><span class="p">,</span> <span class="n">currentPage</span><span class="p">);</span>
</span><span class='line'>    <span class="n">WebClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WebClient</span><span class="p">();</span>
</span><span class='line'>    <span class="n">client</span><span class="p">.</span><span class="n">DownloadStringCompleted</span> <span class="p">+=</span> <span class="n">client_DownloadStringCompleted</span><span class="p">;</span>
</span><span class='line'>    <span class="n">client</span><span class="p">.</span><span class="n">DownloadStringAsync</span><span class="p">(</span><span class="k">new</span> <span class="n">Uri</span><span class="p">(</span><span class="n">query</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">void</span> <span class="nf">client_DownloadStringCompleted</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">DownloadStringCompletedEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MemoryStream</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Unicode</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Result</span><span class="p">)))</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="kt">var</span> <span class="n">ser</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DataContractJsonSerializer</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">RootObject</span><span class="p">));</span>
</span><span class='line'>        <span class="n">RootObject</span> <span class="n">obj</span> <span class="p">=</span> <span class="p">(</span><span class="n">RootObject</span><span class="p">)</span><span class="n">ser</span><span class="p">.</span><span class="n">ReadObject</span><span class="p">(</span><span class="n">reader</span><span class="p">);</span>
</span><span class='line'>        <span class="n">currentPage</span> <span class="p">=</span> <span class="n">obj</span><span class="p">.</span><span class="n">current_page</span> <span class="p">+</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">obj</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">this</span><span class="p">.</span><span class="n">Dispatcher</span><span class="p">.</span><span class="n">BeginInvoke</span><span class="p">(()</span> <span class="p">=&gt;</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">photo</span> <span class="k">in</span> <span class="n">obj</span><span class="p">.</span><span class="n">photos</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="n">Photos</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">photo</span><span class="p">);</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                    <span class="n">isCurrentlyLoading</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>                <span class="p">});</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the ItemRealized/Link event based on whether you are developing for Windows Phone 7 or 8, below would be the code that goes into that. We need to check the current item that is realized i.e rendered on the UI and see if it is</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">photosList_ItemRealized_1</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">ItemRealizationEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">Photo</span> <span class="n">photo</span> <span class="p">=</span> <span class="n">e</span><span class="p">.</span><span class="n">Container</span><span class="p">.</span><span class="n">Content</span> <span class="k">as</span> <span class="n">Photo</span><span class="p">;</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">photo</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="kt">int</span> <span class="n">offset</span> <span class="p">=</span> <span class="m">2</span><span class="p">;</span>
</span><span class='line'>        <span class="c1">// Only if there is no data that is currently getting loaded</span>
</span><span class='line'>        <span class="c1">// would be initiate the loading again</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(!</span><span class="n">isCurrentlyLoading</span> <span class="p">&amp;&amp;</span> <span class="n">Photos</span><span class="p">.</span><span class="n">Count</span> <span class="p">-</span> <span class="n">Photos</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="n">photo</span><span class="p">)</span> <span class="p">&lt;=</span> <span class="n">offset</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">LoadDataFromSource</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>In case you want to use a normal listbox, you can do that also. We would need to hook up with VisualStateGroups. This <a href="http://blogs.msdn.com/b/slmperf/archive/2011/06/30/windows-phone-mango-change-listbox-how-to-detect-compression-end-of-scroll-states.aspx">link</a> explains this in details, and I have just reused parts of it as is. We need to override the scrollviewer style to hook into this new StateGroups. We need to look for CompressionBottom state, for the currentstatechanged event of the scrollviewer.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">myScrollViewer_Loaded_1</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">SetScrollViewer</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">SetScrollViewer</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c1">// Visual States are always on the first child of the control template </span>
</span><span class='line'>    <span class="n">FrameworkElement</span> <span class="n">element</span> <span class="p">=</span> <span class="n">VisualTreeHelper</span><span class="p">.</span><span class="n">GetChild</span><span class="p">(</span><span class="n">myScrollViewer</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'>                            <span class="k">as</span> <span class="n">FrameworkElement</span><span class="p">;</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">element</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">VisualStateGroup</span> <span class="n">vgroup</span> <span class="p">=</span> <span class="n">FindVisualState</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s">&quot;VerticalCompression&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">vgroup</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">vgroup</span><span class="p">.</span><span class="n">CurrentStateChanging</span> <span class="p">+=</span>
</span><span class='line'>                 <span class="k">new</span> <span class="n">EventHandler</span><span class="p">&lt;</span><span class="n">VisualStateChangedEventArgs</span><span class="p">&gt;(</span><span class="n">vgroup_CurrentStateChanging</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">vgroup_CurrentStateChanging</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">VisualStateChangedEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">NewState</span><span class="p">.</span><span class="n">Name</span> <span class="p">==</span> <span class="s">&quot;CompressionTop&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">NewState</span><span class="p">.</span><span class="n">Name</span> <span class="p">==</span> <span class="s">&quot;CompressionBottom&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(!</span><span class="n">isCurrentlyLoading</span> <span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">LoadDataFromSource</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">NewState</span><span class="p">.</span><span class="n">Name</span> <span class="p">==</span> <span class="s">&quot;NoVerticalCompression&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can use either of these two ways to incrementally load data on a windows phone app. The entire code that is used in this blog is avaialble <a href="https://github.com/rahulpnath/IncrementalLoadingPhone">here</a>. The sample app shows both these methods. The pivot header specifies the method that is used, LongListSelector and Scrollstates</p>

<p><img src="/images/wp_incremental_loading_longlistselector.jpg" alt="windows phone incremental loading using longlistselector" /><img src="/images/wp_incremental_loading_scrollstates.jpg" alt="windows phone incremental loading using scrollstates" /></p>

<p>Hope this helps you to incrementally load data on your windows phone application</p>

<p><a href="https://github.com/rahulpnath/IncrementalLoadingPhone">Download Code</a></p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-capitalize">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-01-05T22:07:00+05:30"  data-updated="true" itemprop="datePublished dateCreated">Jan 5<sup>th</sup>, 2013</time>
        

<span class="glyphicon glyphicon-tags"></span>&nbsp; Posted in&nbsp; 
<span class="categories">
  
    <a class='category' href='/blog/category/gadgets/'>gadgets</a>, <a class='category' href='/blog/category/photography/'>photography</a>, <a class='category' href='/blog/category/reviews/'>reviews</a>
  
</span>


        
      </p>
    
    
      <h1 class="entry-title" itemprop="name headline"><a href="/blog/what-made-me-choose-vanguard-up-rise-45/" itemprop="url">What made me choose : Vanguard UP-Rise 45</a></h1>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>Deciding on a dslr was not so tough a year back, it was either Canon or Nikon and it just happened that i chose Canon since in the beginner level series neither seemed to make a difference, at least for me. I have a <a href="http://www.amazon.co.uk/Canon-550D-Digital-Camera-Body/dp/B0037KM0EY">Canon 550d</a> with a set of beginner level lenses (a <a href="http://www.amazon.com/Canon-EF-S-18-55mm-3-5-5-6-II/dp/B000V5K3FG/ref=sr_1_1?s=electronics&amp;ie=UTF8&amp;qid=1357390070&amp;sr=1-1&amp;keywords=canon+18-55">18-55mm</a> kit lens, <a href="http://www.amazon.com/Canon-50mm-1-8-Camera-Lens/dp/B00007E7JU/ref=sr_1_1?s=electronics&amp;ie=UTF8&amp;qid=1357390018&amp;sr=1-1&amp;keywords=canon+50mm+1.8">50mm</a> prime and a <a href="http://www.amazon.com/Canon-55-250mm-4-0-5-6-Telephoto-Digital/dp/B0011NVMO8">55-250mm</a> telephoto zoom) and a tripod(1.3 kg ,folded height 460mm).
For over an year I was using the bag that came with my dslr and decided now to upgrade to a better one, as I found it difficult to carry around the camera, lenses and tripod. I was looking for a backpack model and with lots of brands out there choosing one was really a tough thing. At first I did want to have a bag that could take a laptop too, but then decided against it as all those bags that could take a laptop tend to be a bit bulky. Carrying a laptop would be only while I travel and not when I go out for shooting, so then decided against one with a laptop. After some online research I shortlisted a couple of bags.</p>

<ol>
<li><a href="http://products.lowepro.com/product/flipside-300,2083.htm">Lowepro Flipside 300</a></li>
<li><a href="http://products.lowepro.com/product/DSLR-Video%20Fastpack%20250%20AW,2282.htm">Lowepro Video Fastpack 250aw</a></li>
<li><a href="http://products.lowepro.com/product/Pro-Runner-200-AW,2181,14.htm">Lowepro Pro Runner 200AW</a></li>
<li><a href="http://www.manfrotto.com/product/0/MB%2BSB390-3BC/_/Veloce_III_Camera_Backpack_for_DSLR_(Bungee_Cord)">Manfrotto Veloce III</a></li>
</ol>


<p>Deciding to drop into a store to see them was the best thing that I did, and I suggest everyone planning to buy a dslr bag to do that. What’s good for me, might not work out for you. Except the flipside one I did see everything else. For me the fastpack 250aw was a bit bulky, the Pro Runner a bit too small and lacking a quick access entry. Manfrotto was decent enough but then my tripod would not go through the tripod strap, since my tripod has all its legs connected to the centre rod.
I happened to see the Vanguard Up-rise 43, which was actually a sling bag but had all the other features I was looking for. It was sleek looking, well padded,had a tripod holder(now this one had a adjustable strap to hold the tripod), a quick access,rain cover.
Back home I did again a bit of research and got to see the Up-rise 45,46 and 48, which is the backpack bags in the up-rise series . Now that was what exactly I was looking for. 48 was way too big for me. Now had to choose between the 46 and 45 the only difference being the former could take a laptop too,and was not that bulky too. Also the models are also different. For Up-rise 46 the bag opening was from the <a href="http://www.premier-ink.co.uk/images/images_big/vg_uprise46_1.jpg">front</a> and for Up-rise 45 the opening was from the <a href="http://img2.blogs.yahoo.co.jp/ybi/1/7a/03/shira_gon/folder/1199363/img_1199363_32950708_2?1268142426">back</a>. The Up-rise 46 had just one problem of having the tripod strap on the opening bag flap, having you to untie the tripod first(if you have used that to tie the tripod. This one also does have a elastic band to the middle of the bag through which you can slide your tripod in, as in manfrotto. But then my tripod had to tied using the strap due to the same problem mentioned above).
So finally I had a choice, <a href="http://www.vanguardworld.com/index.php/en/pv/products/detail-1-1-4-33.html">Vanguard Up-Rise 45</a>, at least for now that I feel might be good for me. Just got it shipped today and planning to take it with me for the next trip.
Below are some snaps of the my bag. I did find a good <a href="http://www.youtube.com/watch?v=_A4GN5lJhQY">video</a> on youtube which shows all the features, so I didn’t want to do one again.</p>

<div class="wlWriterEditableSmartContent" id="scid:66721397-FF69-4ca6-AEC4-17E6B3208830:a7930e23-e5d9-4bbf-a9d8-0bb834e7717a" style="float: none; margin: 0; display: inline; padding: 0;">
<table style="outline: none; border-style: none; margin: 0; padding: 0; width: 408px; border-collapse: collapse;" border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="outline: none; border-style: none; margin: 0; padding: 5px 0 5px 5px; width: 159px; vertical-align: bottom;" colspan="2"><a style="outline: none; border-style: none; margin: 0; padding: 0;" href="https://skydrive.live.com/redir.aspx?cid=d5a8034107adc30c&amp;page=play&amp;resid=D5A8034107ADC30C!3950&amp;parid=D5A8034107ADC30C!3949&amp;type=1&amp;Bsrc=Photomail&amp;Bpub=SDX.Photos&amp;authkey=!ABkuQXjWWoHjsww" target="_blank"> <img style="outline: none; border-style: none; padding: 0; margin: 0; border: 0; background: none; background-image: none; vertical-align: bottom;" title="View album" alt="vanguard uprise45 review" src="/images/vanguard_uprise45_review.png" width="159" height="159" border="0" /></a></td>
<td style="vertical-align: middle; margin: 0; padding: 5px 5px 5px 0; outline: none; border-style: none; width: 226px;" colspan="3">
<div style="margin-left: 10px; top: -3%;">
<div style="width: 226px; overflow: visible;"><a style="text-decoration: none;" href="https://skydrive.live.com/redir.aspx?cid=d5a8034107adc30c&amp;page=browse&amp;resid=D5A8034107ADC30C!3949&amp;type=5&amp;authkey=!ABkuQXjWWoHjsww&amp;Bsrc=Photomail&amp;Bpub=SDX.Photos" target="_blank"><span style="line-height: 1.26em; padding: 0; width: 226px; font-size: 26pt; font-family: 'Segoe UI', helvetica, arial, sans-serif;">Vanguard Up-Rise 45</span></a></div>
<div style="padding: 10px 0 0; margin: 0;">
<table style="margin: 0; padding: 0; outline: none; border-style: none; border-collapse: collapse; width: auto;" border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="vertical-align: top; outline: none; border-style: none; margin: 0; padding: 10px 15px 6px 0;"><a style="font-family: 'Segoe UI', helvetica, arial, sans-serif; font-size: 8pt; outline: none; border-style: none; text-decoration: none; padding: 0; margin: 0;" href="https://skydrive.live.com/redir.aspx?cid=d5a8034107adc30c&amp;page=play&amp;resid=D5A8034107ADC30C!3949&amp;type=5&amp;authkey=!ABkuQXjWWoHjsww&amp;Bsrc=Photomail&amp;Bpub=SDX.Photos" target="_blank">VIEW SLIDE SHOW</a></td>
<td style="vertical-align: top; outline: none; border-style: none; margin: 0; padding: 10px 0 6px;"><a style="font-family: 'Segoe UI', helvetica, arial, sans-serif; font-size: 8pt; outline: none; border-style: none; text-decoration: none; padding: 0; margin: 0;" href="https://skydrive.live.com/redir.aspx?cid=d5a8034107adc30c&amp;page=downloadphotos&amp;resid=D5A8034107ADC30C!3949&amp;type=5&amp;Bsrc=Photomail&amp;Bpub=SDX.Photos&amp;authkey=!ABkuQXjWWoHjsww" target="_blank">DOWNLOAD ALL</a></td>
</tr>
</tbody>
</table>
</div>
</div>
</td>
</tr>
<tr>
<td style="vertical-align: bottom; outline: none; border-style: none; padding: 0 5px 5px; margin: 0; width: 77px; height: 77px;"><a style="font-family: 'Segoe UI', helvetica, arial, sans-serif; font-size: 8pt; outline: none; border-style: none; text-decoration: none; padding: 0; margin: 0;" href="https://skydrive.live.com/redir.aspx?cid=d5a8034107adc30c&amp;page=play&amp;resid=D5A8034107ADC30C!3951&amp;parid=D5A8034107ADC30C!3949&amp;type=1&amp;Bsrc=Photomail&amp;Bpub=SDX.Photos&amp;authkey=!ABkuQXjWWoHjsww" target="_blank"><img style="outline: none; border-style: none; padding: 0; margin: 0; border: 0; background: none; background-image: none; vertical-align: bottom;" title="View album" alt="vanguard uprise45 review" src="/images/vanguard_uprise45_review_1.png" width="77" height="77" border="0" /></a></td>
<td style="vertical-align: bottom; outline: none; border-style: none; padding: 0 5px 5px 0; margin: 0; width: 77px; height: 77px;"><a style="font-family: 'Segoe UI', helvetica, arial, sans-serif; font-size: 8pt; outline: none; border-style: none; text-decoration: none; padding: 0; margin: 0;" href="https://skydrive.live.com/redir.aspx?cid=d5a8034107adc30c&amp;page=play&amp;resid=D5A8034107ADC30C!3952&amp;parid=D5A8034107ADC30C!3949&amp;type=1&amp;Bsrc=Photomail&amp;Bpub=SDX.Photos&amp;authkey=!ABkuQXjWWoHjsww" target="_blank"><img style="outline: none; border-style: none; padding: 0; margin: 0; border: 0; background: none; background-image: none; vertical-align: bottom;" title="View album" alt="vanguard uprise45 review" src="/images/vanguard_uprise45_review_2.png" width="77" height="77" border="0" /></a></td>
<td style="vertical-align: bottom; outline: none; border-style: none; padding: 0 5px 5px 0; margin: 0; width: 77px; height: 77px;"><a style="font-family: 'Segoe UI', helvetica, arial, sans-serif; font-size: 8pt; outline: none; border-style: none; text-decoration: none; padding: 0; margin: 0;" href="https://skydrive.live.com/redir.aspx?cid=d5a8034107adc30c&amp;page=play&amp;resid=D5A8034107ADC30C!3953&amp;parid=D5A8034107ADC30C!3949&amp;type=1&amp;Bsrc=Photomail&amp;Bpub=SDX.Photos&amp;authkey=!ABkuQXjWWoHjsww" target="_blank"><img style="outline: none; border-style: none; padding: 0; margin: 0; border: 0; background: none; background-image: none; vertical-align: bottom;" title="View album" alt="vanguard uprise45 review" src="/images/vanguard_uprise45_review_3.png" width="77" height="77" border="0" /></a></td>
<td style="vertical-align: bottom; outline: none; border-style: none; padding: 0 5px 5px 0; margin: 0; width: 77px; height: 77px;"><a style="font-family: 'Segoe UI', helvetica, arial, sans-serif; font-size: 8pt; outline: none; border-style: none; text-decoration: none; padding: 0; margin: 0;" href="https://skydrive.live.com/redir.aspx?cid=d5a8034107adc30c&amp;page=play&amp;resid=D5A8034107ADC30C!3954&amp;parid=D5A8034107ADC30C!3949&amp;type=1&amp;Bsrc=Photomail&amp;Bpub=SDX.Photos&amp;authkey=!ABkuQXjWWoHjsww" target="_blank"><img style="outline: none; border-style: none; padding: 0; margin: 0; border: 0; background: none; background-image: none; vertical-align: bottom;" title="View album" alt="vanguard uprise45 review" src="/images/vanguard_uprise45_review_4.png" width="77" height="77" border="0" /></a></td>
<td style="vertical-align: bottom; outline: none; border-style: none; padding: 0 5px 5px 0; margin: 0; width: 77px; height: 77px;"><a style="font-family: 'Segoe UI', helvetica, arial, sans-serif; font-size: 8pt; outline: none; border-style: none; text-decoration: none; padding: 0; margin: 0;" href="https://skydrive.live.com/redir.aspx?cid=d5a8034107adc30c&amp;page=play&amp;resid=D5A8034107ADC30C!3955&amp;parid=D5A8034107ADC30C!3949&amp;type=1&amp;Bsrc=Photomail&amp;Bpub=SDX.Photos&amp;authkey=!ABkuQXjWWoHjsww" target="_blank"><img style="outline: none; border-style: none; padding: 0; margin: 0; border: 0; background: none; background-image: none; vertical-align: bottom;" title="View album" alt="vanguard uprise45 review" src="/images/vanguard_uprise45_review_5.png" width="77" height="77" border="0" /></a></td>
</tr>
</tbody>
</table>
</div>


<p>In short the main things that made my choose the Vanguard Up-Rise 45</p>

<ul>
<li><p>Shoulder bag with a sleek design</p></li>
<li><p>Quick access  for the camera</p></li>
<li><p>tripod holder,rain cover</p></li>
<li><p>flipside kind of access too, since the opening was in the back</p></li>
<li><p>good cushion paddings(you don’t feel the weight at all)</p></li>
<li><p>sturdy even with the tripod attached and had no issues accessing the quick access</p></li>
<li><p>all straps could be nicely tucked away into appropriate slots, leaving no hanging straps</p></li>
<li><p>a compartment for accessories</p></li>
</ul>


<p>Hope you have a good time choosing your bag !</p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-capitalize">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-01-04T15:06:48+05:30"  data-updated="true" itemprop="datePublished dateCreated">Jan 4<sup>th</sup>, 2013</time>
        

<span class="glyphicon glyphicon-tags"></span>&nbsp; Posted in&nbsp; 
<span class="categories">
  
    <a class='category' href='/blog/category/dot-net/'>.net</a>, <a class='category' href='/blog/category/windows-8/'>windows 8</a>
  
</span>


        
      </p>
    
    
      <h1 class="entry-title" itemprop="name headline"><a href="/blog/windows-8-series-drop-down-button/" itemprop="url">Windows 8 Series – Drop Down Button</a></h1>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>While working on my Windows 8 Store application, <a href="http://apps.microsoft.com/windows/en-us/app/picfinity/33ba9249-a9f4-44df-973c-21962376c3ea">Picfinity</a> I came across a need for a drop-down button(which I thought was the correct term for this). A similar control is there on the start screen of Windows 8 that gives us options on clicking the logged in user’s image to Change Account picture, Lock, Sign Out etc.</p>

<p><img src="/images/windows8_dropdown_button.png" alt="windows8 dropdown button" /></p>

<p>I wanted this same behaviour in my application, to provide similar options for the logged in user. The easiest way to achieve this is to use a <a href="http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.popup.aspx">Popup</a>. The xaml snippet below shows how to get a similar look on your application</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;Grid</span> <span class="na">Background=</span><span class="s">&quot;{StaticResource ApplicationPageBackgroundThemeBrush}&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;Grid.ColumnDefinitions&gt;</span>
</span><span class='line'>        <span class="nt">&lt;ColumnDefinition</span> <span class="nt">/&gt;</span>
</span><span class='line'>        <span class="nt">&lt;ColumnDefinition</span> <span class="na">Width=</span><span class="s">&quot;Auto&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/Grid.ColumnDefinitions&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TextBlock</span> <span class="na">Text=</span><span class="s">&quot;MY Content&quot;</span> <span class="na">FontSize=</span><span class="s">&quot;30&quot;</span> <span class="na">HorizontalAlignment=</span><span class="s">&quot;Center&quot;</span>
</span><span class='line'>         <span class="na">VerticalAlignment=</span><span class="s">&quot;Center&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>   <span class="nt">&lt;span</span> <span class="na">style=</span><span class="s">&quot;color:#000000;&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;StackPanel</span> <span class="na">Grid.Column=</span><span class="s">&quot;1&quot;</span> <span class="na">Margin=</span><span class="s">&quot;0,10,30,0&quot;</span> <span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;Button</span> <span class="na">Content=</span><span class="s">&quot;User Name&quot;</span> <span class="na">VerticalAlignment=</span><span class="s">&quot;Top&quot;</span> <span class="na">Click=</span><span class="s">&quot;Button_Click_1&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>        <span class="nt">&lt;Popup</span> <span class="na">IsLightDismissEnabled=</span><span class="s">&quot;True&quot;</span> <span class="na">Name=</span><span class="s">&quot;buttonDropDown&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>            <span class="nt">&lt;StackPanel</span> <span class="na">Background=</span><span class="s">&quot;DarkGray&quot;</span>  <span class="na">Width=</span><span class="s">&quot;105&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>              <span class="nt">&lt;Button</span> <span class="na">BorderThickness=</span><span class="s">&quot;0&quot;</span> <span class="na">Content=</span><span class="s">&quot;Option1&quot;</span> <span class="na">HorizontalAlignment=</span><span class="s">&quot;Stretch&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>              <span class="nt">&lt;Button</span> <span class="na">BorderThickness=</span><span class="s">&quot;0&quot;</span> <span class="na">Content=</span><span class="s">&quot;Option2&quot;</span> <span class="na">HorizontalAlignment=</span><span class="s">&quot;Stretch&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>              <span class="nt">&lt;Button</span> <span class="na">BorderThickness=</span><span class="s">&quot;0&quot;</span> <span class="na">Content=</span><span class="s">&quot;Option3&quot;</span> <span class="na">HorizontalAlignment=</span><span class="s">&quot;Stretch&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>            <span class="nt">&lt;/StackPanel&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/Popup&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/StackPanel&gt;&lt;/span&gt;</span>
</span><span class='line'><span class="nt">&lt;/Grid&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>On click of the button we need to set the popup’s <a href="http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.popup.isopen.aspx">IsOpen</a> to true. Setting the <a href="http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.primitives.popup.islightdismissenabled">IsLightDismissEnabled</a> to true the popup closes whenever the user taps outside of the popup.</p>

<p><img src="/images/windows8_dropdown_button_plain.png" alt="windows8 dropdown button" /></p>

<p>Style and color it the way you want it to look and there you have an easy drop-down button for Windows 8.</p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-capitalize">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2012-10-28T20:11:31+05:30"  data-updated="true" itemprop="datePublished dateCreated">Oct 28<sup>th</sup>, 2012</time>
        

<span class="glyphicon glyphicon-tags"></span>&nbsp; Posted in&nbsp; 
<span class="categories">
  
    <a class='category' href='/blog/category/dot-net/'>.net</a>, <a class='category' href='/blog/category/rest/'>rest</a>, <a class='category' href='/blog/category/windows-8/'>windows 8</a>
  
</span>


        
      </p>
    
    
      <h1 class="entry-title" itemprop="name headline"><a href="/blog/windows-8-series-incremental-loading/" itemprop="url">Windows 8 Series - Incremental Loading</a></h1>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>Fast and fluid experience is one of the most important characteristics of a Windows 8 application. As the data becomes larger , it might not be always possible to get the entire data loaded before hand.We might want to have a incremental or sequential data loading so that the user has a better experience.
While developing windows 8 this can be easily achieved by using <a href="http://msdn.microsoft.com/en-us/library/windows/apps/Hh701916">ISupportIncrementalLoading</a>
interface which would load the data incrementally.The class that implements this should also implement the <a href="http://msdn.microsoft.com/en-us/library/system.collections.ilist.aspx">IList</a> and <a href="http://msdn.microsoft.com/en-us/library/system.collections.specialized.inotifycollectionchanged.aspx">INotifyColectionChanged</a>. A sample on how to implement this interface can be seen <a href="http://msdn.microsoft.com/en-us/library/windows/apps/Hh701916">here</a>.
Implementing these over and over for different data sources that you would want to load incrementally might soon become tedious and repetitive.So why not make up some generic classes that you could abstract away the task of loading the data incrementally. That&rsquo;s exactly what we would be looking into here.</p>

<p>First lets get the class that implements <a href="http://msdn.microsoft.com/en-us/library/windows/apps/Hh701916">ISupportIncrementalLoading</a>, IList and INotifyCollectionChanged. To keep things simple lets inherit from ObservableCollection,which in turn inherits the latter 2 interfaces</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">IncrementalSource</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">K</span><span class="p">&gt;</span> <span class="p">:</span> <span class="n">ObservableCollection</span><span class="p">&lt;</span><span class="n">K</span><span class="p">&gt;,</span> <span class="n">ISupportIncrementalLoading</span>
</span><span class='line'>    <span class="k">where</span> <span class="n">T</span><span class="p">:</span> <span class="k">class</span>
</span><span class='line'><span class="err">{</span>
</span><span class='line'>    <span class="k">private</span> <span class="kt">string</span> <span class="n">Query</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">private</span> <span class="kt">int</span> <span class="n">VirtualCount</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">private</span> <span class="kt">int</span> <span class="n">CurrentPage</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">private</span> <span class="n">IPagedSource</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">K</span><span class="p">&gt;</span> <span class="n">Source</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">private</span> <span class="kt">int</span> <span class="n">rpp</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="nf">IncrementalSource</span><span class="p">(</span><span class="kt">string</span> <span class="n">query</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">IPagedResponse</span><span class="p">&lt;</span><span class="n">K</span><span class="p">&gt;&gt;</span> <span class="n">GetPagedResponse</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="n">Source</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PagedSourceLoader</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">K</span><span class="p">&gt;(</span><span class="n">GetPagedResponse</span><span class="p">);</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="n">VirtualCount</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="n">MaxValue</span><span class="p">;</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="n">CurrentPage</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="n">Query</span> <span class="p">=</span> <span class="n">query</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="cp">#region ISupportIncrementalLoading</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="kt">bool</span> <span class="n">HasMoreItems</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="n">VirtualCount</span> <span class="p">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="n">CurrentPage</span> <span class="p">*</span> <span class="p">(</span><span class="n">rpp</span> <span class="p">==</span> <span class="m">0</span> <span class="p">?</span> <span class="m">10</span> <span class="p">:</span><span class="n">rpp</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="n">IAsyncOperation</span><span class="p">&lt;</span><span class="n">LoadMoreItemsResult</span><span class="p">&gt;</span> <span class="n">LoadMoreItemsAsync</span><span class="p">(</span><span class="kt">uint</span> <span class="n">count</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">CoreDispatcher</span> <span class="n">dispatcher</span> <span class="p">=</span> <span class="n">Window</span><span class="p">.</span><span class="n">Current</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">?</span> <span class="n">Window</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Dispatcher</span> <span class="p">:</span> <span class="n">Windows</span><span class="p">.</span><span class="n">ApplicationModel</span><span class="p">.</span><span class="n">Core</span><span class="p">.</span><span class="n">CoreApplication</span><span class="p">.</span><span class="n">MainView</span><span class="p">.</span><span class="n">CoreWindow</span><span class="p">.</span><span class="n">Dispatcher</span><span class="p">;</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="p">&gt;</span> <span class="m">50</span> <span class="p">||</span> <span class="n">count</span> <span class="p">&lt;=</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="c1">// default load count to be set to 50</span>
</span><span class='line'>            <span class="n">count</span> <span class="p">=</span> <span class="m">50</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">Task</span><span class="p">.</span><span class="n">Run</span><span class="p">&lt;</span><span class="n">LoadMoreItemsResult</span><span class="p">&gt;(</span>
</span><span class='line'>            <span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>                <span class="n">IPagedResponse</span><span class="p">&lt;</span><span class="n">K</span><span class="p">&gt;</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="n">Source</span><span class="p">.</span><span class="n">GetPage</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">Query</span><span class="p">,</span><span class="n">count</span><span class="p">),</span> <span class="p">++</span><span class="k">this</span><span class="p">.</span><span class="n">CurrentPage</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">count</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">this</span><span class="p">.</span><span class="n">VirtualCount</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">VirtualCount</span><span class="p">;</span>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span><span class="n">rpp</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="n">rpp</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">rpp</span><span class="p">;</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">await</span> <span class="n">dispatcher</span><span class="p">.</span><span class="n">RunAsync</span><span class="p">(</span>
</span><span class='line'>                    <span class="n">CoreDispatcherPriority</span><span class="p">.</span><span class="n">Normal</span><span class="p">,</span>
</span><span class='line'>                    <span class="p">()</span> <span class="p">=&gt;</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="k">foreach</span> <span class="p">(</span><span class="n">K</span> <span class="n">item</span> <span class="k">in</span> <span class="n">result</span><span class="p">.</span><span class="n">Items</span><span class="p">)</span>
</span><span class='line'>                            <span class="k">this</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
</span><span class='line'>                    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">return</span> <span class="k">new</span> <span class="nf">LoadMoreItemsResult</span><span class="p">()</span> <span class="p">{</span> <span class="n">Count</span> <span class="p">=</span> <span class="p">(</span><span class="kt">uint</span><span class="p">)</span><span class="n">result</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Count</span><span class="p">()</span> <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>            <span class="p">}).</span><span class="n">AsAsyncOperation</span><span class="p">&lt;</span><span class="n">LoadMoreItemsResult</span><span class="p">&gt;();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="cp">#endregion</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Before going into the details of the code, lets understand what this class is going to do for us. We need to load data in a paged fashion from a large datasource. So we would generally be dealing with two types of object – one the type of object(<strong><em>K</em></strong>) whose list we are trying to load incrementally. Another one the type of object(<strong><em>T</em></strong>) that represents each paged request result. This object would ideally contain a property to hold list of objects of type K, the total number of items that the datasource would give us,so that we know how many pages we need to request for and also a property indicating the current page. Each datasource might return us these required properties in different property names and types. So we have a class to hold these data together for us, PagedResponse which implements IPagedResponse</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">interface</span> <span class="n">IPagedResponse</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">Items</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">VirtualCount</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">rpp</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// rpp - requests per page</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">PagedResponse</span><span class="p">&lt;</span><span class="n">K</span><span class="p">&gt;</span> <span class="p">:</span> <span class="n">IPagedResponse</span><span class="p">&lt;</span><span class="n">K</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="nf">PagedResponse</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">K</span><span class="p">&gt;</span> <span class="n">items</span><span class="p">,</span> <span class="kt">int</span> <span class="n">virtualCount</span><span class="p">,</span><span class="kt">int</span> <span class="n">itemsPerPage</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="n">Items</span> <span class="p">=</span> <span class="n">items</span><span class="p">;</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="n">VirtualCount</span> <span class="p">=</span> <span class="n">virtualCount</span><span class="p">;</span>
</span><span class='line'>        <span class="n">rpp</span> <span class="p">=</span> <span class="n">itemsPerPage</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="n">VirtualCount</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="n">rpp</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span>  <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">K</span><span class="p">&gt;</span> <span class="n">Items</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>That said lets see the  <em>IncremetnalSource</em> class. It takes in the object type <strong><em>T </em></strong>and <strong><em>K.</em></strong>The constructor takes in the url where the datasource can be found.The Func&lt;T, IPagedResponse<K>> parameter represents a function that takes in the return type of the call to the url as a parameter and returns the PagedResponse type. In other words that function converts the paged request call type to the type that we use to represent it, IPagedResponse.See a sample below.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">private</span> <span class="n">PagedResponse</span><span class="p">&lt;</span><span class="n">Photo</span><span class="p">&gt;</span> <span class="n">RootObjectResponse</span><span class="p">(</span><span class="n">RootObject</span> <span class="n">rootObject</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="n">PagedResponse</span><span class="p">&lt;</span><span class="n">Photo</span><span class="p">&gt;(</span><span class="n">rootObject</span><span class="p">.</span><span class="n">photos</span><span class="p">,</span> <span class="n">rootObject</span><span class="p">.</span><span class="n">total_items</span><span class="p">,</span> <span class="n">rootObject</span><span class="p">.</span><span class="n">photos</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">?</span> <span class="n">rootObject</span><span class="p">.</span><span class="n">photos</span><span class="p">.</span><span class="n">Count</span> <span class="p">:</span> <span class="m">0</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we need to make the call to the datasource url. This might return us data in different formats, most popularly json or xml. So we would always want to abstract away the loading of data to another class so that we don’t get tied up with the data formats in <em>IncrementalSource.</em></p>

<p>IPagedSource&lt;T,K> will do this for us. A sample implementation of this is <em>PagedSourceLoader </em>that handles for json return type is below</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">interface</span> <span class="n">IPagedSource</span><span class="p">&lt;</span><span class="n">R</span><span class="p">,</span><span class="n">K</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">Task</span><span class="p">&lt;</span><span class="n">IPagedResponse</span><span class="p">&lt;</span><span class="n">K</span><span class="p">&gt;&gt;</span> <span class="n">GetPage</span><span class="p">(</span><span class="kt">string</span> <span class="n">query</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pageIndex</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pageSize</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">PagedSourceLoader</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">K</span><span class="p">&gt;</span> <span class="p">:</span> <span class="n">IPagedSource</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">K</span><span class="p">&gt;</span>
</span><span class='line'>    <span class="k">where</span> <span class="n">T</span><span class="p">:</span><span class="k">class</span>
</span><span class='line'><span class="err">{</span>
</span><span class='line'>    <span class="k">private</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">IPagedResponse</span><span class="p">&lt;</span><span class="n">K</span><span class="p">&gt;&gt;</span> <span class="n">getPagedResponse</span><span class="p">;</span>
</span><span class='line'>    <span class="k">public</span> <span class="nf">PagedSourceLoader</span><span class="p">(</span><span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">IPagedResponse</span><span class="p">&lt;</span><span class="n">K</span><span class="p">&gt;&gt;</span> <span class="n">GetPagedResponse</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">getPagedResponse</span> <span class="p">=</span> <span class="n">GetPagedResponse</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="cp">#region IPagedSource</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">IPagedResponse</span><span class="p">&lt;</span><span class="n">K</span><span class="p">&gt;&gt;</span> <span class="n">GetPage</span><span class="p">(</span><span class="kt">string</span> <span class="n">query</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pageIndex</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pageSize</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">query</span> <span class="p">+=</span> <span class="s">&quot;&amp;page=&quot;</span><span class="p">+</span><span class="n">pageIndex</span><span class="p">;</span>
</span><span class='line'>        <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HttpClient</span><span class="p">();</span>
</span><span class='line'>        <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="n">GetAsync</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>
</span><span class='line'>        <span class="kt">var</span> <span class="n">data</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">ReadAsStreamAsync</span><span class="p">();</span>
</span><span class='line'>        <span class="n">DataContractJsonSerializer</span> <span class="n">json</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DataContractJsonSerializer</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">T</span><span class="p">));</span>
</span><span class='line'>        <span class="n">T</span> <span class="n">dat</span> <span class="p">=</span> <span class="n">json</span><span class="p">.</span><span class="n">ReadObject</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">as</span> <span class="n">T</span><span class="p">;</span>
</span><span class='line'>        <span class="k">return</span> <span class="nf">getPagedResponse</span><span class="p">(</span><span class="n">dat</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="cp">#endregion</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>As you see above the <em>PagedSourceLoader</em> gets the json from the datasource url and converts to the type that we are interested in . You could always replace this class to use any other data format as you would want. Mostly you would just want one implementation for <em>IPagedSource&lt;T,K>, </em>as your data source would always return you the same data format. In case not you could inject that too into the <em>IncrementalSource</em> class.</p>

<p>I have a sample <a href="http://sdrv.ms/RdPtdL">here</a> that incrementally loads the photos from a photo site <a href="http://500px.com/flow">500px</a>. You would need to register for an to get the consumer key,which should hardly take some time <a href="http://500px.com/settings/applications?from=developers">here</a>.</p>

<p><img src="/images/windows8_incremental_loading.png" alt="windows8 incremental loading" /></p>

<p><a href="https://github.com/rahulpnath/Blog/tree/master/Windows8%20-%20IncrementalLoading">Download the sample source code</a></p>

<p>Keep a sample of the source code for yourself in case you wanted this specific version. I might refine this to a more usable library with couple of default <em>PagedSourceLoader.</em></p>

<p><strong>References:
</strong><a href="http://www.silverlightplayground.org/post/2012/06/10/Metro-Incrementally-load-GridView-and-ListView-with-ISupportIncrementalLoading.aspx">Metro: Incrementally load GridView and ListView with ISupportIncrementalLoading</a></p>

<p>Feel free to reuse it if you find it useful and drop a comment to refine it.</p>
</div>
  
  


        </article>
      
    </div>

    <ul class="pager">
      
        <li class="previous"><a href="/blog/page/5">&larr;&nbsp;Older</a></li>
      
      <li><a href="/blog/archives">Blog Archives</a></li>
      
        <li class="next"><a href="/blog/page/3">Newer&nbsp;&rarr;</a></li>
      
    </ul>
  </div>

  
    <aside class="sidebar col-md-3">
      
        <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/blog/getting-started-with-azure-key-vault/">Getting Started with Azure Key Vault</a>
    
    <a class="list-group-item " href="/blog/azure-key-vault-and-powershell-module-version/">Azure Key Vault and Powershell Module Version</a>
    
    <a class="list-group-item " href="/blog/isregistered-on-unity-container-for-generic-type/">IsRegistered on Unity Container for Generic Type</a>
    
    <a class="list-group-item " href="/blog/testing-multiple-implementations-of-same-interface/">Testing Multiple Implementations of same Interface</a>
    
    <a class="list-group-item " href="/blog/ioc-registration-by-convention/">IoC Registration by Convention</a>
    
  </div>
</section>




<section class="googleplus googleplus-hidden panel panel-default">
  <div class="panel-body">
    <h1>
      <a href="https://plus.google.com/+RahulNath?rel=author">
        <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
        Google+
      </a>
    </h1>
  </div>
</section>



      
    </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2015 - Rahul Nath<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'rahulpnath';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr-2.0.js"></script>


  </body>
</html>
